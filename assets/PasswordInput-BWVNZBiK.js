import{r as m,l as g,h as k,_ as S,b as y,f as P,w as h,d as f,o as v,a as p,g as C,c as b}from"./index-CHYnOP-6.js";import{P as I}from"./PasswordStrengthIndicator-BZCzWfbr.js";function V(r,n,s={}){const e=m(null),l=m(!1);s.providerType;const w=()=>{e.value||(e.value=new Worker("/worker.js"),e.value.onmessage=u)},u=a=>{const[o,d,_]=a.data;if(l.value=!1,o==="ERROR"){n==null||n(d,d);return}r==null||r(d,_)},i=(a,o,d)=>{if(!a||!o){console.error("useAESWorker: Missing fileData or password");return}l.value=!0,w(),e.value.postMessage(["ENCRYPT",a,o,d])},c=(a,o,d)=>{if(!a||!o){console.error("useAESWorker: Missing fileData or password");return}l.value=!0,w(),e.value.postMessage(["DECRYPT",a,o,d])},t=()=>{e.value&&(e.value.terminate(),e.value=null)};return g(()=>{t()}),{worker:e,isLoading:l,encrypt:i,decrypt:c,terminateWorker:t}}function L(r="encrypt"){const n=`slurm_aes_${r}_session_password`,s=m(!1),e=m(!1),l=()=>{try{const o=sessionStorage.getItem(n),d=!!o;return e.value=d,s.value=d,o}catch(o){return console.error("Failed to check session password:",o),e.value=!1,null}},w=o=>{if(!s.value||!o){i();return}try{sessionStorage.setItem(n,o),e.value=!0}catch(d){console.error("Failed to save session password:",d),e.value=!1}},u=()=>{try{return sessionStorage.getItem(n)}catch(o){return console.error("Failed to get session password:",o),null}},i=()=>{try{sessionStorage.removeItem(n)}catch(o){console.error("Failed to clear session password:",o)}finally{e.value=!1,s.value=!1}},c=()=>l()||"";k(s,o=>{o||i()});const t=()=>{document.hidden&&i()},a=()=>{i()};return typeof document<"u"&&(document.addEventListener("visibilitychange",t),window.addEventListener("blur",a)),g(()=>{typeof document<"u"&&(document.removeEventListener("visibilitychange",t),window.removeEventListener("blur",a))}),{rememberPassword:s,isPasswordRemembered:e,saveSessionPassword:w,getSessionPassword:u,clearSessionPassword:i,autoLoadPassword:c}}const E={name:"PasswordInput",components:{PasswordStrengthIndicator:I},props:{password:{type:String,required:!0,default:""},passwordConfirm:{type:String,default:""},requireConfirmation:{type:Boolean,default:!1},showStrength:{type:Boolean,default:!0},showRequirements:{type:Boolean,default:!0},showFeedback:{type:Boolean,default:!1},autocomplete:{type:String,default:"new-password",validator:r=>["new-password","current-password"].includes(r)},passwordLabel:{type:String,default:"Password"},passwordPlaceholder:{type:String,default:"Enter encryption password"},passwordIcon:{type:String,default:"mdi-lock"}},emits:["update:password","update:password-confirm","is-valid"],setup(r,{emit:n}){const s=m(!1),e=m(!1),l=y(()=>r.requireConfirmation?r.password.trim()!==""&&r.password===r.passwordConfirm:!0),w=y(()=>r.requireConfirmation?r.password!==""&&r.passwordConfirm!==""&&r.password!==r.passwordConfirm:!1),u=t=>{n("update:password",t),c(t,r.passwordConfirm)},i=t=>{n("update:password-confirm",t),c(r.password,t)},c=(t,a)=>{if(!r.requireConfirmation)n("is-valid",t.trim()!=="");else{const o=t.trim()!==""&&t===a;n("is-valid",o)}};return{showPassword:s,showPasswordConfirm:e,isPasswordConfirmed:l,showConfirmError:w,handlePasswordInput:u,handlePasswordConfirmInput:i}}},q={key:0,tabindex:"-1"};function x(r,n,s,e,l,w){const u=f("v-text-field"),i=f("PasswordStrengthIndicator"),c=f("v-col"),t=f("v-row");return v(),P(t,null,{default:h(()=>[p(c,{cols:"12",sm:s.requireConfirmation?6:12},{default:h(()=>[p(u,{"model-value":s.password,label:s.passwordLabel,type:e.showPassword?"text":"password",variant:"outlined",density:"comfortable",autocomplete:s.autocomplete,maxlength:"1024",placeholder:s.passwordPlaceholder,"prepend-inner-icon":s.passwordIcon,"append-inner-icon":e.showPassword?"mdi-eye-off":"mdi-eye","hide-details":"","onUpdate:modelValue":e.handlePasswordInput,"onClick:appendInner":n[0]||(n[0]=a=>e.showPassword=!e.showPassword)},null,8,["model-value","label","type","autocomplete","placeholder","prepend-inner-icon","append-inner-icon","onUpdate:modelValue"]),s.showStrength?(v(),b("div",q,[p(i,{password:s.password,"show-requirements":s.showRequirements,"show-feedback":s.showFeedback},null,8,["password","show-requirements","show-feedback"])])):C("",!0)]),_:1},8,["sm"]),s.requireConfirmation?(v(),P(c,{key:0,cols:"12",sm:"6"},{default:h(()=>[p(u,{"model-value":s.passwordConfirm,label:"Confirm Password",type:e.showPasswordConfirm?"text":"password",variant:"outlined",density:"comfortable",autocomplete:s.autocomplete,maxlength:"1024",placeholder:"Confirm encryption password","prepend-inner-icon":"mdi-lock-check","append-inner-icon":e.showPasswordConfirm?"mdi-eye-off":"mdi-eye",error:e.showConfirmError,success:e.isPasswordConfirmed,"hide-details":"","onUpdate:modelValue":e.handlePasswordConfirmInput,"onClick:appendInner":n[1]||(n[1]=a=>e.showPasswordConfirm=!e.showPasswordConfirm)},null,8,["model-value","type","autocomplete","append-inner-icon","error","success","onUpdate:modelValue"])]),_:1})):C("",!0)]),_:1})}const W=S(E,[["render",x]]);export{W as P,V as a,L as u};
