import{_ as he,a as ve,c as L,b as o,g as e,i as E,j as P,w as r,l as fe,r as h,d as F,k as G,e as i,o as f,F as Z,f as a,t as $}from"./index-B3qWwubD.js";import{d as Y}from"./fileDownload-B1vhVzTR.js";import{C as ge,p as _e}from"./CsvPreviewTable-biLR8S3w.js";import{P as we,u as be,a as xe}from"./PasswordInput-BMAcfjbu.js";import{u as Ce}from"./useClipboard-KqVwDR14.js";import{u as ke}from"./useDebounce-BSPg3tFl.js";import{T as Pe,S as Te,u as Ae}from"./ToolPageHeader-B5fwubOi.js";import{_ as Se}from"./EducationalAlert-Y0cuKI1U.js";import{T as De,F as Ee}from"./TextInputWithActions-sfBDoCmn.js";import"./PasswordStrengthIndicator-BRJz03FB.js";import"./FileUpload-BX86mpty.js";const Fe={name:"Decrypt",components:{CsvPreviewTable:ge,EducationalAlert:Se,FileUploadWithValidation:Ee,LearnMorePanel:ve,PasswordInput:we,SharedSnackbar:Te,TextInputWithActions:De,ToolPageHeader:Pe},setup(){const n=h(null),_=h(""),t=h(""),b=h(null),x=h(""),y=h(""),u=h(""),T=h(""),p=h("jsAesCrypt"),v=h([]),w=h([]),{snackbar:M,snackbarColor:z,snackbarText:g,showSnackbar:l}=Ae(),{copyToClipboard:U,pasteFromClipboard:j}=Ce(),{rememberPassword:A,isPasswordRemembered:V,saveSessionPassword:W,clearSessionPassword:H,autoLoadPassword:C}=be("decrypt"),I=C();I&&(u.value=I);const{decrypt:B,isLoading:R}=xe((s,c)=>{k.value?le(s):ne(s,c)},(s,c)=>{y.value=c,l(s,"error"),t.value=""}),N=F(()=>({jsAesCrypt:"How Does AES Decryption Work?",webCrypto:"How Does WebCrypto Decryption Work?",age:"How Does Age Decryption Work?"})[p.value]||"How Does Decryption Work?"),S=F(()=>Q.value&&(d.value||k.value)),k=F(()=>x.value.trim()!==""),d=F(()=>!!b.value),J=F(()=>!!T.value||w.value.length>0||v.value.length>0),Q=F(()=>u.value.trim()!==""),X=()=>{A.value||(u.value=""),b.value=null,x.value=""},K=()=>{T.value="",t.value="",v.value=[],w.value=[],n.value=null,_.value=""},te=()=>{x.value="",t.value="",y.value="",ue()},oe=()=>{try{const s=atob(x.value),c=new Uint8Array(s.length);for(let m=0;m<s.length;m++)c[m]=s.charCodeAt(m);return new Blob([c])}catch(s){return console.error("Base64 decode error:",s),y.value="Invalid Base64 format",l("❌ Invalid encrypted text format","error"),null}},se=()=>{if(!S.value)return;y.value="",t.value="";const s=oe();s&&B(s,u.value,"encrypted.aes",p.value)},ae=()=>{if(!S.value){l("Invalid inputs","error");return}y.value="",B(b.value,u.value,b.value.name,p.value)},re=()=>{n.value&&_.value&&(Y(n.value,_.value),l("✓ File downloaded successfully!","success"))},ne=(s,c)=>{if(n.value=s,_.value=c,c.endsWith(".csv")){if(s.byteLength<=8388608){const m=_e(s);w.value=m.headers,v.value=m.data;const q=(s.byteLength/1024).toFixed(2);l(`✓ CSV file decrypted (${q} KB) - Preview shown`,"success")}else{Y(s,c);const m=(s.byteLength/(1024*1024)).toFixed(2);l(`✓ CSV file decrypted (${m} MB) - Too large to preview, downloaded`,"info")}X();return}if(me(c,s)){const D=new TextDecoder().decode(s);T.value=D;const m=(s.byteLength/1024).toFixed(2);l(`✓ Text file decrypted (${m} KB) - Preview shown`,"success"),X();return}if(Y(s,c),s.byteLength>8388608){const D=(s.byteLength/1048576).toFixed(2);l(`✓ File decrypted (${D} MB) - Too large to preview, downloaded`,"info")}else l("✓ File decrypted and downloaded!","success");X()},le=s=>{try{const c=new TextDecoder().decode(s);t.value=c,l("✓ Text decrypted successfully!","success")}catch(c){console.error("Text decode error:",c),y.value="Failed to decode decrypted data",l("❌ Decryption failed","error")}},ie=()=>{},ce=async()=>{await U(t.value,s=>l(s,"success"),s=>l(s,"error"))},de=async()=>{await j((s,c)=>{x.value=s,l(c,"success"),O()},s=>l(s,"error"))},pe=()=>{t.value="",y.value="",O()},{cancel:ue,debounce:O}=ke(()=>{S.value&&k.value&&se()},800),me=(s,c)=>{const m=[".txt",".md",".json",".xml",".html",".css",".js",".log",".yaml",".yml"].some(ye=>s.toLowerCase().endsWith(ye)),q=c.byteLength<=8388608;return m&&q};return G(b,s=>{s&&(s.name.endsWith(".age")?p.value="age":s.name.endsWith(".aes")?p.value="jsAesCrypt":s.name.endsWith(".enc")&&(p.value="webCrypto")),s&&(J.value||_.value)&&K()}),G(A,s=>{s&&u.value&&W(u.value)}),G(u,(s,c)=>{A.value&&s&&W(s),s&&s!==c&&(J.value||_.value)&&K(),k.value&&(t.value="",y.value="",O())}),{decryptedFileName:_,decryptedText:t,encryptedFile:b,encryptedText:x,error:y,isLoading:R,password:u,plainText:T,selectedAlgorithm:p,tableData:v,tableHeaders:w,rememberPassword:A,isPasswordRemembered:V,clearSessionPassword:H,snackbar:M,snackbarColor:z,snackbarText:g,canDecrypt:S,infoPanelTitle:N,isEncryptedTextPopulated:k,isFilePopulated:d,isPasswordPopulated:Q,clearEncryptedText:te,clearOutputs:K,decryptFile:ae,downloadDecryptedText:re,handleCopy:ce,handleEncryptedTextChange:pe,handleFileValidation:ie,handlePaste:de}}},Ve=e("p",{class:"mb-2"},[e("strong",null,"AES decryption"),a(" reverses the AES-256 encryption process, converting encrypted data back to its original form using the same password that was used for encryption. ")],-1),We=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Password required"),a(" - You must use the EXACT same password that was used to encrypt the data")]),e("li",null,[e("strong",null,"Case-sensitive"),a(' - "Password123" and "password123" are different passwords')]),e("li",null,[e("strong",null,"No recovery"),a(" - If you forgot the password, the data cannot be decrypted")]),e("li",null,[e("strong",null,"Secure process"),a(" - Decryption happens entirely in your browser, nothing is sent to any server")])],-1),Ie=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),a(" Decrypting files from cloud storage, accessing encrypted backups, retrieving protected documents. ")],-1),Be=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),a(" • "),e("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard "),a(" • "),e("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," jsAesCrypt ")],-1),Le=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),a(" AES-256-CBC cipher mode with PBKDF2 key derivation (10,000 iterations). Compatible with .aes files encrypted using AES Crypt format. ")],-1),Me=e("p",{class:"mb-2"},[e("strong",null,"WebCrypto decryption"),a(" uses the browser's native Web Cryptography API to decrypt AES-256-GCM encrypted data back to its original form using the password. ")],-1),ze=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Password required"),a(" - You must use the EXACT same password that was used to encrypt the data")]),e("li",null,[e("strong",null,"Case-sensitive"),a(' - "Password123" and "password123" are different passwords')]),e("li",null,[e("strong",null,"GCM mode"),a(" - Authenticated encryption automatically verifies data integrity")]),e("li",null,[e("strong",null,"Hardware-accelerated"),a(" - Faster decryption using CPU crypto instructions")])],-1),Ue=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),a(" Decrypting browser-encrypted files, high-performance decryption, accessing modern encrypted backups. ")],-1),je=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," MDN: Web Crypto API "),a(" • "),e("a",{href:"https://www.w3.org/TR/WebCryptoAPI/",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," W3C Specification ")],-1),He=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),a(" AES-256-GCM authenticated encryption with PBKDF2 key derivation (100,000 iterations). Browser-native Web Crypto API. Decrypts .enc files. ")],-1),Re=e("p",{class:"mb-2"},[e("strong",null,"Age decryption"),a(" reverses age encryption, converting encrypted .age files back to their original form using the passphrase. ")],-1),Ne=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Passphrase required"),a(" - You must use the EXACT same passphrase that was used to encrypt the data")]),e("li",null,[e("strong",null,"Case-sensitive"),a(' - "Passphrase123" and "passphrase123" are different passphrases')]),e("li",null,[e("strong",null,"CLI-compatible"),a(" - Works with age and rage command-line tools")]),e("li",null,[e("strong",null,"Armor format"),a(" - Supports both binary and ASCII-armored .age files")])],-1),Xe=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),a(" Decrypting age-encrypted backups, cross-platform file decryption, scripting workflows, command-line integration. ")],-1),Ke=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://age-encryption.org",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age specification "),a(" • "),e("a",{href:"https://github.com/FiloSottile/age",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age on GitHub "),a(" • "),e("a",{href:"https://github.com/str4d/rage",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," rage (Rust) ")],-1),Oe=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),a(" Uses rage-wasm (Rust compiled to WebAssembly) with scrypt password derivation. Decrypts .age files with optional armor format. ")],-1),qe=e("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Ge=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (jsAesCrypt)"),e("div",{class:"text-caption text-medium-emphasis"},"Compatible with AES Crypt format (.aes files)")],-1),Ze=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (WebCrypto)"),e("div",{class:"text-caption text-medium-emphasis"},"Browser-native encryption (.enc files)")],-1),Ye=e("div",null,[e("div",{class:"font-weight-medium"},"Age Encryption"),e("div",{class:"text-caption text-medium-emphasis"},"Modern encryption format (.age files)")],-1),Je=e("a",{href:"https://age-encryption.org",target:"_blank",class:"text-info"},"age CLI tool",-1),Qe={class:"d-flex align-start"},$e={class:"flex-grow-1"},et=e("div",{class:"text-h6 font-weight-medium mb-2"},"Decryption Failed",-1),tt={class:"text-body-1"},ot={class:"flex-grow-1"},st=e("div",{class:"text-subtitle-1 font-weight-medium"},"File Decrypted Successfully",-1),at={class:"text-body-2"},rt=e("p",{class:"text-h6 mt-4"},"Decrypting...",-1);function nt(ee,n,_,t,b,x){const y=i("ToolPageHeader"),u=i("EducationalAlert"),T=i("LearnMorePanel"),p=i("v-icon"),v=i("v-card-title"),w=i("v-radio"),M=i("v-radio-group"),z=i("v-alert"),g=i("v-card-text"),l=i("v-card"),U=i("PasswordInput"),j=i("v-checkbox"),A=i("v-chip"),V=i("TextInputWithActions"),W=i("v-divider"),H=i("FileUploadWithValidation"),C=i("v-btn"),I=i("v-spacer"),B=i("v-textarea"),R=i("CsvPreviewTable"),N=i("SharedSnackbar"),S=i("v-progress-circular"),k=i("v-overlay");return f(),L("div",null,[o(y,{icon:"mdi-lock-open",title:"Decryption",description:"Decrypt password-protected encrypted files and text","avatar-color":"primary-darken-1"}),o(T,{title:t.infoPanelTitle,"storage-key":"slurm-help-decrypt"},{default:r(()=>[t.selectedAlgorithm==="jsAesCrypt"?(f(),L(Z,{key:0},[Ve,We,o(u,{title:"Password Must Match Exactly",type:"warning",spacing:"mt-3"},{default:r(()=>[a(' The decryption password must be identical to the encryption password. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),Ie,Be,Le],64)):t.selectedAlgorithm==="webCrypto"?(f(),L(Z,{key:1},[Me,ze,o(u,{title:"Password Must Match Exactly",type:"warning",spacing:"mt-3"},{default:r(()=>[a(' The decryption password must be identical to the encryption password. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),Ue,je,He],64)):t.selectedAlgorithm==="age"?(f(),L(Z,{key:2},[Re,Ne,o(u,{title:"Passphrase Must Match Exactly",type:"warning",spacing:"mt-3"},{default:r(()=>[a(' The decryption passphrase must be identical to the encryption passphrase. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),Xe,Ke,Oe],64)):P("",!0)]),_:1},8,["title"]),e("form",{onSubmit:n[6]||(n[6]=fe((...d)=>t.decryptFile&&t.decryptFile(...d),["prevent"]))},[qe,o(l,{class:"mb-4"},{default:r(()=>[o(v,{class:"bg-surface-variant"},{default:r(()=>[o(p,{icon:"mdi-shield-lock",class:"mr-2"}),a(" Encryption Algorithm ")]),_:1}),o(g,{class:"pa-4"},{default:r(()=>[o(M,{modelValue:t.selectedAlgorithm,"onUpdate:modelValue":n[0]||(n[0]=d=>t.selectedAlgorithm=d),inline:""},{default:r(()=>[o(w,{value:"jsAesCrypt"},{label:r(()=>[Ge]),_:1}),o(w,{value:"webCrypto"},{label:r(()=>[Ze]),_:1}),o(w,{value:"age"},{label:r(()=>[Ye]),_:1})]),_:1},8,["modelValue"]),t.selectedAlgorithm==="age"?(f(),E(z,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:r(()=>[a(" Age encrypted files (.age) are compatible with the "),Je]),_:1})):P("",!0)]),_:1})]),_:1}),o(l,{class:"mb-4"},{default:r(()=>[o(v,{class:"bg-surface-variant"},{default:r(()=>[o(p,{icon:"mdi-key",class:"mr-2"}),a(" Enter Password ")]),_:1}),o(g,{class:"pa-4"},{default:r(()=>[o(U,{password:t.password,"onUpdate:password":n[1]||(n[1]=d=>t.password=d),"require-confirmation":!1,"show-strength":!0,"show-requirements":!1,"show-feedback":!1,autocomplete:"current-password","password-label":"Decryption Password","password-placeholder":"Enter the password used for encryption","password-icon":"mdi-lock-open"},null,8,["password"]),o(j,{modelValue:t.rememberPassword,"onUpdate:modelValue":n[2]||(n[2]=d=>t.rememberPassword=d),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),t.isPasswordRemembered?(f(),E(A,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":t.clearSessionPassword,class:"mt-2"},{default:r(()=>[a(" Password remembered for session ")]),_:1},8,["onClick:close"])):P("",!0)]),_:1})]),_:1}),o(l,{class:"mb-4"},{default:r(()=>[o(v,{class:"bg-surface-variant"},{default:r(()=>[o(p,{icon:"mdi-lock",class:"mr-2"}),a(" Encrypted Text ")]),_:1}),o(g,{class:"pa-4"},{default:r(()=>[o(V,{modelValue:t.encryptedText,"onUpdate:modelValue":n[3]||(n[3]=d=>t.encryptedText=d),label:"Paste encrypted Base64 text",placeholder:"Paste the encrypted text here...",rows:4,disabled:t.isFilePopulated,"show-paste":!t.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"encrypted-text-input",onPaste:t.handlePaste,onClear:t.clearEncryptedText,onInput:t.handleEncryptedTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),o(W,{class:"my-4"}),o(V,{modelValue:t.decryptedText,"onUpdate:modelValue":n[4]||(n[4]=d=>t.decryptedText=d),label:"Decrypted Text",placeholder:"Decrypted output will appear here...",rows:4,"is-loading":t.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:t.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),o(l,{class:"mb-4"},{default:r(()=>[o(v,{class:"bg-surface-variant"},{default:r(()=>[o(p,{icon:"mdi-file-lock",class:"mr-2"}),a(" Encrypted File ")]),_:1}),o(g,{class:"pa-4"},{default:r(()=>[o(H,{modelValue:t.encryptedFile,"onUpdate:modelValue":n[5]||(n[5]=d=>t.encryptedFile=d),label:"Select encrypted file (.aes or .age)",accept:".aes,.age","button-text":"Decrypt","button-icon":"mdi-lock-open",disabled:t.isEncryptedTextPopulated,"can-submit":t.canDecrypt,onSubmit:t.decryptFile,onValidationChange:t.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1})],32),t.error?(f(),E(l,{key:0,variant:"tonal",color:"error",class:"mb-4"},{default:r(()=>[o(g,{class:"pa-4"},{default:r(()=>[e("div",Qe,[o(p,{icon:"mdi-alert-circle",size:"32",color:"error",class:"mr-4 mt-1"}),e("div",$e,[et,e("div",tt,$(t.error),1)]),o(C,{icon:"",size:"small",variant:"text",onClick:n[7]||(n[7]=d=>t.error=""),class:"ml-2"},{default:r(()=>[o(p,null,{default:r(()=>[a("mdi-close")]),_:1})]),_:1})])]),_:1})]),_:1})):P("",!0),t.plainText?(f(),E(l,{key:1,variant:"tonal",class:"mb-4"},{default:r(()=>[o(v,{class:"d-flex align-center","data-testid":"file-info"},{default:r(()=>[o(p,{icon:"mdi-text",class:"mr-2"}),a(" Decrypted Text "),o(I),t.decryptedFileName?(f(),E(C,{key:0,variant:"text",color:"primary",onClick:t.downloadDecryptedText,class:"mr-2"},{default:r(()=>[o(p,{start:""},{default:r(()=>[a("mdi-download")]),_:1}),a(" Download ")]),_:1},8,["onClick"])):P("",!0),o(C,{icon:"",size:"small",variant:"text",onClick:t.clearOutputs},{default:r(()=>[o(p,null,{default:r(()=>[a("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1}),o(g,{class:"pa-4"},{default:r(()=>[o(B,{modelValue:t.plainText,"onUpdate:modelValue":n[8]||(n[8]=d=>t.plainText=d),variant:"outlined",rows:"10",readonly:"","bg-color":"grey-lighten-4",placeholder:"Decrypted text","data-testid":"file-preview","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})):P("",!0),o(R,{headers:t.tableHeaders,data:t.tableData,"show-download":!!t.decryptedFileName,"card-class":"mb-4","test-id":"file-preview",onClose:t.clearOutputs,onDownload:t.downloadDecryptedText},null,8,["headers","data","show-download","onClose","onDownload"]),t.decryptedFileName&&!t.plainText&&!t.tableData.length?(f(),E(l,{key:2,variant:"tonal",color:"success"},{default:r(()=>[o(g,{class:"d-flex align-center pa-4"},{default:r(()=>[o(p,{icon:"mdi-check-circle",size:"32",class:"mr-4"}),e("div",ot,[st,e("div",at,$(t.decryptedFileName),1)]),o(C,{variant:"elevated",color:"white",onClick:t.downloadDecryptedText,class:"mr-2"},{default:r(()=>[o(p,{start:""},{default:r(()=>[a("mdi-download")]),_:1}),a(" Download Again ")]),_:1},8,["onClick"]),o(C,{icon:"",size:"small",variant:"text",onClick:t.clearOutputs},{default:r(()=>[o(p,null,{default:r(()=>[a("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})):P("",!0),o(N,{modelValue:t.snackbar,"onUpdate:modelValue":n[9]||(n[9]=d=>t.snackbar=d),text:t.snackbarText,color:t.snackbarColor},null,8,["modelValue","text","color"]),o(k,{"model-value":t.isLoading,class:"align-center justify-center"},{default:r(()=>[o(S,{indeterminate:"",size:"64",color:"primary"}),rt]),_:1},8,["model-value"])])}const gt=he(Fe,[["render",nt]]);export{gt as default};
