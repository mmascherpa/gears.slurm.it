import{r as b,d as K,m as ge,v as Ie,k as _e,_ as Ce,z as it,e as d,c as Z,j as O,o as V,g as h,b as t,q as ut,A as X,t as I,w as a,s as pe,i as J,f as g,p as Ue,h as Te,B as Je,l as ct,F as we,C as Ve,D as et,a as dt,E as mt}from"./index-CLKbXmT3.js";import{u as pt,S as vt,T as ft}from"./ToolPageHeader-BI_QYBdR.js";import{d as qe}from"./fileDownload-B1vhVzTR.js";import{_ as yt}from"./EducationalAlert-Z7WFHq04.js";import{u as tt}from"./useClipboard-KqVwDR14.js";import{g as wt}from"./passwordGenerator-DrRtYIk4.js";import{P as at,c as _t}from"./PasswordStrengthIndicator-CaVB0Qrk.js";const xe="slurm-password-vault",Ae="slurm-vault-last-activity",$e="slurm-vault-unlock-attempts",gt=1,He=5,Ge=6e4;function ht(){const e=new Date().toISOString();return{version:gt,entries:[],settings:{autoLockMinutes:5},metadata:{createdAt:e,lastModifiedAt:e}}}function Fe(e){const s=new Date().toISOString();return{id:crypto.randomUUID(),name:e.name||"",username:e.username||"",email:e.email||"",url:e.url||"",password:e.password||"",totp:e.totp||"",note:e.note||"",createdAt:e.createdAt||s,updatedAt:e.updatedAt||s}}function nt(){const e=b(null),s=b(!0),n=b(!1),o=b(null),i=b(null),p=b(!1),r=b(0);let v=null,l=null,w=null;const f=b(!1);try{f.value=localStorage.getItem(xe)!==null}catch{f.value=!1}const q=K(()=>f.value),$=K(()=>{var c,m;return((m=(c=e.value)==null?void 0:c.entries)==null?void 0:m.length)||0});function D(){v||(v=new Worker(new URL("/assets/cryptoWorker-DRYHjFPq.js",import.meta.url),{type:"module"}),v.onmessage=Y,v.onerror=c=>{console.error("Vault worker error:",c),n.value=!1,o.value="Encryption worker error",l!=null&&l.reject&&(l.reject(new Error("Worker error")),l=null)})}function Y(c){const[m,u,S]=c.data;if(n.value=!1,m==="ERROR"){o.value=u,l!=null&&l.reject&&(l.reject(new Error(u)),l=null);return}l!=null&&l.resolve&&(l.resolve({action:m,data:u,extra:S}),l=null)}async function C(c,m){return D(),new Promise((u,S)=>{l={resolve:u,reject:S};const re=new TextEncoder().encode(c),ie=new Blob([re]);v.postMessage(["ENCRYPT",ie,m,"vault.json","age"])}).then(u=>{if(u.action==="ENCRYPT")return u.data;throw new Error("Unexpected response")})}async function L(c,m){return D(),new Promise((u,S)=>{l={resolve:u,reject:S};const N=new Blob([c]);v.postMessage(["DECRYPT",N,m,"vault.age","age"])}).then(u=>{if(u.action==="DECRYPT")return new TextDecoder().decode(u.data);throw new Error("Unexpected response")})}async function k(c){if(!c)return o.value="Password is required",!1;n.value=!0,o.value=null;try{const m=ht(),u=JSON.stringify(m),S=await C(u,c),N=Qe(S);return localStorage.setItem(xe,N),e.value=m,i.value=c,s.value=!1,f.value=!0,T(),!0}catch(m){return console.error("Failed to create vault:",m),o.value=typeof m=="string"?m:m.message||"Failed to create vault",!1}finally{n.value=!1}}function E(){try{const c=sessionStorage.getItem($e);if(c)return JSON.parse(c)}catch{}return{attempts:0,lockoutUntil:null}}function H(){const c=E();c.attempts++,c.attempts>=He&&(c.lockoutUntil=Date.now()+Ge,A(c.lockoutUntil));try{sessionStorage.setItem($e,JSON.stringify(c))}catch{}}function G(){try{sessionStorage.removeItem($e),p.value=!1,r.value=0,w&&(clearInterval(w),w=null)}catch{}}function A(c){p.value=!0;const m=()=>{const u=Math.max(0,Math.ceil((c-Date.now())/1e3));if(r.value=u,u<=0){p.value=!1,w&&(clearInterval(w),w=null);try{sessionStorage.removeItem($e)}catch{}}};m(),w&&clearInterval(w),w=setInterval(m,1e3)}function P(){const c=E();return c.lockoutUntil&&c.lockoutUntil>Date.now()?(A(c.lockoutUntil),!0):!1}function z(){const c=E();return Math.max(0,He-c.attempts)}async function x(c){if(!c)return o.value="Password is required",!1;if(P())return o.value=`Too many failed attempts. Try again in ${r.value} seconds.`,!1;n.value=!0,o.value=null;try{const m=localStorage.getItem(xe);if(!m)return o.value="No vault found",!1;const u=kt(m),S=await L(u,c),N=JSON.parse(S);return!N.version||!Array.isArray(N.entries)?(o.value="Invalid vault format",!1):(e.value=N,i.value=c,s.value=!1,T(),G(),!0)}catch(m){console.error("Failed to unlock vault:",m);const u=typeof m=="string"?m:m.message||"Failed to unlock vault";H();const S=z();return u.toLowerCase().includes("decrypt")||u.toLowerCase().includes("password")?S>0?o.value=`Incorrect password. ${S} attempt${S===1?"":"s"} remaining.`:o.value=`Incorrect password. Too many failed attempts. Try again in ${Math.ceil(Ge/1e3)} seconds.`:o.value=u,!1}finally{n.value=!1}}function Q(){e.value=null,i.value=null,s.value=!0,o.value=null;try{sessionStorage.removeItem(Ae)}catch{}}async function B(){if(!e.value||!i.value)return o.value="Vault not unlocked",!1;n.value=!0,o.value=null;try{e.value.metadata.lastModifiedAt=new Date().toISOString();const c=JSON.stringify(e.value),m=await C(c,i.value),u=Qe(m);try{localStorage.setItem(xe,u)}catch(S){if(S.name==="QuotaExceededError"||S.code===22||S.code===1014)return o.value="Storage quota exceeded. Please export your vault and clear browser data, or remove some entries.",!1;throw S}return T(),!0}catch(c){return console.error("Failed to save vault:",c),o.value=typeof c=="string"?c:c.message||"Failed to save vault",!1}finally{n.value=!1}}async function F(c){if(!e.value)return o.value="Vault not unlocked",null;const m=Fe(c);return e.value.entries.push(m),await B()?m:(e.value.entries.pop(),null)}async function te(c,m){if(!e.value)return o.value="Vault not unlocked",null;const u=e.value.entries.findIndex(ie=>ie.id===c);if(u===-1)return o.value="Entry not found",null;const S={...e.value.entries[u]},N={...S,...m,id:S.id,createdAt:S.createdAt,updatedAt:new Date().toISOString()};return e.value.entries[u]=N,await B()?N:(e.value.entries[u]=S,null)}async function y(c){if(!e.value)return o.value="Vault not unlocked",!1;const m=e.value.entries.findIndex(N=>N.id===c);if(m===-1)return o.value="Entry not found",!1;const u=e.value.entries.splice(m,1)[0];return await B()?!0:(e.value.entries.splice(m,0,u),!1)}async function U(c,m="skip"){if(!e.value)return o.value="Vault not unlocked",{added:0,updated:0,skipped:0};const u={added:0,updated:0,skipped:0},S=new Map;e.value.entries.forEach(N=>{const re=`${N.name.toLowerCase()}|${N.username.toLowerCase()}`;S.set(re,N)});for(const N of c){const re=`${(N.name||"").toLowerCase()}|${(N.username||"").toLowerCase()}`,ie=S.get(re);if(ie){if(m==="skip")u.skipped++;else if(m==="overwrite")Object.assign(ie,{...N,id:ie.id,createdAt:ie.createdAt,updatedAt:new Date().toISOString()}),u.updated++;else if(m==="keepBoth"){const ve=Fe(N);e.value.entries.push(ve),u.added++}}else{const ve=Fe(N);e.value.entries.push(ve),S.set(re,ve),u.added++}}return(u.added>0||u.updated>0)&&await B(),u}function R(c){var u;if(!e.value||!c)return((u=e.value)==null?void 0:u.entries)||[];const m=c.toLowerCase();return e.value.entries.filter(S=>S.name.toLowerCase().includes(m)||S.username.toLowerCase().includes(m)||S.email.toLowerCase().includes(m)||S.url.toLowerCase().includes(m)||S.note.toLowerCase().includes(m))}function le(){return e.value?[...e.value.entries].sort((c,m)=>c.name.toLowerCase().localeCompare(m.name.toLowerCase())):[]}async function ee(c,m){if(!e.value)return o.value="Vault not unlocked",!1;if(c!==i.value)return o.value="Current password is incorrect",!1;if(!m)return o.value="New password is required",!1;const u=i.value;return i.value=m,await B()?!0:(i.value=u,!1)}function ae(){try{return localStorage.removeItem(xe),sessionStorage.removeItem(Ae),e.value=null,i.value=null,s.value=!0,f.value=!1,o.value=null,!0}catch(c){return console.error("Failed to delete vault:",c),o.value="Failed to delete vault",!1}}function T(){try{sessionStorage.setItem(Ae,Date.now().toString())}catch{}}function se(){try{const c=sessionStorage.getItem(Ae);return c?parseInt(c,10):null}catch{return null}}function ce(){var c,m;return((m=(c=e.value)==null?void 0:c.settings)==null?void 0:m.autoLockMinutes)||5}return ge(()=>{v&&(v.terminate(),v=null),w&&(clearInterval(w),w=null)}),{vault:e,isLocked:s,isLoading:n,error:o,hasVault:q,entryCount:$,isLockedOut:p,lockoutRemainingSeconds:r,createVault:k,unlockVault:x,lockVault:Q,saveVault:B,deleteVault:ae,changeMasterPassword:ee,addEntry:F,updateEntry:te,deleteEntry:y,importEntries:U,searchEntries:R,getEntries:le,updateActivity:T,getLastActivity:se,getAutoLockMinutes:ce,getRemainingAttempts:z,checkLockoutState:P}}function Qe(e){const s=e instanceof Uint8Array?e:new Uint8Array(e);let n="";for(let o=0;o<s.byteLength;o++)n+=String.fromCharCode(s[o]);return btoa(n)}function kt(e){const s=atob(e),n=new Uint8Array(s.length);for(let o=0;o<s.length;o++)n[o]=s.charCodeAt(o);return n}const Re="slurm-vault-last-activity";function bt(e={}){const{onLock:s=()=>{},getTimeout:n=()=>5,isLocked:o=()=>!0}=e,i=b(!0);let p=null;function r(){if(!o())try{sessionStorage.setItem(Re,Date.now().toString())}catch{}}function v(){try{const L=sessionStorage.getItem(Re);return L?parseInt(L,10):null}catch{return null}}function l(){if(o()||!i.value)return!1;const L=v();if(!L)return!1;const k=Date.now(),E=n()*60*1e3;return k-L>E?(s(),!0):!1}function w(){r()}function f(){document.hidden||l()}function q(){i.value=!0,r(),p&&clearInterval(p),p=setInterval(l,3e4),window.addEventListener("click",w),window.addEventListener("keydown",w),window.addEventListener("mousemove",w),window.addEventListener("scroll",w),document.addEventListener("visibilitychange",f)}function $(){i.value=!1,p&&(clearInterval(p),p=null),window.removeEventListener("click",w),window.removeEventListener("keydown",w),window.removeEventListener("mousemove",w),window.removeEventListener("scroll",w),document.removeEventListener("visibilitychange",f)}function D(){r()}function Y(){try{sessionStorage.removeItem(Re)}catch{}}function C(){if(o())return null;const L=v();if(!L)return null;const k=Date.now(),H=n()*60*1e3-(k-L);return Math.max(0,Math.floor(H/1e3))}return Ie(()=>{}),ge(()=>{$()}),{isActive:i,start:q,stop:$,reset:D,clear:Y,updateActivity:r,checkAutoLock:l,getTimeRemaining:C,getLastActivity:v}}function xt(e){if(!e||e.length===0)return`name,username,email,url,password,totp,note,created_at,updated_at
`;const s=["name","username","email","url","password","totp","note","created_at","updated_at"],n=[s.join(",")];return e.forEach(o=>{const i=s.map(p=>{const v=o[p==="created_at"?"createdAt":p==="updated_at"?"updatedAt":p]||"";return Vt(v)});n.push(i.join(","))}),n.join(`
`)}function Vt(e){if(e==null)return"";const s=String(e);return s.includes(",")||s.includes('"')||s.includes(`
`)||s.includes("\r")?`"${s.replace(/"/g,'""')}"`:s}function Ct(e,s=!0){e||(e=[]);const n=e.map(o=>({name:o.name||"",username:o.username||"",email:o.email||"",url:o.url||"",password:o.password||"",totp:o.totp||"",note:o.note||"",created_at:o.createdAt||"",updated_at:o.updatedAt||""}));return s?JSON.stringify(n,null,2):JSON.stringify(n)}function Xe(e){return`slurm-passwords-${new Date().toISOString().split("T")[0]}.${e==="json"?"json":"csv"}`}const je="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";function Et(e){const s=e.toUpperCase().replace(/[\s=-]/g,"");if(s.length===0)return new Uint8Array(0);for(const v of s)if(!je.includes(v))throw new Error(`Invalid Base32 character: ${v}`);const n=Math.floor(s.length*5/8),o=new Uint8Array(n);let i=0,p=0,r=0;for(const v of s)p=p<<5|je.indexOf(v),i+=5,i>=8&&(i-=8,o[r++]=p>>i&255);return o}function ot(e){if(!e||typeof e!="string")return{isValid:!1,error:"Secret is required",normalized:""};const s=e.toUpperCase().replace(/[\s=-]/g,"");if(s.length===0)return{isValid:!1,error:"Secret is empty after normalization",normalized:""};if(s.length<8)return{isValid:!1,error:"Secret is too short (minimum 8 characters)",normalized:s};for(const n of s)if(!je.includes(n))return{isValid:!1,error:`Invalid character: ${n}`,normalized:s};return{isValid:!0,error:null,normalized:s}}async function St(e,s={}){const{period:n=30,digits:o=6,algorithm:i="SHA-1",timestamp:p=Date.now()}=s,r=Et(e);if(r.length===0)throw new Error("Invalid secret: decoded to empty bytes");const v=Math.floor(p/1e3/n),l=new ArrayBuffer(8),w=new DataView(l);w.setUint32(0,Math.floor(v/4294967296),!1),w.setUint32(4,v>>>0,!1);const f=await crypto.subtle.importKey("raw",r,{name:"HMAC",hash:i},!1,["sign"]),q=await crypto.subtle.sign("HMAC",f,l),$=new Uint8Array(q),D=$[$.length-1]&15;return((($[D]&127)<<24|($[D+1]&255)<<16|($[D+2]&255)<<8|$[D+3]&255)%Math.pow(10,o)).toString().padStart(o,"0")}function At(e=30){const s=Math.floor(Date.now()/1e3);return e-s%e}function $t(e,s={}){const{period:n=30,digits:o=6,algorithm:i="SHA-1"}=s,p=b("------"),r=b(n),v=b(!1),l=b(null);let w=null;const f=K(()=>{const k=(e==null?void 0:e.value)||e;return k?ot(k):{isValid:!1,error:null,normalized:""}}),q=K(()=>f.value.isValid);async function $(){const k=(e==null?void 0:e.value)||e;if(!k){p.value="------",l.value=null;return}if(!f.value.isValid){p.value="------",l.value=f.value.error;return}v.value=!0,l.value=null;try{p.value=await St(k,{period:n,digits:o,algorithm:i})}catch(E){const H=typeof E=="string"?E:E.message||"Failed to generate code";l.value=H,p.value="------",console.error("TOTP generation error:",E)}finally{v.value=!1}}function D(){r.value=At(n)}async function Y(){const k=r.value;D(),r.value>k&&await $()}async function C(){L(),D(),await $(),w=setInterval(Y,1e3)}function L(){w&&(clearInterval(w),w=null)}return _e(()=>(e==null?void 0:e.value)||e,async k=>{k&&w&&await $()}),ge(()=>{L()}),{code:p,timeRemaining:r,isGenerating:v,isValid:q,error:l,start:C,stop:L,refresh:$}}const Lt={key:0,class:"totp-display"},It={class:"d-flex align-center"},Ut={class:"text-caption"},Tt={key:0,class:"text-caption text-error mt-1"},Dt={__name:"TotpDisplay",props:{secret:{type:String,default:""}},emits:["copy-success","copy-error"],setup(e,{emit:s}){const n=e,o=s,{copyToClipboard:i}=tt(),p=it(n,"secret"),{code:r,timeRemaining:v,isGenerating:l,isValid:w,error:f,start:q,stop:$}=$t(p),D=K(()=>r.value.length===6?`${r.value.slice(0,3)} ${r.value.slice(3)}`:r.value);async function Y(){!w.value||r.value==="------"||await i(r.value,C=>o("copy-success","2FA code copied"),C=>o("copy-error",C))}return _e(()=>n.secret,C=>{C?q():$()},{immediate:!1}),Ie(()=>{n.secret&&q()}),ge(()=>{$()}),(C,L)=>{const k=d("v-progress-circular"),E=d("v-icon"),H=d("v-btn"),G=d("v-tooltip");return e.secret?(V(),Z("div",Lt,[h("div",It,[h("span",{class:ut(["totp-code text-h6 font-weight-bold mr-2",{"text-error":X(v)<=5}])},I(D.value),3),t(k,{"model-value":X(v)/30*100,size:28,width:3,color:X(v)<=5?"error":"primary",class:"mr-2"},{default:a(()=>[h("span",Ut,I(X(v)),1)]),_:1},8,["model-value","color"]),t(G,{text:"Copy 2FA code",location:"top"},{activator:a(({props:A})=>[t(H,pe(A,{icon:"",size:"small",variant:"text",onClick:Y,disabled:!X(w)||X(l)}),{default:a(()=>[t(E,{icon:"mdi-content-copy",size:"18"})]),_:2},1040,["disabled"])]),_:1})]),X(f)?(V(),Z("div",Tt,I(X(f)),1)):O("",!0)])):O("",!0)}}},lt=Ce(Dt,[["__scopeId","data-v-45b418d3"]]),Pt=e=>(Ue("data-v-7fe96f61"),e=e(),Te(),e),Mt={class:"d-flex align-start"},Nt={class:"text-h6 font-weight-bold text-white"},Ot={key:1,class:"text-h6 font-weight-bold text-white"},zt={class:"flex-grow-1 overflow-hidden"},Bt={class:"d-flex align-center mb-1"},Ft={class:"text-subtitle-1 font-weight-medium text-truncate"},Rt={class:"text-body-2 text-medium-emphasis text-truncate mb-1"},jt={class:"d-flex align-center"},Wt={class:"password-display text-body-2 font-weight-medium mr-2"},Kt={key:0,class:"text-caption text-medium-emphasis text-truncate mt-1"},Yt={key:1,class:"mt-2"},Jt={class:"d-flex align-center mb-1"},qt=Pt(()=>h("span",{class:"text-caption text-medium-emphasis"},"2FA Code",-1)),Ht={class:"d-flex justify-end mt-2 action-buttons"},Gt={__name:"PasswordEntryCard",props:{entry:{type:Object,required:!0}},emits:["edit","delete","copy-success","copy-error"],setup(e,{emit:s}){const n=e,o=s,{copyToClipboard:i}=tt(),p=b(!1),r=b(!1),v=b(!1),l=b(!1);let w=null;ge(()=>{w&&(clearTimeout(w),w=null)});const f=K(()=>(n.entry.name||"?").charAt(0).toUpperCase()),q=K(()=>{const A=["primary","secondary","success","info","warning"],P=n.entry.name.split("").reduce((z,x)=>z+x.charCodeAt(0),0);return A[P%A.length]}),$=K(()=>{var A;return"â€¢".repeat(Math.min(((A=n.entry.password)==null?void 0:A.length)||8,16))}),D=K(()=>{if(!n.entry.url)return"";try{return new URL(Y.value).hostname}catch{return n.entry.url}}),Y=K(()=>{if(!n.entry.url)return"";const A=n.entry.url.trim();return A.startsWith("http://")||A.startsWith("https://")?A:`https://${A}`}),C=K(()=>{if(l.value||!n.entry.url)return null;try{return`https://icons.duckduckgo.com/ip3/${new URL(Y.value).hostname}.ico`}catch{return null}});function L(){p.value=!p.value,w&&(clearTimeout(w),w=null),p.value&&(w=setTimeout(()=>{p.value=!1,w=null},1e4))}async function k(){await i(n.entry.password,()=>o("copy-success","Password copied"),A=>o("copy-error",A))}async function E(){await i(n.entry.username,()=>o("copy-success","Username copied"),A=>o("copy-error",A))}function H(){r.value=!0}function G(){r.value=!1,o("delete",n.entry)}return(A,P)=>{const z=d("v-img"),x=d("v-avatar"),Q=d("v-icon"),B=d("v-btn"),F=d("v-tooltip"),te=d("v-divider"),y=d("v-card-text"),U=d("v-card-title"),R=d("v-spacer"),le=d("v-card-actions"),ee=d("v-card"),ae=d("v-dialog");return V(),J(ee,{class:"password-entry-card",elevation:v.value?4:2},{default:a(()=>[t(y,{class:"pa-3"},{default:a(()=>[h("div",Mt,[t(x,{color:q.value,size:"40",class:"mr-3 flex-shrink-0"},{default:a(()=>[C.value&&!l.value?(V(),J(z,{key:0,src:C.value,onError:P[0]||(P[0]=T=>l.value=!0)},{placeholder:a(()=>[h("span",Nt,I(f.value),1)]),_:1},8,["src"])):(V(),Z("span",Ot,I(f.value),1))]),_:1},8,["color"]),h("div",zt,[h("div",Bt,[h("span",Ft,I(e.entry.name),1)]),h("div",Rt,I(e.entry.username||e.entry.email||"No username"),1),h("div",jt,[h("span",Wt,I(p.value?e.entry.password:$.value),1)]),e.entry.url?(V(),Z("div",Kt,I(D.value),1)):O("",!0),e.entry.totp?(V(),Z("div",Yt,[h("div",Jt,[t(Q,{icon:"mdi-two-factor-authentication",size:"14",class:"mr-1 text-medium-emphasis"}),qt]),t(lt,{secret:e.entry.totp,onCopySuccess:P[1]||(P[1]=T=>A.$emit("copy-success",T)),onCopyError:P[2]||(P[2]=T=>A.$emit("copy-error",T))},null,8,["secret"])])):O("",!0)])]),h("div",Ht,[t(F,{text:"Show/hide password",location:"top"},{activator:a(({props:T})=>[t(B,pe(T,{icon:"",size:"small",variant:"text",onClick:L}),{default:a(()=>[t(Q,{icon:p.value?"mdi-eye-off":"mdi-eye",size:"18"},null,8,["icon"])]),_:2},1040)]),_:1}),t(F,{text:"Copy password",location:"top"},{activator:a(({props:T})=>[t(B,pe(T,{icon:"",size:"small",variant:"text",onClick:k}),{default:a(()=>[t(Q,{icon:"mdi-content-copy",size:"18"})]),_:2},1040)]),_:1}),e.entry.username?(V(),J(F,{key:0,text:"Copy username",location:"top"},{activator:a(({props:T})=>[t(B,pe(T,{icon:"",size:"small",variant:"text",onClick:E}),{default:a(()=>[t(Q,{icon:"mdi-account",size:"18"})]),_:2},1040)]),_:1})):O("",!0),e.entry.url?(V(),J(F,{key:1,text:"Open URL",location:"top"},{activator:a(({props:T})=>[t(B,pe(T,{icon:"",size:"small",variant:"text",href:Y.value,target:"_blank",rel:"noopener noreferrer"}),{default:a(()=>[t(Q,{icon:"mdi-arrow-right-circle",size:"18"})]),_:2},1040,["href"])]),_:1})):O("",!0),t(te,{vertical:"",class:"mx-1"}),t(F,{text:"Edit entry",location:"top"},{activator:a(({props:T})=>[t(B,pe(T,{icon:"",size:"small",variant:"text",onClick:P[3]||(P[3]=se=>A.$emit("edit",e.entry))}),{default:a(()=>[t(Q,{icon:"mdi-pencil",size:"18"})]),_:2},1040)]),_:1}),t(F,{text:"Delete entry",location:"top"},{activator:a(({props:T})=>[t(B,pe(T,{icon:"",size:"small",variant:"text",color:"error",onClick:H}),{default:a(()=>[t(Q,{icon:"mdi-delete",size:"18"})]),_:2},1040)]),_:1})])]),_:1}),t(ae,{modelValue:r.value,"onUpdate:modelValue":P[5]||(P[5]=T=>r.value=T),"max-width":"400"},{default:a(()=>[t(ee,null,{default:a(()=>[t(U,{class:"bg-surface-variant"},{default:a(()=>[t(Q,{icon:"mdi-alert",color:"warning",class:"mr-2"}),g(" Delete Entry ")]),_:1}),t(y,{class:"pa-4"},{default:a(()=>[g(" Are you sure you want to delete "),h("strong",null,I(e.entry.name),1),g("? This action cannot be undone. ")]),_:1}),t(le,{class:"pa-4 pt-0"},{default:a(()=>[t(R),t(B,{variant:"text",onClick:P[4]||(P[4]=T=>r.value=!1)},{default:a(()=>[g("Cancel")]),_:1}),t(B,{color:"error",onClick:G},{default:a(()=>[g("Delete")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["elevation"])}}},Qt=Ce(Gt,[["__scopeId","data-v-7fe96f61"]]),Xt=e=>(Ue("data-v-a109ad8c"),e=e(),Te(),e),Zt={class:"d-flex align-start gap-2 mb-2"},ea={class:"d-flex align-center justify-space-between mb-2"},ta={class:"text-body-2"},aa={class:"d-flex flex-wrap gap-2 mb-3"},na={key:0,class:"mb-3"},oa=Xt(()=>h("div",{class:"text-caption text-medium-emphasis mb-1"},"Preview",-1)),la={__name:"PasswordEntryDialog",props:{modelValue:{type:Boolean,default:!1},entry:{type:Object,default:null},isLoading:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(e,{emit:s}){const n=e,o=s;function i(z){z.key==="Escape"&&n.modelValue&&!n.isLoading&&P()}Ie(()=>{document.addEventListener("keydown",i)}),ge(()=>{document.removeEventListener("keydown",i)});const p=b(null),r=b(!1),v=b(!1),l=Je({name:"",username:"",email:"",url:"",password:"",totp:"",note:""}),w=b(20),f=Je({uppercase:!0,lowercase:!0,numbers:!0,special:!0}),q={required:z=>!!z||"This field is required",email:z=>!z||/.+@.+\..+/.test(z)||"Invalid email format"},$=K(()=>!!n.entry),D=K(()=>l.name.trim().length>0),Y=K(()=>f.uppercase||f.lowercase||f.numbers||f.special),C=K(()=>l.totp?ot(l.totp):{isValid:!0,error:null,normalized:""}),L=K(()=>C.value.isValid),k=K(()=>!l.totp||C.value.isValid?"":C.value.error),E=K(()=>l.totp?C.value.isValid?"Valid - 2FA code will be generated":"":"Enter Base32 secret key from your 2FA setup");_e(()=>n.modelValue,z=>{z&&(n.entry?(l.name=n.entry.name||"",l.username=n.entry.username||"",l.email=n.entry.email||"",l.url=n.entry.url||"",l.password=n.entry.password||"",l.totp=n.entry.totp||"",l.note=n.entry.note||""):(H(),G()),r.value=!1,v.value=!1)});function H(){l.name="",l.username="",l.email="",l.url="",l.password="",l.totp="",l.note=""}function G(){Y.value&&(l.password=wt({length:w.value,includeUppercase:f.uppercase,includeLowercase:f.lowercase,includeNumbers:f.numbers,includeSpecial:f.special}),r.value=!0)}function A(){D.value&&o("submit",{name:l.name.trim(),username:l.username.trim(),email:l.email.trim(),url:l.url.trim(),password:l.password,totp:l.totp.trim(),note:l.note.trim()})}function P(){o("update:modelValue",!1)}return(z,x)=>{const Q=d("v-icon"),B=d("v-card-title"),F=d("v-text-field"),te=d("v-btn"),y=d("v-tooltip"),U=d("v-slider"),R=d("v-chip"),le=d("v-card-text"),ee=d("v-card"),ae=d("v-expand-transition"),T=d("v-textarea"),se=d("v-form"),ce=d("v-spacer"),c=d("v-card-actions"),m=d("v-dialog");return V(),J(m,{"model-value":e.modelValue,"onUpdate:modelValue":x[14]||(x[14]=u=>z.$emit("update:modelValue",u)),"max-width":"550",persistent:""},{default:a(()=>[t(ee,null,{default:a(()=>[t(B,{class:"bg-surface-variant d-flex align-center"},{default:a(()=>[t(Q,{icon:$.value?"mdi-pencil":"mdi-plus",class:"mr-2"},null,8,["icon"]),g(" "+I($.value?"Edit Entry":"Add New Entry"),1)]),_:1}),t(le,{class:"pa-4"},{default:a(()=>[t(se,{ref_key:"formRef",ref:p,onSubmit:ct(A,["prevent"])},{default:a(()=>[t(F,{modelValue:l.name,"onUpdate:modelValue":x[0]||(x[0]=u=>l.name=u),label:"Name",placeholder:"e.g., GitHub, Gmail, Netflix",rules:[q.required],autofocus:"",class:"mb-2"},null,8,["modelValue","rules"]),t(F,{modelValue:l.username,"onUpdate:modelValue":x[1]||(x[1]=u=>l.username=u),label:"Username",placeholder:"Your login username",class:"mb-2"},null,8,["modelValue"]),t(F,{modelValue:l.email,"onUpdate:modelValue":x[2]||(x[2]=u=>l.email=u),label:"Email",type:"email",placeholder:"your@email.com",rules:[q.email],class:"mb-2"},null,8,["modelValue","rules"]),t(F,{modelValue:l.url,"onUpdate:modelValue":x[3]||(x[3]=u=>l.url=u),label:"Website URL",placeholder:"https://example.com",class:"mb-2"},null,8,["modelValue"]),h("div",Zt,[t(F,{modelValue:l.password,"onUpdate:modelValue":x[4]||(x[4]=u=>l.password=u),type:r.value?"text":"password",label:"Password","append-inner-icon":r.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":x[5]||(x[5]=u=>r.value=!r.value),class:"flex-grow-1 password-field"},null,8,["modelValue","type","append-inner-icon"]),t(y,{text:"Generate password",location:"top"},{activator:a(({props:u})=>[t(te,pe(u,{icon:"",variant:"tonal",color:"primary",onClick:x[6]||(x[6]=S=>v.value=!v.value),class:"mt-1"}),{default:a(()=>[t(Q,{icon:"mdi-refresh"})]),_:2},1040)]),_:1})]),t(ae,null,{default:a(()=>[v.value?(V(),J(ee,{key:0,variant:"outlined",class:"mb-3"},{default:a(()=>[t(le,{class:"pa-3"},{default:a(()=>[h("div",ea,[h("span",ta,"Length: "+I(w.value),1),t(U,{modelValue:w.value,"onUpdate:modelValue":x[7]||(x[7]=u=>w.value=u),min:8,max:64,step:1,color:"primary","hide-details":"",style:{"max-width":"200px"}},null,8,["modelValue"])]),h("div",aa,[t(R,{color:f.uppercase?"primary":"default",variant:f.uppercase?"flat":"outlined",size:"small",onClick:x[8]||(x[8]=u=>f.uppercase=!f.uppercase)},{default:a(()=>[g(" A-Z ")]),_:1},8,["color","variant"]),t(R,{color:f.lowercase?"primary":"default",variant:f.lowercase?"flat":"outlined",size:"small",onClick:x[9]||(x[9]=u=>f.lowercase=!f.lowercase)},{default:a(()=>[g(" a-z ")]),_:1},8,["color","variant"]),t(R,{color:f.numbers?"primary":"default",variant:f.numbers?"flat":"outlined",size:"small",onClick:x[10]||(x[10]=u=>f.numbers=!f.numbers)},{default:a(()=>[g(" 0-9 ")]),_:1},8,["color","variant"]),t(R,{color:f.special?"primary":"default",variant:f.special?"flat":"outlined",size:"small",onClick:x[11]||(x[11]=u=>f.special=!f.special)},{default:a(()=>[g(" !@#$ ")]),_:1},8,["color","variant"])]),t(te,{block:"",color:"primary",size:"small",onClick:G,disabled:!Y.value},{default:a(()=>[t(Q,{icon:"mdi-refresh",class:"mr-2"}),g(" Generate Password ")]),_:1},8,["disabled"])]),_:1})]),_:1})):O("",!0)]),_:1}),l.password?(V(),J(at,{key:0,password:l.password,"show-requirements":!1,"show-feedback":!0,class:"mb-3"},null,8,["password"])):O("",!0),t(F,{modelValue:l.totp,"onUpdate:modelValue":x[12]||(x[12]=u=>l.totp=u),label:"TOTP Secret (optional)",placeholder:"Base32 secret (e.g., JBSWY3DPEHPK3PXP)","error-messages":k.value,hint:E.value,"persistent-hint":"",class:"mb-2"},null,8,["modelValue","error-messages","hint"]),t(ae,null,{default:a(()=>[l.totp&&L.value?(V(),Z("div",na,[oa,t(lt,{secret:l.totp},null,8,["secret"])])):O("",!0)]),_:1}),t(T,{modelValue:l.note,"onUpdate:modelValue":x[13]||(x[13]=u=>l.note=u),label:"Notes (optional)",placeholder:"Additional information...",rows:"3","auto-grow":""},null,8,["modelValue"])]),_:1},512)]),_:1}),t(c,{class:"pa-4 pt-0"},{default:a(()=>[t(ce),t(te,{variant:"text",onClick:P,disabled:e.isLoading},{default:a(()=>[g(" Cancel ")]),_:1},8,["disabled"]),t(te,{color:"primary",loading:e.isLoading,disabled:!D.value,onClick:A},{default:a(()=>[g(I($.value?"Save Changes":"Add Entry"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}},sa=Ce(la,[["__scopeId","data-v-a109ad8c"]]),ra=h("span",{class:"text-caption text-medium-emphasis px-2"},"or enter password",-1),ia={__name:"VaultUnlockDialog",props:{modelValue:{type:Boolean,default:!1},isNewVault:{type:Boolean,default:!1},hasWebAuthn:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["update:modelValue","submit","webauthn","cancel"],setup(e,{emit:s}){const n=e,o=s,i=b(""),p=b(""),r=b(!1),v=b(!1),l=b(""),w=K(()=>typeof window<"u"&&window.PublicKeyCredential!==void 0),f=K(()=>n.isNewVault&&p.value&&i.value!==p.value),q=K(()=>i.value?_t(i.value).score<2:!1),$=K(()=>!(!i.value||n.isNewVault&&(!p.value||f.value)));_e(()=>n.modelValue,L=>{L&&(i.value="",p.value="",r.value=!1,l.value="")}),_e(()=>n.error,L=>{l.value=L});function D(){$.value&&(l.value="",o("submit",i.value))}async function Y(){v.value=!0;try{o("webauthn")}finally{v.value=!1}}function C(){o("cancel"),o("update:modelValue",!1)}return(L,k)=>{const E=d("v-icon"),H=d("v-card-title"),G=d("v-alert"),A=d("v-text-field"),P=d("v-btn"),z=d("v-divider"),x=d("v-card-text"),Q=d("v-spacer"),B=d("v-card-actions"),F=d("v-card"),te=d("v-dialog");return V(),J(te,{"model-value":e.modelValue,"onUpdate:modelValue":k[6]||(k[6]=y=>L.$emit("update:modelValue",y)),"max-width":"450",persistent:"",scrim:!0},{default:a(()=>[t(F,null,{default:a(()=>[t(H,{class:"bg-surface-variant d-flex align-center"},{default:a(()=>[t(E,{icon:e.isNewVault?"mdi-shield-key":"mdi-lock",class:"mr-2"},null,8,["icon"]),g(" "+I(e.isNewVault?"Create Password Vault":"Unlock Vault"),1)]),_:1}),t(x,{class:"pa-4"},{default:a(()=>[e.isNewVault?(V(),Z(we,{key:0},[t(G,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:a(()=>[g(" Create a master password to protect your vault. This password will encrypt all your stored passwords. ")]),_:1}),t(A,{modelValue:i.value,"onUpdate:modelValue":k[0]||(k[0]=y=>i.value=y),type:r.value?"text":"password",label:"Master Password","append-inner-icon":r.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":k[1]||(k[1]=y=>r.value=!r.value),onKeyup:k[2]||(k[2]=Ve(y=>p.value&&D(),["enter"])),autocomplete:"new-password",autofocus:"",class:"mb-2"},null,8,["modelValue","type","append-inner-icon"]),t(A,{modelValue:p.value,"onUpdate:modelValue":k[3]||(k[3]=y=>p.value=y),type:r.value?"text":"password",label:"Confirm Password","error-messages":f.value?"Passwords do not match":"",onKeyup:Ve(D,["enter"]),autocomplete:"new-password",class:"mb-2"},null,8,["modelValue","type","error-messages"]),i.value?(V(),J(at,{key:0,password:i.value,"show-requirements":!0,"show-feedback":!0,class:"mb-3"},null,8,["password"])):O("",!0),q.value&&i.value?(V(),J(G,{key:1,type:"warning",variant:"tonal",density:"compact",class:"mb-3"},{default:a(()=>[g(" This password is weak. A strong master password is recommended to protect your vault. ")]),_:1})):O("",!0)],64)):(V(),Z(we,{key:1},[e.hasWebAuthn&&w.value?(V(),J(P,{key:0,block:"",color:"primary",size:"large",loading:v.value,onClick:Y,class:"mb-4"},{default:a(()=>[t(E,{icon:"mdi-fingerprint",class:"mr-2"}),g(" Unlock with Biometrics ")]),_:1},8,["loading"])):O("",!0),e.hasWebAuthn&&w.value?(V(),J(z,{key:1,class:"mb-4"},{default:a(()=>[ra]),_:1})):O("",!0),t(A,{modelValue:i.value,"onUpdate:modelValue":k[4]||(k[4]=y=>i.value=y),type:r.value?"text":"password",label:"Master Password","append-inner-icon":r.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":k[5]||(k[5]=y=>r.value=!r.value),onKeyup:Ve(D,["enter"]),"error-messages":l.value,autocomplete:"current-password",autofocus:""},null,8,["modelValue","type","append-inner-icon","error-messages"])],64)),e.error&&!e.isNewVault?(V(),J(G,{key:2,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:a(()=>[g(I(e.error),1)]),_:1})):O("",!0)]),_:1}),t(B,{class:"pa-4 pt-0"},{default:a(()=>[t(Q),e.isNewVault?O("",!0):(V(),J(P,{key:0,variant:"text",onClick:C,disabled:e.isLoading},{default:a(()=>[g(" Cancel ")]),_:1},8,["disabled"])),t(P,{color:"primary",loading:e.isLoading,disabled:!$.value,onClick:D},{default:a(()=>[g(I(e.isNewVault?"Create Vault":"Unlock"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}};function ua(e){if(!e||typeof e!="string")return[];const s=[];let n="",o=!1;for(let r=0;r<e.length;r++){const v=e[r],l=e[r+1];v==='"'?o&&l==='"'?(n+='""',r++):(o=!o,n+=v):(v===`
`||v==="\r"&&l===`
`)&&!o?(n.trim()&&s.push(n),n="",v==="\r"&&r++):v==="\r"&&!o?(n.trim()&&s.push(n),n=""):n+=v}if(n.trim()&&s.push(n),s.length===0)return[];const i=Ze(s[0]),p=[];for(let r=1;r<s.length;r++){const v=Ze(s[r]),l={};i.forEach((w,f)=>{l[w.toLowerCase().trim()]=v[f]||""}),p.push(Le(l))}return p}function Ze(e){const s=[];let n="",o=!1;for(let i=0;i<e.length;i++){const p=e[i],r=e[i+1];p==='"'?o?r==='"'?(n+='"',i++):o=!1:o=!0:p===","&&!o?(s.push(n),n=""):n+=p}return s.push(n),s}function ca(e){if(!e||typeof e!="string")return[];try{const s=JSON.parse(e);return Array.isArray(s)?s.map(n=>Le(n)):s.entries&&Array.isArray(s.entries)?s.entries.map(n=>Le(n)):s.items&&Array.isArray(s.items)?s.items.map(n=>Le(n)):[]}catch(s){return console.error("Failed to parse JSON:",s),[]}}function Le(e){const s={name:["name","title","site","service","label","website"],username:["username","user","login","account","user_name","loginname"],email:["email","mail","e-mail","email_address"],url:["url","uri","website","site_url","login_url","link"],password:["password","pass","pwd","secret"],totp:["totp","otp","totp_secret","2fa","mfa","authenticator"],note:["note","notes","comment","comments","memo","description"],createdAt:["created_at","createdat","created","date_created","creation_date"],updatedAt:["updated_at","updatedat","updated","modified","date_modified","modification_date"]},n={name:"",username:"",email:"",url:"",password:"",totp:"",note:"",createdAt:"",updatedAt:""},o={};return Object.keys(e).forEach(i=>{o[i.toLowerCase().replace(/[_-]/g,"")]=e[i]}),Object.keys(s).forEach(i=>{const p=s[i];for(const r of p){const v=r.toLowerCase().replace(/[_-]/g,"");if(o[v]!==void 0){n[i]=String(o[v]||"");break}}}),Object.keys(e).forEach(i=>{const p=i.toLowerCase();Object.keys(s).forEach(r=>{s[r].includes(p)&&!n[r]&&(n[r]=String(e[i]||""))})}),n}function da(e,s){const n=e.toLowerCase();if(n.endsWith(".aes"))return{format:"unknown",isEncrypted:!0,algorithm:"jsAesCrypt"};if(n.endsWith(".enc"))return{format:"unknown",isEncrypted:!0,algorithm:"webCrypto"};if(n.endsWith(".age"))return{format:"unknown",isEncrypted:!0,algorithm:"age"};let o=s;s instanceof Uint8Array&&(o=new TextDecoder().decode(s));const i=o.trim();if(i.startsWith("{")||i.startsWith("["))try{return JSON.parse(i),{format:"json",isEncrypted:!1,algorithm:null}}catch{}return{format:"csv",isEncrypted:!1,algorithm:null}}function ma(e,s){const n=new Map;e.forEach(i=>{const p=`${i.name.toLowerCase()}|${i.username.toLowerCase()}`;n.set(p,i)});const o=[];return s.forEach(i=>{const p=`${i.name.toLowerCase()}|${i.username.toLowerCase()}`,r=n.get(p);r&&o.push({existing:r,new:i,key:p})}),o}const st=e=>(Ue("data-v-b883892c"),e=e(),Te(),e),pa=st(()=>h("div",{class:"text-caption text-medium-emphasis mt-2"}," Supported formats: CSV, JSON, or encrypted versions (.aes, .enc, .age) ",-1)),va={class:"d-flex align-center justify-space-between mb-3"},fa={class:"text-subtitle-1"},ya=st(()=>h("thead",null,[h("tr",null,[h("th",null,"Name"),h("th",null,"Username"),h("th",null,"URL"),h("th",null,"Status")])],-1)),wa={class:"text-truncate",style:{"max-width":"150px"}},_a={class:"text-truncate",style:{"max-width":"120px"}},ga={class:"text-truncate",style:{"max-width":"150px"}},ha={key:3,class:"text-center pa-4"},ka={class:"mt-2 text-body-2"},ba={__name:"VaultImportDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","import"],setup(e,{emit:s}){const n=e,o=s,{getEntries:i,importEntries:p}=nt(),r=b("select"),v=b(null),l=b(null),w=b(null),f=b([]),q=b("skip"),$=b(""),D=b(!1),Y=b(""),C=b(!1),L=b(""),k=b(""),E=K(()=>{const y=i();return ma(y,f.value)}),H=K(()=>E.value.length);_e(()=>n.modelValue,y=>{y&&G()});function G(){r.value="select",v.value=null,l.value=null,w.value=null,f.value=[],q.value="skip",$.value="",Y.value="",k.value=""}function A(){var y;r.value==="preview"?(y=w.value)!=null&&y.isEncrypted?r.value="decrypt":r.value="select":r.value==="decrypt"&&(r.value="select")}async function P(y){if(y){C.value=!0,L.value="Reading file...",k.value="";try{const U=await y.arrayBuffer(),R=new Uint8Array(U);if(w.value=da(y.name,R),w.value.isEncrypted)l.value=R,r.value="decrypt";else{const le=new TextDecoder().decode(R);await x(le,w.value.format)}}catch(U){console.error("File read error:",U),k.value="Failed to read file"}finally{C.value=!1}}}async function z(){if(!(!$.value||!l.value)){C.value=!0,L.value="Decrypting file...",Y.value="",k.value="";try{const y=new Worker(new URL("/assets/cryptoWorker-DRYHjFPq.js",import.meta.url),{type:"module"}),U=await new Promise((ae,T)=>{y.onmessage=ce=>{const[c,m]=ce.data;c==="ERROR"?T(new Error(m)):ae(m),y.terminate()},y.onerror=ce=>{T(ce),y.terminate()};const se=new Blob([l.value]);y.postMessage(["DECRYPT",se,$.value,"import",w.value.algorithm])}),R=new TextDecoder().decode(U),le=R.trim(),ee=le.startsWith("{")||le.startsWith("[")?"json":"csv";await x(R,ee)}catch(y){console.error("Decryption error:",y);const U=typeof y=="string"?y:y.message||"Decryption failed";U.toLowerCase().includes("password")||U.toLowerCase().includes("decrypt")?Y.value="Incorrect password":Y.value=U}finally{C.value=!1}}}async function x(y,U){C.value=!0,L.value="Parsing entries...",k.value="";try{let R;if(U==="json"?R=ca(y):R=ua(y),R.length===0){k.value="No entries found in file",r.value="select";return}f.value=R,r.value="preview"}catch(R){console.error("Parse error:",R),k.value="Failed to parse file contents",r.value="select"}finally{C.value=!1}}async function Q(){if(f.value.length!==0){C.value=!0,L.value="Importing entries...",k.value="";try{const y=await p(f.value,q.value);o("import",y),o("update:modelValue",!1)}catch(y){console.error("Import error:",y),k.value="Failed to import entries"}finally{C.value=!1}}}function B(){o("update:modelValue",!1)}function F(y){const U=`${y.name.toLowerCase()}|${y.username.toLowerCase()}`;return E.value.some(R=>R.key===U)}function te(y){if(!y)return"-";try{return new URL(y.startsWith("http")?y:`https://${y}`).hostname}catch{return y.substring(0,30)}}return(y,U)=>{const R=d("v-icon"),le=d("v-card-title"),ee=d("v-alert"),ae=d("v-file-input"),T=d("v-text-field"),se=d("v-chip"),ce=d("v-select"),c=d("v-table"),m=d("v-card"),u=d("v-progress-circular"),S=d("v-card-text"),N=d("v-btn"),re=d("v-spacer"),ie=d("v-card-actions"),ve=d("v-dialog");return V(),J(ve,{"model-value":e.modelValue,"onUpdate:modelValue":U[4]||(U[4]=ne=>y.$emit("update:modelValue",ne)),"max-width":"600",persistent:""},{default:a(()=>[t(m,null,{default:a(()=>[t(le,{class:"bg-surface-variant d-flex align-center"},{default:a(()=>[t(R,{icon:"mdi-upload",class:"mr-2"}),g(" Import Passwords ")]),_:1}),t(S,{class:"pa-4"},{default:a(()=>[r.value==="select"?(V(),Z(we,{key:0},[t(ee,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:a(()=>[g(" Import passwords from CSV or JSON files. Supports encrypted files (.aes, .enc, .age). ")]),_:1}),t(ae,{modelValue:v.value,"onUpdate:modelValue":[U[0]||(U[0]=ne=>v.value=ne),P],label:"Select file to import",accept:".csv,.json,.aes,.enc,.age","prepend-icon":"mdi-file","show-size":""},null,8,["modelValue"]),pa],64)):O("",!0),r.value==="decrypt"?(V(),Z(we,{key:1},[t(ee,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:a(()=>[g(" This file is encrypted. Enter the password to decrypt it. ")]),_:1}),t(T,{modelValue:$.value,"onUpdate:modelValue":U[1]||(U[1]=ne=>$.value=ne),type:D.value?"text":"password",label:"Decryption Password","append-inner-icon":D.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":U[2]||(U[2]=ne=>D.value=!D.value),onKeyup:Ve(z,["enter"]),"error-messages":Y.value,autofocus:""},null,8,["modelValue","type","append-inner-icon","error-messages"])],64)):O("",!0),r.value==="preview"?(V(),Z(we,{key:2},[h("div",va,[h("span",fa," Found "+I(f.value.length)+" entries ",1),H.value>0?(V(),J(se,{key:0,color:"warning",size:"small"},{default:a(()=>[g(I(H.value)+" duplicates ",1)]),_:1})):O("",!0)]),H.value>0?(V(),J(ce,{key:0,modelValue:q.value,"onUpdate:modelValue":U[3]||(U[3]=ne=>q.value=ne),label:"Handle duplicates",items:[{title:"Skip duplicates",value:"skip"},{title:"Overwrite existing",value:"overwrite"},{title:"Keep both",value:"keepBoth"}],"item-title":"title","item-value":"value",density:"compact",class:"mb-3"},null,8,["modelValue"])):O("",!0),t(m,{variant:"outlined",class:"preview-container"},{default:a(()=>[t(c,{density:"compact","fixed-header":"",height:"300"},{default:a(()=>[ya,h("tbody",null,[(V(!0),Z(we,null,et(f.value,(ne,De)=>(V(),Z("tr",{key:De},[h("td",wa,I(ne.name||"-"),1),h("td",_a,I(ne.username||ne.email||"-"),1),h("td",ga,I(te(ne.url)),1),h("td",null,[t(se,{color:F(ne)?"warning":"success",size:"x-small"},{default:a(()=>[g(I(F(ne)?"Duplicate":"New"),1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})],64)):O("",!0),C.value?(V(),Z("div",ha,[t(u,{indeterminate:"",color:"primary"}),h("div",ka,I(L.value),1)])):O("",!0),k.value&&r.value!=="decrypt"?(V(),J(ee,{key:4,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:a(()=>[g(I(k.value),1)]),_:1})):O("",!0)]),_:1}),t(ie,{class:"pa-4 pt-0"},{default:a(()=>[r.value!=="select"?(V(),J(N,{key:0,variant:"text",onClick:A,disabled:C.value},{default:a(()=>[g(" Back ")]),_:1},8,["disabled"])):O("",!0),t(re),t(N,{variant:"text",onClick:B,disabled:C.value},{default:a(()=>[g(" Cancel ")]),_:1},8,["disabled"]),r.value==="decrypt"?(V(),J(N,{key:1,color:"primary",loading:C.value,disabled:!$.value,onClick:z},{default:a(()=>[g(" Decrypt ")]),_:1},8,["loading","disabled"])):O("",!0),r.value==="preview"?(V(),J(N,{key:2,color:"primary",loading:C.value,disabled:f.value.length===0,onClick:Q},{default:a(()=>[g(" Import "+I(f.value.length)+" Entries ",1)]),_:1},8,["loading","disabled"])):O("",!0)]),_:1})]),_:1})]),_:1},8,["model-value"])}}},xa=Ce(ba,[["__scopeId","data-v-b883892c"]]),he=e=>(Ue("data-v-dadde15c"),e=e(),Te(),e),Va=he(()=>h("p",{class:"mb-2"},[g(" Your password vault is encrypted with "),h("strong",null,"Age encryption"),g(", a modern and secure encryption format. All data is stored locally in your browser and never leaves your device. ")],-1)),Ca={class:"ml-4 mb-2"},Ea=he(()=>h("li",null,[h("strong",null,"Master password"),g(" - Choose a strong, unique password you'll remember")],-1)),Sa=he(()=>h("strong",null,"Auto-lock",-1)),Aa=he(()=>h("li",null,[h("strong",null,"Local storage"),g(" - Data stays on your device, works offline")],-1)),$a=he(()=>h("li",null,[h("strong",null,"Import/Export"),g(" - Migrate from other password managers via CSV/JSON")],-1)),La={class:"text-h5 mb-2"},Ia={class:"text-body-1 text-medium-emphasis mb-4"},Ua={key:0,class:"mt-4"},Ta={class:"d-flex flex-wrap align-center gap-2"},Da={class:"d-flex align-center justify-space-between mb-3"},Pa={class:"text-body-2 text-medium-emphasis"},Ma={key:0},Na={class:"text-h6 mb-2"},Oa={class:"text-body-2 text-medium-emphasis mb-4"},za={key:0,class:"d-flex justify-center gap-2"},Ba={key:1,class:"entry-grid"},Fa=he(()=>h("p",null,"Are you sure you want to delete your vault?",-1)),Ra=he(()=>h("p",{class:"mb-3"},"Enter a password to encrypt the exported file.",-1)),ja={__name:"PasswordManager",setup(e){const{isLocked:s,isLoading:n,error:o,hasVault:i,createVault:p,unlockVault:r,lockVault:v,addEntry:l,updateEntry:w,deleteEntry:f,searchEntries:q,getEntries:$,getAutoLockMinutes:D,deleteVault:Y}=nt(),{snackbar:C,snackbarText:L,snackbarColor:k,showSnackbar:E}=pt(),H=bt({onLock:()=>{v(),E("Vault auto-locked due to inactivity","info")},getTimeout:()=>D(),isLocked:()=>s.value}),G=b(""),A=b(!1),P=b(!1),z=b(!1),x=b(!1),Q=b(!1),B=b(null),F=b(""),te=b(!1),y=b(null),U=b(!1),R=K(()=>H.isActive.value),le=K(()=>D()),ee=b(null);let ae=null;function T(j){if(j===null||j<=0)return"0s";const _=Math.floor(j/60),W=j%60;return _>0?W>0?`${_}m ${W}s`:`${_}m`:`${W}s`}function se(){if(!H.isActive.value||s.value){ee.value=null;return}ee.value=H.getTimeRemaining()}function ce(){se(),ae&&clearInterval(ae),ae=setInterval(se,1e3)}function c(){ae&&(clearInterval(ae),ae=null),ee.value=null}const m=K(()=>G.value?q(G.value):$());_e(s,j=>{j?(H.stop(),c()):(H.start(),ce())}),Ie(()=>{i.value&&(A.value=!0)}),ge(()=>{c()});async function u(j){const _=!i.value;let W;_?(W=await p(j),W&&E("Vault created successfully","success")):(W=await r(j),W&&E("Vault unlocked","success")),W&&(A.value=!1)}function S(){E("Biometric unlock not yet configured","info")}function N(){H.clear(),v(),E("Vault locked","info")}function re(){B.value=null,P.value=!0}function ie(j){B.value=j,P.value=!0}async function ve(j){let _;B.value?(_=await w(B.value.id,j),_&&E("Entry updated","success")):(_=await l(j),_&&E("Entry added","success")),_?(P.value=!1,B.value=null):E(o.value||"Failed to save entry","error")}async function ne(j){await f(j.id)?E("Entry deleted","success"):E(o.value||"Failed to delete entry","error")}async function De(j){E(`Import complete: ${j.added} added, ${j.updated} updated, ${j.skipped} skipped`,"success"),z.value=!1}function Ee(j){if(j.includes("encrypted")){y.value=j,F.value="",Q.value=!0;return}Ke(j)}async function We(){!F.value||!y.value||(Q.value=!1,await Ke(y.value,F.value),F.value="",y.value=null)}async function Ke(j,_=null){const W=$();let oe,ue,me;if(j.replace("-encrypted","")==="csv"?(oe=xt(W),ue=Xe("csv"),me="text/csv"):(oe=Ct(W),ue=Xe("json"),me="application/json"),_)try{const ye=new TextEncoder().encode(oe),de=new Worker(new URL("/assets/cryptoWorker-DRYHjFPq.js",import.meta.url),{type:"module"}),Me=await new Promise((Ne,Se)=>{de.onmessage=ke=>{const[ze,be]=ke.data;ze==="ERROR"?Se(new Error(be)):Ne(be),de.terminate()},de.onerror=ke=>{Se(ke),de.terminate()};const Oe=new Blob([ye]);de.postMessage(["ENCRYPT",Oe,_,ue,"age"])});ue+=".age",qe(Me,ue),E(`Exported ${W.length} entries (encrypted)`,"success")}catch(fe){console.error("Export encryption failed:",fe),E("Failed to encrypt export","error")}else{const fe=new Blob([oe],{type:me}),ye=new Uint8Array(await fe.arrayBuffer());qe(ye,ue),E(`Exported ${W.length} entries`,"success")}}function rt(){Y(),x.value=!1,E("Vault deleted","success")}return(j,_)=>{const W=d("v-icon"),oe=d("v-btn"),ue=d("v-card-text"),me=d("v-card"),Pe=d("v-text-field"),fe=d("v-spacer"),ye=d("v-list-item-title"),de=d("v-list-item"),Me=d("v-divider"),Ne=d("v-list"),Se=d("v-menu"),Oe=d("v-chip"),ke=d("v-card-title"),ze=d("v-alert"),be=d("v-card-actions"),Ye=d("v-dialog");return V(),Z("div",null,[t(ft,{title:"Password Manager",description:"Securely store and manage passwords with Age encryption",icon:"mdi-key","avatar-color":"primary"}),t(dt,{title:"Password Security Best Practices","storage-key":"slurm-help-password-manager"},{default:a(()=>[Va,h("ul",Ca,[Ea,h("li",null,[Sa,g(" - Vault automatically locks after "+I(le.value)+" minutes of inactivity",1)]),Aa,$a]),t(yt,{title:"Backup Reminder",type:"warning",spacing:"mt-3"},{default:a(()=>[g(" Export your vault regularly to a secure location. If you clear browser data, your vault will be lost. ")]),_:1})]),_:1}),X(s)?(V(),J(me,{key:0,class:"mb-4"},{default:a(()=>[t(ue,{class:"pa-6 text-center"},{default:a(()=>[t(W,{icon:X(i)?"mdi-lock":"mdi-shield-key",size:"64",color:"primary",class:"mb-4"},null,8,["icon"]),h("h2",La,I(X(i)?"Vault Locked":"Create Your Vault"),1),h("p",Ia,I(X(i)?"Enter your master password to unlock your password vault.":"Set up a secure vault to store your passwords. All data is encrypted and stored locally."),1),t(oe,{color:"primary",size:"large",onClick:_[0]||(_[0]=M=>A.value=!0)},{default:a(()=>[t(W,{icon:X(i)?"mdi-lock-open":"mdi-plus",class:"mr-2"},null,8,["icon"]),g(" "+I(X(i)?"Unlock Vault":"Create Vault"),1)]),_:1}),X(i)?(V(),Z("div",Ua,[t(oe,{variant:"text",color:"error",size:"small",onClick:_[1]||(_[1]=M=>x.value=!0)},{default:a(()=>[g(" Delete Vault ")]),_:1})])):O("",!0)]),_:1})]),_:1})):(V(),Z(we,{key:1},[t(me,{class:"mb-4"},{default:a(()=>[t(ue,{class:"pa-3"},{default:a(()=>[h("div",Ta,[t(Pe,{modelValue:G.value,"onUpdate:modelValue":_[2]||(_[2]=M=>G.value=M),"prepend-inner-icon":"mdi-magnify",placeholder:"Search passwords...","hide-details":"",density:"compact",clearable:"",style:{"max-width":"300px","min-width":"200px"},class:"flex-grow-1"},null,8,["modelValue"]),t(fe,{class:"d-none d-sm-flex"}),t(oe,{color:"primary",onClick:re},{default:a(()=>[t(W,{icon:"mdi-plus",class:"mr-1"}),g(" Add ")]),_:1}),t(oe,{variant:"tonal",onClick:_[3]||(_[3]=M=>z.value=!0)},{default:a(()=>[t(W,{icon:"mdi-upload",class:"mr-1"}),g(" Import ")]),_:1}),t(Se,null,{activator:a(({props:M})=>[t(oe,pe({variant:"tonal"},M),{default:a(()=>[t(W,{icon:"mdi-download",class:"mr-1"}),g(" Export ")]),_:2},1040)]),default:a(()=>[t(Ne,{density:"compact"},{default:a(()=>[t(de,{onClick:_[4]||(_[4]=M=>Ee("csv"))},{default:a(()=>[t(ye,null,{default:a(()=>[g("Export as CSV")]),_:1})]),_:1}),t(de,{onClick:_[5]||(_[5]=M=>Ee("json"))},{default:a(()=>[t(ye,null,{default:a(()=>[g("Export as JSON")]),_:1})]),_:1}),t(Me),t(de,{onClick:_[6]||(_[6]=M=>Ee("csv-encrypted"))},{default:a(()=>[t(ye,null,{default:a(()=>[g("Export as Encrypted CSV")]),_:1})]),_:1}),t(de,{onClick:_[7]||(_[7]=M=>Ee("json-encrypted"))},{default:a(()=>[t(ye,null,{default:a(()=>[g("Export as Encrypted JSON")]),_:1})]),_:1})]),_:1})]),_:1}),t(oe,{variant:"tonal",color:"warning",onClick:N},{default:a(()=>[t(W,{icon:"mdi-lock",class:"mr-1"}),g(" Lock ")]),_:1})])]),_:1})]),_:1}),h("div",Da,[h("span",Pa,[g(I(m.value.length)+" "+I(m.value.length===1?"entry":"entries")+" ",1),G.value?(V(),Z("span",Ma,"(filtered)")):O("",!0)]),R.value&&ee.value!==null?(V(),J(Oe,{key:0,size:"small",color:"info",variant:"tonal"},{default:a(()=>[t(W,{icon:"mdi-clock",size:"14",class:"mr-1"}),g(" Auto-lock in "+I(T(ee.value)),1)]),_:1})):O("",!0)]),m.value.length===0?(V(),J(me,{key:0,class:"mb-4"},{default:a(()=>[t(ue,{class:"pa-6 text-center"},{default:a(()=>[t(W,{icon:G.value?"mdi-magnify":"mdi-key",size:"48",color:"grey",class:"mb-3"},null,8,["icon"]),h("h3",Na,I(G.value?"No matches found":"No passwords yet"),1),h("p",Oa,I(G.value?"Try a different search term":"Add your first password entry or import from a file"),1),G.value?O("",!0):(V(),Z("div",za,[t(oe,{color:"primary",onClick:re},{default:a(()=>[t(W,{icon:"mdi-plus",class:"mr-1"}),g(" Add Entry ")]),_:1}),t(oe,{variant:"tonal",onClick:_[8]||(_[8]=M=>z.value=!0)},{default:a(()=>[t(W,{icon:"mdi-upload",class:"mr-1"}),g(" Import ")]),_:1})]))]),_:1})]),_:1})):(V(),Z("div",Ba,[(V(!0),Z(we,null,et(m.value,M=>(V(),J(Qt,{key:M.id,entry:M,onEdit:ie,onDelete:ne,onCopySuccess:_[9]||(_[9]=Be=>X(E)(Be,"success")),onCopyError:_[10]||(_[10]=Be=>X(E)(Be,"error"))},null,8,["entry"]))),128))]))],64)),t(ia,{modelValue:A.value,"onUpdate:modelValue":_[11]||(_[11]=M=>A.value=M),"is-new-vault":!X(i),"is-loading":X(n),error:X(o),"has-web-authn":U.value,onSubmit:u,onWebauthn:S},null,8,["modelValue","is-new-vault","is-loading","error","has-web-authn"]),t(sa,{modelValue:P.value,"onUpdate:modelValue":_[12]||(_[12]=M=>P.value=M),entry:B.value,"is-loading":X(n),onSubmit:ve},null,8,["modelValue","entry","is-loading"]),t(xa,{modelValue:z.value,"onUpdate:modelValue":_[13]||(_[13]=M=>z.value=M),onImport:De},null,8,["modelValue"]),t(Ye,{modelValue:x.value,"onUpdate:modelValue":_[15]||(_[15]=M=>x.value=M),"max-width":"400"},{default:a(()=>[t(me,null,{default:a(()=>[t(ke,{class:"bg-surface-variant"},{default:a(()=>[t(W,{icon:"mdi-alert",color:"error",class:"mr-2"}),g(" Delete Vault ")]),_:1}),t(ue,{class:"pa-4"},{default:a(()=>[t(ze,{type:"error",variant:"tonal",class:"mb-3"},{default:a(()=>[g(" This will permanently delete your password vault and all stored passwords. This action cannot be undone. ")]),_:1}),Fa]),_:1}),t(be,{class:"pa-4 pt-0"},{default:a(()=>[t(fe),t(oe,{variant:"text",onClick:_[14]||(_[14]=M=>x.value=!1)},{default:a(()=>[g("Cancel")]),_:1}),t(oe,{color:"error",onClick:rt},{default:a(()=>[g("Delete Forever")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ye,{modelValue:Q.value,"onUpdate:modelValue":_[19]||(_[19]=M=>Q.value=M),"max-width":"400"},{default:a(()=>[t(me,null,{default:a(()=>[t(ke,{class:"bg-surface-variant"},{default:a(()=>[t(W,{icon:"mdi-lock",class:"mr-2"}),g(" Export Password ")]),_:1}),t(ue,{class:"pa-4"},{default:a(()=>[Ra,t(Pe,{modelValue:F.value,"onUpdate:modelValue":_[16]||(_[16]=M=>F.value=M),type:te.value?"text":"password",label:"Export Password","append-inner-icon":te.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":_[17]||(_[17]=M=>te.value=!te.value),onKeyup:Ve(We,["enter"]),autofocus:""},null,8,["modelValue","type","append-inner-icon"])]),_:1}),t(be,{class:"pa-4 pt-0"},{default:a(()=>[t(fe),t(oe,{variant:"text",onClick:_[18]||(_[18]=M=>Q.value=!1)},{default:a(()=>[g("Cancel")]),_:1}),t(oe,{color:"primary",onClick:We,disabled:!F.value},{default:a(()=>[g(" Export ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(vt,{modelValue:X(C),"onUpdate:modelValue":_[20]||(_[20]=M=>mt(C)?C.value=M:null),text:X(L),color:X(k)},null,8,["modelValue","text","color"])])}}},Qa=Ce(ja,[["__scopeId","data-v-dadde15c"]]);export{Qa as default};
