import{r as b,d as Q,m as Ve,u as Fe,_ as $e,e as c,i as W,o as x,w as a,b as e,g,c as ae,t as I,j as B,q as ye,f as v,y as We,k as xe,l as ot,F as we,z as be,A as Qe,p as Xe,h as Ze,a as lt,B as oe,C as st}from"./index-_lZS3CbI.js";import{u as rt,S as it,T as ut}from"./ToolPageHeader-DeIUEXN-.js";import{d as Ke}from"./fileDownload-B1vhVzTR.js";import{_ as ct}from"./EducationalAlert-CxalLgoq.js";import{u as dt}from"./useClipboard-KqVwDR14.js";import{g as mt}from"./passwordGenerator-DrRtYIk4.js";import{P as et,c as pt}from"./PasswordStrengthIndicator-BEcgw2Zq.js";const ke="slurm-password-vault",Se="slurm-vault-last-activity",Ae="slurm-vault-unlock-attempts",vt=1,Ye=5,Je=6e4;function ft(){const t=new Date().toISOString();return{version:vt,entries:[],settings:{autoLockMinutes:5},metadata:{createdAt:t,lastModifiedAt:t}}}function Re(t){const r=new Date().toISOString();return{id:crypto.randomUUID(),name:t.name||"",username:t.username||"",email:t.email||"",url:t.url||"",password:t.password||"",totp:t.totp||"",note:t.note||"",createdAt:t.createdAt||r,updatedAt:t.updatedAt||r}}function tt(){const t=b(null),r=b(!0),o=b(!1),n=b(null),s=b(null),y=b(!1),i=b(0);let k=null,l=null,h=null;const f=b(!1);try{f.value=localStorage.getItem(ke)!==null}catch{f.value=!1}const Z=Q(()=>f.value),Y=Q(()=>{var u,d;return((d=(u=t.value)==null?void 0:u.entries)==null?void 0:d.length)||0});function J(){k||(k=new Worker(new URL("/assets/cryptoWorker-DRYHjFPq.js",import.meta.url),{type:"module"}),k.onmessage=H,k.onerror=u=>{console.error("Vault worker error:",u),o.value=!1,n.value="Encryption worker error",l!=null&&l.reject&&(l.reject(new Error("Worker error")),l=null)})}function H(u){const[d,w,V]=u.data;if(o.value=!1,d==="ERROR"){n.value=w,l!=null&&l.reject&&(l.reject(new Error(w)),l=null);return}l!=null&&l.resolve&&(l.resolve({action:d,data:w,extra:V}),l=null)}async function P(u,d){return J(),new Promise((w,V)=>{l={resolve:w,reject:V};const re=new TextEncoder().encode(u),ie=new Blob([re]);k.postMessage(["ENCRYPT",ie,d,"vault.json","age"])}).then(w=>{if(w.action==="ENCRYPT")return w.data;throw new Error("Unexpected response")})}async function U(u,d){return J(),new Promise((w,V)=>{l={resolve:w,reject:V};const D=new Blob([u]);k.postMessage(["DECRYPT",D,d,"vault.age","age"])}).then(w=>{if(w.action==="DECRYPT")return new TextDecoder().decode(w.data);throw new Error("Unexpected response")})}async function E(u){if(!u)return n.value="Password is required",!1;o.value=!0,n.value=null;try{const d=ft(),w=JSON.stringify(d),V=await P(w,u),D=qe(V);return localStorage.setItem(ke,D),t.value=d,s.value=u,r.value=!1,f.value=!0,N(),!0}catch(d){return console.error("Failed to create vault:",d),n.value=typeof d=="string"?d:d.message||"Failed to create vault",!1}finally{o.value=!1}}function S(){try{const u=sessionStorage.getItem(Ae);if(u)return JSON.parse(u)}catch{}return{attempts:0,lockoutUntil:null}}function T(){const u=S();u.attempts++,u.attempts>=Ye&&(u.lockoutUntil=Date.now()+Je,C(u.lockoutUntil));try{sessionStorage.setItem(Ae,JSON.stringify(u))}catch{}}function _(){try{sessionStorage.removeItem(Ae),y.value=!1,i.value=0,h&&(clearInterval(h),h=null)}catch{}}function C(u){y.value=!0;const d=()=>{const w=Math.max(0,Math.ceil((u-Date.now())/1e3));if(i.value=w,w<=0){y.value=!1,h&&(clearInterval(h),h=null);try{sessionStorage.removeItem(Ae)}catch{}}};d(),h&&clearInterval(h),h=setInterval(d,1e3)}function R(){const u=S();return u.lockoutUntil&&u.lockoutUntil>Date.now()?(C(u.lockoutUntil),!0):!1}function K(){const u=S();return Math.max(0,Ye-u.attempts)}async function q(u){if(!u)return n.value="Password is required",!1;if(R())return n.value=`Too many failed attempts. Try again in ${i.value} seconds.`,!1;o.value=!0,n.value=null;try{const d=localStorage.getItem(ke);if(!d)return n.value="No vault found",!1;const w=yt(d),V=await U(w,u),D=JSON.parse(V);return!D.version||!Array.isArray(D.entries)?(n.value="Invalid vault format",!1):(t.value=D,s.value=u,r.value=!1,N(),_(),!0)}catch(d){console.error("Failed to unlock vault:",d);const w=typeof d=="string"?d:d.message||"Failed to unlock vault";T();const V=K();return w.toLowerCase().includes("decrypt")||w.toLowerCase().includes("password")?V>0?n.value=`Incorrect password. ${V} attempt${V===1?"":"s"} remaining.`:n.value=`Incorrect password. Too many failed attempts. Try again in ${Math.ceil(Je/1e3)} seconds.`:n.value=w,!1}finally{o.value=!1}}function G(){t.value=null,s.value=null,r.value=!0,n.value=null;try{sessionStorage.removeItem(Se)}catch{}}async function M(){if(!t.value||!s.value)return n.value="Vault not unlocked",!1;o.value=!0,n.value=null;try{t.value.metadata.lastModifiedAt=new Date().toISOString();const u=JSON.stringify(t.value),d=await P(u,s.value),w=qe(d);try{localStorage.setItem(ke,w)}catch(V){if(V.name==="QuotaExceededError"||V.code===22||V.code===1014)return n.value="Storage quota exceeded. Please export your vault and clear browser data, or remove some entries.",!1;throw V}return N(),!0}catch(u){return console.error("Failed to save vault:",u),n.value=typeof u=="string"?u:u.message||"Failed to save vault",!1}finally{o.value=!1}}async function j(u){if(!t.value)return n.value="Vault not unlocked",null;const d=Re(u);return t.value.entries.push(d),await M()?d:(t.value.entries.pop(),null)}async function le(u,d){if(!t.value)return n.value="Vault not unlocked",null;const w=t.value.entries.findIndex(ie=>ie.id===u);if(w===-1)return n.value="Entry not found",null;const V={...t.value.entries[w]},D={...V,...d,id:V.id,createdAt:V.createdAt,updatedAt:new Date().toISOString()};return t.value.entries[w]=D,await M()?D:(t.value.entries[w]=V,null)}async function m(u){if(!t.value)return n.value="Vault not unlocked",!1;const d=t.value.entries.findIndex(D=>D.id===u);if(d===-1)return n.value="Entry not found",!1;const w=t.value.entries.splice(d,1)[0];return await M()?!0:(t.value.entries.splice(d,0,w),!1)}async function L(u,d="skip"){if(!t.value)return n.value="Vault not unlocked",{added:0,updated:0,skipped:0};const w={added:0,updated:0,skipped:0},V=new Map;t.value.entries.forEach(D=>{const re=`${D.name.toLowerCase()}|${D.username.toLowerCase()}`;V.set(re,D)});for(const D of u){const re=`${(D.name||"").toLowerCase()}|${(D.username||"").toLowerCase()}`,ie=V.get(re);if(ie){if(d==="skip")w.skipped++;else if(d==="overwrite")Object.assign(ie,{...D,id:ie.id,createdAt:ie.createdAt,updatedAt:new Date().toISOString()}),w.updated++;else if(d==="keepBoth"){const pe=Re(D);t.value.entries.push(pe),w.added++}}else{const pe=Re(D);t.value.entries.push(pe),V.set(re,pe),w.added++}}return(w.added>0||w.updated>0)&&await M(),w}function z(u){var w;if(!t.value||!u)return((w=t.value)==null?void 0:w.entries)||[];const d=u.toLowerCase();return t.value.entries.filter(V=>V.name.toLowerCase().includes(d)||V.username.toLowerCase().includes(d)||V.email.toLowerCase().includes(d)||V.url.toLowerCase().includes(d)||V.note.toLowerCase().includes(d))}function se(){return t.value?[...t.value.entries].sort((u,d)=>u.name.toLowerCase().localeCompare(d.name.toLowerCase())):[]}async function X(u,d){if(!t.value)return n.value="Vault not unlocked",!1;if(u!==s.value)return n.value="Current password is incorrect",!1;if(!d)return n.value="New password is required",!1;const w=s.value;return s.value=d,await M()?!0:(s.value=w,!1)}function ne(){try{return localStorage.removeItem(ke),sessionStorage.removeItem(Se),t.value=null,s.value=null,r.value=!0,f.value=!1,n.value=null,!0}catch(u){return console.error("Failed to delete vault:",u),n.value="Failed to delete vault",!1}}function N(){try{sessionStorage.setItem(Se,Date.now().toString())}catch{}}function A(){try{const u=sessionStorage.getItem(Se);return u?parseInt(u,10):null}catch{return null}}function ce(){var u,d;return((d=(u=t.value)==null?void 0:u.settings)==null?void 0:d.autoLockMinutes)||5}return Ve(()=>{k&&(k.terminate(),k=null),h&&(clearInterval(h),h=null)}),{vault:t,isLocked:r,isLoading:o,error:n,hasVault:Z,entryCount:Y,isLockedOut:y,lockoutRemainingSeconds:i,createVault:E,unlockVault:q,lockVault:G,saveVault:M,deleteVault:ne,changeMasterPassword:X,addEntry:j,updateEntry:le,deleteEntry:m,importEntries:L,searchEntries:z,getEntries:se,updateActivity:N,getLastActivity:A,getAutoLockMinutes:ce,getRemainingAttempts:K,checkLockoutState:R}}function qe(t){const r=t instanceof Uint8Array?t:new Uint8Array(t);let o="";for(let n=0;n<r.byteLength;n++)o+=String.fromCharCode(r[n]);return btoa(o)}function yt(t){const r=atob(t),o=new Uint8Array(r.length);for(let n=0;n<r.length;n++)o[n]=r.charCodeAt(n);return o}const Oe="slurm-vault-last-activity";function wt(t={}){const{onLock:r=()=>{},getTimeout:o=()=>5,isLocked:n=()=>!0}=t,s=b(!0);let y=null;function i(){if(!n())try{sessionStorage.setItem(Oe,Date.now().toString())}catch{}}function k(){try{const U=sessionStorage.getItem(Oe);return U?parseInt(U,10):null}catch{return null}}function l(){if(n()||!s.value)return!1;const U=k();if(!U)return!1;const E=Date.now(),S=o()*60*1e3;return E-U>S?(r(),!0):!1}function h(){i()}function f(){document.hidden||l()}function Z(){s.value=!0,i(),y&&clearInterval(y),y=setInterval(l,3e4),window.addEventListener("click",h),window.addEventListener("keydown",h),window.addEventListener("mousemove",h),window.addEventListener("scroll",h),document.addEventListener("visibilitychange",f)}function Y(){s.value=!1,y&&(clearInterval(y),y=null),window.removeEventListener("click",h),window.removeEventListener("keydown",h),window.removeEventListener("mousemove",h),window.removeEventListener("scroll",h),document.removeEventListener("visibilitychange",f)}function J(){i()}function H(){try{sessionStorage.removeItem(Oe)}catch{}}function P(){if(n())return null;const U=k();if(!U)return null;const E=Date.now(),T=o()*60*1e3-(E-U);return Math.max(0,Math.floor(T/1e3))}return Fe(()=>{}),Ve(()=>{Y()}),{isActive:s,start:Z,stop:Y,reset:J,clear:H,updateActivity:i,checkAutoLock:l,getTimeRemaining:P,getLastActivity:k}}function _t(t){if(!t||t.length===0)return`name,username,email,url,password,totp,note,created_at,updated_at
`;const r=["name","username","email","url","password","totp","note","created_at","updated_at"],o=[r.join(",")];return t.forEach(n=>{const s=r.map(y=>{const k=n[y==="created_at"?"createdAt":y==="updated_at"?"updatedAt":y]||"";return gt(k)});o.push(s.join(","))}),o.join(`
`)}function gt(t){if(t==null)return"";const r=String(t);return r.includes(",")||r.includes('"')||r.includes(`
`)||r.includes("\r")?`"${r.replace(/"/g,'""')}"`:r}function ht(t,r=!0){t||(t=[]);const o=t.map(n=>({name:n.name||"",username:n.username||"",email:n.email||"",url:n.url||"",password:n.password||"",totp:n.totp||"",note:n.note||"",created_at:n.createdAt||"",updated_at:n.updatedAt||""}));return r?JSON.stringify(o,null,2):JSON.stringify(o)}function Ge(t){return`slurm-passwords-${new Date().toISOString().split("T")[0]}.${t==="json"?"json":"csv"}`}const kt={class:"d-flex align-start"},bt={class:"text-h6 font-weight-bold text-white"},xt={key:1,class:"text-h6 font-weight-bold text-white"},Vt={class:"flex-grow-1 overflow-hidden"},Et={class:"d-flex align-center mb-1"},Ct={class:"text-subtitle-1 font-weight-medium text-truncate"},St={class:"text-body-2 text-medium-emphasis text-truncate mb-1"},At={class:"d-flex align-center"},Lt={class:"password-display text-body-2 font-weight-medium mr-2"},$t={key:0,class:"text-caption text-medium-emphasis text-truncate mt-1"},It={class:"d-flex justify-end mt-2 action-buttons"},Ut={__name:"PasswordEntryCard",props:{entry:{type:Object,required:!0}},emits:["edit","delete","copy-success","copy-error"],setup(t,{emit:r}){const o=t,n=r,{copyToClipboard:s}=dt(),y=b(!1),i=b(!1),k=b(!1),l=b(!1);let h=null;Ve(()=>{h&&(clearTimeout(h),h=null)});const f=Q(()=>(o.entry.name||"?").charAt(0).toUpperCase()),Z=Q(()=>{const C=["primary","secondary","success","info","warning"],R=o.entry.name.split("").reduce((K,q)=>K+q.charCodeAt(0),0);return C[R%C.length]}),Y=Q(()=>{var C;return"â€¢".repeat(Math.min(((C=o.entry.password)==null?void 0:C.length)||8,16))}),J=Q(()=>{if(!o.entry.url)return"";try{return new URL(H.value).hostname}catch{return o.entry.url}}),H=Q(()=>{if(!o.entry.url)return"";const C=o.entry.url.trim();return C.startsWith("http://")||C.startsWith("https://")?C:`https://${C}`}),P=Q(()=>{if(l.value||!o.entry.url)return null;try{return`https://icons.duckduckgo.com/ip3/${new URL(H.value).hostname}.ico`}catch{return null}});function U(){y.value=!y.value,h&&(clearTimeout(h),h=null),y.value&&(h=setTimeout(()=>{y.value=!1,h=null},1e4))}async function E(){await s(o.entry.password,()=>n("copy-success","Password copied"),C=>n("copy-error",C))}async function S(){await s(o.entry.username,()=>n("copy-success","Username copied"),C=>n("copy-error",C))}function T(){i.value=!0}function _(){i.value=!1,n("delete",o.entry)}return(C,R)=>{const K=c("v-img"),q=c("v-avatar"),G=c("v-icon"),M=c("v-btn"),j=c("v-tooltip"),le=c("v-divider"),m=c("v-card-text"),L=c("v-card-title"),z=c("v-spacer"),se=c("v-card-actions"),X=c("v-card"),ne=c("v-dialog");return x(),W(X,{class:"password-entry-card",elevation:k.value?4:2},{default:a(()=>[e(m,{class:"pa-3"},{default:a(()=>[g("div",kt,[e(q,{color:Z.value,size:"40",class:"mr-3 flex-shrink-0"},{default:a(()=>[P.value&&!l.value?(x(),W(K,{key:0,src:P.value,onError:R[0]||(R[0]=N=>l.value=!0)},{placeholder:a(()=>[g("span",bt,I(f.value),1)]),_:1},8,["src"])):(x(),ae("span",xt,I(f.value),1))]),_:1},8,["color"]),g("div",Vt,[g("div",Et,[g("span",Ct,I(t.entry.name),1)]),g("div",St,I(t.entry.username||t.entry.email||"No username"),1),g("div",At,[g("span",Lt,I(y.value?t.entry.password:Y.value),1)]),t.entry.url?(x(),ae("div",$t,I(J.value),1)):B("",!0)])]),g("div",It,[e(j,{text:"Show/hide password",location:"top"},{activator:a(({props:N})=>[e(M,ye(N,{icon:"",size:"small",variant:"text",onClick:U}),{default:a(()=>[e(G,{icon:y.value?"mdi-eye-off":"mdi-eye",size:"18"},null,8,["icon"])]),_:2},1040)]),_:1}),e(j,{text:"Copy password",location:"top"},{activator:a(({props:N})=>[e(M,ye(N,{icon:"",size:"small",variant:"text",onClick:E}),{default:a(()=>[e(G,{icon:"mdi-content-copy",size:"18"})]),_:2},1040)]),_:1}),t.entry.username?(x(),W(j,{key:0,text:"Copy username",location:"top"},{activator:a(({props:N})=>[e(M,ye(N,{icon:"",size:"small",variant:"text",onClick:S}),{default:a(()=>[e(G,{icon:"mdi-account",size:"18"})]),_:2},1040)]),_:1})):B("",!0),t.entry.url?(x(),W(j,{key:1,text:"Open URL",location:"top"},{activator:a(({props:N})=>[e(M,ye(N,{icon:"",size:"small",variant:"text",href:H.value,target:"_blank",rel:"noopener noreferrer"}),{default:a(()=>[e(G,{icon:"mdi-arrow-right-circle",size:"18"})]),_:2},1040,["href"])]),_:1})):B("",!0),e(le,{vertical:"",class:"mx-1"}),e(j,{text:"Edit entry",location:"top"},{activator:a(({props:N})=>[e(M,ye(N,{icon:"",size:"small",variant:"text",onClick:R[1]||(R[1]=A=>C.$emit("edit",t.entry))}),{default:a(()=>[e(G,{icon:"mdi-pencil",size:"18"})]),_:2},1040)]),_:1}),e(j,{text:"Delete entry",location:"top"},{activator:a(({props:N})=>[e(M,ye(N,{icon:"",size:"small",variant:"text",color:"error",onClick:T}),{default:a(()=>[e(G,{icon:"mdi-delete",size:"18"})]),_:2},1040)]),_:1})])]),_:1}),e(ne,{modelValue:i.value,"onUpdate:modelValue":R[3]||(R[3]=N=>i.value=N),"max-width":"400"},{default:a(()=>[e(X,null,{default:a(()=>[e(L,{class:"bg-surface-variant"},{default:a(()=>[e(G,{icon:"mdi-alert",color:"warning",class:"mr-2"}),v(" Delete Entry ")]),_:1}),e(m,{class:"pa-4"},{default:a(()=>[v(" Are you sure you want to delete "),g("strong",null,I(t.entry.name),1),v("? This action cannot be undone. ")]),_:1}),e(se,{class:"pa-4 pt-0"},{default:a(()=>[e(z),e(M,{variant:"text",onClick:R[2]||(R[2]=N=>i.value=!1)},{default:a(()=>[v("Cancel")]),_:1}),e(M,{color:"error",onClick:_},{default:a(()=>[v("Delete")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["elevation"])}}},Dt=$e(Ut,[["__scopeId","data-v-b6bdebed"]]),Pt={class:"d-flex align-start gap-2 mb-2"},Tt={class:"d-flex align-center justify-space-between mb-2"},Nt={class:"text-body-2"},Mt={class:"d-flex flex-wrap gap-2 mb-3"},Rt={__name:"PasswordEntryDialog",props:{modelValue:{type:Boolean,default:!1},entry:{type:Object,default:null},isLoading:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(t,{emit:r}){const o=t,n=r;function s(T){T.key==="Escape"&&o.modelValue&&!o.isLoading&&S()}Fe(()=>{document.addEventListener("keydown",s)}),Ve(()=>{document.removeEventListener("keydown",s)});const y=b(null),i=b(!1),k=b(!1),l=We({name:"",username:"",email:"",url:"",password:"",totp:"",note:""}),h=b(20),f=We({uppercase:!0,lowercase:!0,numbers:!0,special:!0}),Z={required:T=>!!T||"This field is required",email:T=>!T||/.+@.+\..+/.test(T)||"Invalid email format"},Y=Q(()=>!!o.entry),J=Q(()=>l.name.trim().length>0),H=Q(()=>f.uppercase||f.lowercase||f.numbers||f.special);xe(()=>o.modelValue,T=>{T&&(o.entry?(l.name=o.entry.name||"",l.username=o.entry.username||"",l.email=o.entry.email||"",l.url=o.entry.url||"",l.password=o.entry.password||"",l.totp=o.entry.totp||"",l.note=o.entry.note||""):(P(),U()),i.value=!1,k.value=!1)});function P(){l.name="",l.username="",l.email="",l.url="",l.password="",l.totp="",l.note=""}function U(){H.value&&(l.password=mt({length:h.value,includeUppercase:f.uppercase,includeLowercase:f.lowercase,includeNumbers:f.numbers,includeSpecial:f.special}),i.value=!0)}function E(){J.value&&n("submit",{name:l.name.trim(),username:l.username.trim(),email:l.email.trim(),url:l.url.trim(),password:l.password,totp:l.totp.trim(),note:l.note.trim()})}function S(){n("update:modelValue",!1)}return(T,_)=>{const C=c("v-icon"),R=c("v-card-title"),K=c("v-text-field"),q=c("v-btn"),G=c("v-tooltip"),M=c("v-slider"),j=c("v-chip"),le=c("v-card-text"),m=c("v-card"),L=c("v-expand-transition"),z=c("v-textarea"),se=c("v-form"),X=c("v-spacer"),ne=c("v-card-actions"),N=c("v-dialog");return x(),W(N,{"model-value":t.modelValue,"onUpdate:modelValue":_[14]||(_[14]=A=>T.$emit("update:modelValue",A)),"max-width":"550",persistent:""},{default:a(()=>[e(m,null,{default:a(()=>[e(R,{class:"bg-surface-variant d-flex align-center"},{default:a(()=>[e(C,{icon:Y.value?"mdi-pencil":"mdi-plus",class:"mr-2"},null,8,["icon"]),v(" "+I(Y.value?"Edit Entry":"Add New Entry"),1)]),_:1}),e(le,{class:"pa-4"},{default:a(()=>[e(se,{ref_key:"formRef",ref:y,onSubmit:ot(E,["prevent"])},{default:a(()=>[e(K,{modelValue:l.name,"onUpdate:modelValue":_[0]||(_[0]=A=>l.name=A),label:"Name",placeholder:"e.g., GitHub, Gmail, Netflix",rules:[Z.required],autofocus:"",class:"mb-2"},null,8,["modelValue","rules"]),e(K,{modelValue:l.username,"onUpdate:modelValue":_[1]||(_[1]=A=>l.username=A),label:"Username",placeholder:"Your login username",class:"mb-2"},null,8,["modelValue"]),e(K,{modelValue:l.email,"onUpdate:modelValue":_[2]||(_[2]=A=>l.email=A),label:"Email",type:"email",placeholder:"your@email.com",rules:[Z.email],class:"mb-2"},null,8,["modelValue","rules"]),e(K,{modelValue:l.url,"onUpdate:modelValue":_[3]||(_[3]=A=>l.url=A),label:"Website URL",placeholder:"https://example.com",class:"mb-2"},null,8,["modelValue"]),g("div",Pt,[e(K,{modelValue:l.password,"onUpdate:modelValue":_[4]||(_[4]=A=>l.password=A),type:i.value?"text":"password",label:"Password","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":_[5]||(_[5]=A=>i.value=!i.value),class:"flex-grow-1 password-field"},null,8,["modelValue","type","append-inner-icon"]),e(G,{text:"Generate password",location:"top"},{activator:a(({props:A})=>[e(q,ye(A,{icon:"",variant:"tonal",color:"primary",onClick:_[6]||(_[6]=ce=>k.value=!k.value),class:"mt-1"}),{default:a(()=>[e(C,{icon:"mdi-refresh"})]),_:2},1040)]),_:1})]),e(L,null,{default:a(()=>[k.value?(x(),W(m,{key:0,variant:"outlined",class:"mb-3"},{default:a(()=>[e(le,{class:"pa-3"},{default:a(()=>[g("div",Tt,[g("span",Nt,"Length: "+I(h.value),1),e(M,{modelValue:h.value,"onUpdate:modelValue":_[7]||(_[7]=A=>h.value=A),min:8,max:64,step:1,color:"primary","hide-details":"",style:{"max-width":"200px"}},null,8,["modelValue"])]),g("div",Mt,[e(j,{color:f.uppercase?"primary":"default",variant:f.uppercase?"flat":"outlined",size:"small",onClick:_[8]||(_[8]=A=>f.uppercase=!f.uppercase)},{default:a(()=>[v(" A-Z ")]),_:1},8,["color","variant"]),e(j,{color:f.lowercase?"primary":"default",variant:f.lowercase?"flat":"outlined",size:"small",onClick:_[9]||(_[9]=A=>f.lowercase=!f.lowercase)},{default:a(()=>[v(" a-z ")]),_:1},8,["color","variant"]),e(j,{color:f.numbers?"primary":"default",variant:f.numbers?"flat":"outlined",size:"small",onClick:_[10]||(_[10]=A=>f.numbers=!f.numbers)},{default:a(()=>[v(" 0-9 ")]),_:1},8,["color","variant"]),e(j,{color:f.special?"primary":"default",variant:f.special?"flat":"outlined",size:"small",onClick:_[11]||(_[11]=A=>f.special=!f.special)},{default:a(()=>[v(" !@#$ ")]),_:1},8,["color","variant"])]),e(q,{block:"",color:"primary",size:"small",onClick:U,disabled:!H.value},{default:a(()=>[e(C,{icon:"mdi-refresh",class:"mr-2"}),v(" Generate Password ")]),_:1},8,["disabled"])]),_:1})]),_:1})):B("",!0)]),_:1}),l.password?(x(),W(et,{key:0,password:l.password,"show-requirements":!1,"show-feedback":!0,class:"mb-3"},null,8,["password"])):B("",!0),e(K,{modelValue:l.totp,"onUpdate:modelValue":_[12]||(_[12]=A=>l.totp=A),label:"TOTP Secret (optional)",placeholder:"2FA secret key",hint:"Stored for reference only - no code generation","persistent-hint":"",class:"mb-2"},null,8,["modelValue"]),e(z,{modelValue:l.note,"onUpdate:modelValue":_[13]||(_[13]=A=>l.note=A),label:"Notes (optional)",placeholder:"Additional information...",rows:"3","auto-grow":""},null,8,["modelValue"])]),_:1},512)]),_:1}),e(ne,{class:"pa-4 pt-0"},{default:a(()=>[e(X),e(q,{variant:"text",onClick:S,disabled:t.isLoading},{default:a(()=>[v(" Cancel ")]),_:1},8,["disabled"]),e(q,{color:"primary",loading:t.isLoading,disabled:!J.value,onClick:E},{default:a(()=>[v(I(Y.value?"Save Changes":"Add Entry"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Ot=$e(Rt,[["__scopeId","data-v-df5e42d6"]]),Ft=g("span",{class:"text-caption text-medium-emphasis px-2"},"or enter password",-1),jt={__name:"VaultUnlockDialog",props:{modelValue:{type:Boolean,default:!1},isNewVault:{type:Boolean,default:!1},hasWebAuthn:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["update:modelValue","submit","webauthn","cancel"],setup(t,{emit:r}){const o=t,n=r,s=b(""),y=b(""),i=b(!1),k=b(!1),l=b(""),h=Q(()=>typeof window<"u"&&window.PublicKeyCredential!==void 0),f=Q(()=>o.isNewVault&&y.value&&s.value!==y.value),Z=Q(()=>s.value?pt(s.value).score<2:!1),Y=Q(()=>!(!s.value||o.isNewVault&&(!y.value||f.value)));xe(()=>o.modelValue,U=>{U&&(s.value="",y.value="",i.value=!1,l.value="")}),xe(()=>o.error,U=>{l.value=U});function J(){Y.value&&(l.value="",n("submit",s.value))}async function H(){k.value=!0;try{n("webauthn")}finally{k.value=!1}}function P(){n("cancel"),n("update:modelValue",!1)}return(U,E)=>{const S=c("v-icon"),T=c("v-card-title"),_=c("v-alert"),C=c("v-text-field"),R=c("v-btn"),K=c("v-divider"),q=c("v-card-text"),G=c("v-spacer"),M=c("v-card-actions"),j=c("v-card"),le=c("v-dialog");return x(),W(le,{"model-value":t.modelValue,"onUpdate:modelValue":E[6]||(E[6]=m=>U.$emit("update:modelValue",m)),"max-width":"450",persistent:"",scrim:!0},{default:a(()=>[e(j,null,{default:a(()=>[e(T,{class:"bg-surface-variant d-flex align-center"},{default:a(()=>[e(S,{icon:t.isNewVault?"mdi-shield-key":"mdi-lock",class:"mr-2"},null,8,["icon"]),v(" "+I(t.isNewVault?"Create Password Vault":"Unlock Vault"),1)]),_:1}),e(q,{class:"pa-4"},{default:a(()=>[t.isNewVault?(x(),ae(we,{key:0},[e(_,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:a(()=>[v(" Create a master password to protect your vault. This password will encrypt all your stored passwords. ")]),_:1}),e(C,{modelValue:s.value,"onUpdate:modelValue":E[0]||(E[0]=m=>s.value=m),type:i.value?"text":"password",label:"Master Password","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":E[1]||(E[1]=m=>i.value=!i.value),onKeyup:E[2]||(E[2]=be(m=>y.value&&J(),["enter"])),autocomplete:"new-password",autofocus:"",class:"mb-2"},null,8,["modelValue","type","append-inner-icon"]),e(C,{modelValue:y.value,"onUpdate:modelValue":E[3]||(E[3]=m=>y.value=m),type:i.value?"text":"password",label:"Confirm Password","error-messages":f.value?"Passwords do not match":"",onKeyup:be(J,["enter"]),autocomplete:"new-password",class:"mb-2"},null,8,["modelValue","type","error-messages"]),s.value?(x(),W(et,{key:0,password:s.value,"show-requirements":!0,"show-feedback":!0,class:"mb-3"},null,8,["password"])):B("",!0),Z.value&&s.value?(x(),W(_,{key:1,type:"warning",variant:"tonal",density:"compact",class:"mb-3"},{default:a(()=>[v(" This password is weak. A strong master password is recommended to protect your vault. ")]),_:1})):B("",!0)],64)):(x(),ae(we,{key:1},[t.hasWebAuthn&&h.value?(x(),W(R,{key:0,block:"",color:"primary",size:"large",loading:k.value,onClick:H,class:"mb-4"},{default:a(()=>[e(S,{icon:"mdi-fingerprint",class:"mr-2"}),v(" Unlock with Biometrics ")]),_:1},8,["loading"])):B("",!0),t.hasWebAuthn&&h.value?(x(),W(K,{key:1,class:"mb-4"},{default:a(()=>[Ft]),_:1})):B("",!0),e(C,{modelValue:s.value,"onUpdate:modelValue":E[4]||(E[4]=m=>s.value=m),type:i.value?"text":"password",label:"Master Password","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":E[5]||(E[5]=m=>i.value=!i.value),onKeyup:be(J,["enter"]),"error-messages":l.value,autocomplete:"current-password",autofocus:""},null,8,["modelValue","type","append-inner-icon","error-messages"])],64)),t.error&&!t.isNewVault?(x(),W(_,{key:2,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:a(()=>[v(I(t.error),1)]),_:1})):B("",!0)]),_:1}),e(M,{class:"pa-4 pt-0"},{default:a(()=>[e(G),t.isNewVault?B("",!0):(x(),W(R,{key:0,variant:"text",onClick:P,disabled:t.isLoading},{default:a(()=>[v(" Cancel ")]),_:1},8,["disabled"])),e(R,{color:"primary",loading:t.isLoading,disabled:!Y.value,onClick:J},{default:a(()=>[v(I(t.isNewVault?"Create Vault":"Unlock"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}};function zt(t){if(!t||typeof t!="string")return[];const r=[];let o="",n=!1;for(let i=0;i<t.length;i++){const k=t[i],l=t[i+1];k==='"'?n&&l==='"'?(o+='""',i++):(n=!n,o+=k):(k===`
`||k==="\r"&&l===`
`)&&!n?(o.trim()&&r.push(o),o="",k==="\r"&&i++):k==="\r"&&!n?(o.trim()&&r.push(o),o=""):o+=k}if(o.trim()&&r.push(o),r.length===0)return[];const s=He(r[0]),y=[];for(let i=1;i<r.length;i++){const k=He(r[i]),l={};s.forEach((h,f)=>{l[h.toLowerCase().trim()]=k[f]||""}),y.push(Le(l))}return y}function He(t){const r=[];let o="",n=!1;for(let s=0;s<t.length;s++){const y=t[s],i=t[s+1];y==='"'?n?i==='"'?(o+='"',s++):n=!1:n=!0:y===","&&!n?(r.push(o),o=""):o+=y}return r.push(o),r}function Bt(t){if(!t||typeof t!="string")return[];try{const r=JSON.parse(t);return Array.isArray(r)?r.map(o=>Le(o)):r.entries&&Array.isArray(r.entries)?r.entries.map(o=>Le(o)):r.items&&Array.isArray(r.items)?r.items.map(o=>Le(o)):[]}catch(r){return console.error("Failed to parse JSON:",r),[]}}function Le(t){const r={name:["name","title","site","service","label","website"],username:["username","user","login","account","user_name","loginname"],email:["email","mail","e-mail","email_address"],url:["url","uri","website","site_url","login_url","link"],password:["password","pass","pwd","secret"],totp:["totp","otp","totp_secret","2fa","mfa","authenticator"],note:["note","notes","comment","comments","memo","description"],createdAt:["created_at","createdat","created","date_created","creation_date"],updatedAt:["updated_at","updatedat","updated","modified","date_modified","modification_date"]},o={name:"",username:"",email:"",url:"",password:"",totp:"",note:"",createdAt:"",updatedAt:""},n={};return Object.keys(t).forEach(s=>{n[s.toLowerCase().replace(/[_-]/g,"")]=t[s]}),Object.keys(r).forEach(s=>{const y=r[s];for(const i of y){const k=i.toLowerCase().replace(/[_-]/g,"");if(n[k]!==void 0){o[s]=String(n[k]||"");break}}}),Object.keys(t).forEach(s=>{const y=s.toLowerCase();Object.keys(r).forEach(i=>{r[i].includes(y)&&!o[i]&&(o[i]=String(t[s]||""))})}),o}function Wt(t,r){const o=t.toLowerCase();if(o.endsWith(".aes"))return{format:"unknown",isEncrypted:!0,algorithm:"jsAesCrypt"};if(o.endsWith(".enc"))return{format:"unknown",isEncrypted:!0,algorithm:"webCrypto"};if(o.endsWith(".age"))return{format:"unknown",isEncrypted:!0,algorithm:"age"};let n=r;r instanceof Uint8Array&&(n=new TextDecoder().decode(r));const s=n.trim();if(s.startsWith("{")||s.startsWith("["))try{return JSON.parse(s),{format:"json",isEncrypted:!1,algorithm:null}}catch{}return{format:"csv",isEncrypted:!1,algorithm:null}}function Kt(t,r){const o=new Map;t.forEach(s=>{const y=`${s.name.toLowerCase()}|${s.username.toLowerCase()}`;o.set(y,s)});const n=[];return r.forEach(s=>{const y=`${s.name.toLowerCase()}|${s.username.toLowerCase()}`,i=o.get(y);i&&n.push({existing:i,new:s,key:y})}),n}const at=t=>(Xe("data-v-b883892c"),t=t(),Ze(),t),Yt=at(()=>g("div",{class:"text-caption text-medium-emphasis mt-2"}," Supported formats: CSV, JSON, or encrypted versions (.aes, .enc, .age) ",-1)),Jt={class:"d-flex align-center justify-space-between mb-3"},qt={class:"text-subtitle-1"},Gt=at(()=>g("thead",null,[g("tr",null,[g("th",null,"Name"),g("th",null,"Username"),g("th",null,"URL"),g("th",null,"Status")])],-1)),Ht={class:"text-truncate",style:{"max-width":"150px"}},Qt={class:"text-truncate",style:{"max-width":"120px"}},Xt={class:"text-truncate",style:{"max-width":"150px"}},Zt={key:3,class:"text-center pa-4"},ea={class:"mt-2 text-body-2"},ta={__name:"VaultImportDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","import"],setup(t,{emit:r}){const o=t,n=r,{getEntries:s,importEntries:y}=tt(),i=b("select"),k=b(null),l=b(null),h=b(null),f=b([]),Z=b("skip"),Y=b(""),J=b(!1),H=b(""),P=b(!1),U=b(""),E=b(""),S=Q(()=>{const m=s();return Kt(m,f.value)}),T=Q(()=>S.value.length);xe(()=>o.modelValue,m=>{m&&_()});function _(){i.value="select",k.value=null,l.value=null,h.value=null,f.value=[],Z.value="skip",Y.value="",H.value="",E.value=""}function C(){var m;i.value==="preview"?(m=h.value)!=null&&m.isEncrypted?i.value="decrypt":i.value="select":i.value==="decrypt"&&(i.value="select")}async function R(m){if(m){P.value=!0,U.value="Reading file...",E.value="";try{const L=await m.arrayBuffer(),z=new Uint8Array(L);if(h.value=Wt(m.name,z),h.value.isEncrypted)l.value=z,i.value="decrypt";else{const se=new TextDecoder().decode(z);await q(se,h.value.format)}}catch(L){console.error("File read error:",L),E.value="Failed to read file"}finally{P.value=!1}}}async function K(){if(!(!Y.value||!l.value)){P.value=!0,U.value="Decrypting file...",H.value="",E.value="";try{const m=new Worker(new URL("/assets/cryptoWorker-DRYHjFPq.js",import.meta.url),{type:"module"}),L=await new Promise((ne,N)=>{m.onmessage=ce=>{const[u,d]=ce.data;u==="ERROR"?N(new Error(d)):ne(d),m.terminate()},m.onerror=ce=>{N(ce),m.terminate()};const A=new Blob([l.value]);m.postMessage(["DECRYPT",A,Y.value,"import",h.value.algorithm])}),z=new TextDecoder().decode(L),se=z.trim(),X=se.startsWith("{")||se.startsWith("[")?"json":"csv";await q(z,X)}catch(m){console.error("Decryption error:",m);const L=typeof m=="string"?m:m.message||"Decryption failed";L.toLowerCase().includes("password")||L.toLowerCase().includes("decrypt")?H.value="Incorrect password":H.value=L}finally{P.value=!1}}}async function q(m,L){P.value=!0,U.value="Parsing entries...",E.value="";try{let z;if(L==="json"?z=Bt(m):z=zt(m),z.length===0){E.value="No entries found in file",i.value="select";return}f.value=z,i.value="preview"}catch(z){console.error("Parse error:",z),E.value="Failed to parse file contents",i.value="select"}finally{P.value=!1}}async function G(){if(f.value.length!==0){P.value=!0,U.value="Importing entries...",E.value="";try{const m=await y(f.value,Z.value);n("import",m),n("update:modelValue",!1)}catch(m){console.error("Import error:",m),E.value="Failed to import entries"}finally{P.value=!1}}}function M(){n("update:modelValue",!1)}function j(m){const L=`${m.name.toLowerCase()}|${m.username.toLowerCase()}`;return S.value.some(z=>z.key===L)}function le(m){if(!m)return"-";try{return new URL(m.startsWith("http")?m:`https://${m}`).hostname}catch{return m.substring(0,30)}}return(m,L)=>{const z=c("v-icon"),se=c("v-card-title"),X=c("v-alert"),ne=c("v-file-input"),N=c("v-text-field"),A=c("v-chip"),ce=c("v-select"),u=c("v-table"),d=c("v-card"),w=c("v-progress-circular"),V=c("v-card-text"),D=c("v-btn"),re=c("v-spacer"),ie=c("v-card-actions"),pe=c("v-dialog");return x(),W(pe,{"model-value":t.modelValue,"onUpdate:modelValue":L[4]||(L[4]=ee=>m.$emit("update:modelValue",ee)),"max-width":"600",persistent:""},{default:a(()=>[e(d,null,{default:a(()=>[e(se,{class:"bg-surface-variant d-flex align-center"},{default:a(()=>[e(z,{icon:"mdi-upload",class:"mr-2"}),v(" Import Passwords ")]),_:1}),e(V,{class:"pa-4"},{default:a(()=>[i.value==="select"?(x(),ae(we,{key:0},[e(X,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:a(()=>[v(" Import passwords from CSV or JSON files. Supports encrypted files (.aes, .enc, .age). ")]),_:1}),e(ne,{modelValue:k.value,"onUpdate:modelValue":[L[0]||(L[0]=ee=>k.value=ee),R],label:"Select file to import",accept:".csv,.json,.aes,.enc,.age","prepend-icon":"mdi-file","show-size":""},null,8,["modelValue"]),Yt],64)):B("",!0),i.value==="decrypt"?(x(),ae(we,{key:1},[e(X,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:a(()=>[v(" This file is encrypted. Enter the password to decrypt it. ")]),_:1}),e(N,{modelValue:Y.value,"onUpdate:modelValue":L[1]||(L[1]=ee=>Y.value=ee),type:J.value?"text":"password",label:"Decryption Password","append-inner-icon":J.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":L[2]||(L[2]=ee=>J.value=!J.value),onKeyup:be(K,["enter"]),"error-messages":H.value,autofocus:""},null,8,["modelValue","type","append-inner-icon","error-messages"])],64)):B("",!0),i.value==="preview"?(x(),ae(we,{key:2},[g("div",Jt,[g("span",qt," Found "+I(f.value.length)+" entries ",1),T.value>0?(x(),W(A,{key:0,color:"warning",size:"small"},{default:a(()=>[v(I(T.value)+" duplicates ",1)]),_:1})):B("",!0)]),T.value>0?(x(),W(ce,{key:0,modelValue:Z.value,"onUpdate:modelValue":L[3]||(L[3]=ee=>Z.value=ee),label:"Handle duplicates",items:[{title:"Skip duplicates",value:"skip"},{title:"Overwrite existing",value:"overwrite"},{title:"Keep both",value:"keepBoth"}],"item-title":"title","item-value":"value",density:"compact",class:"mb-3"},null,8,["modelValue"])):B("",!0),e(d,{variant:"outlined",class:"preview-container"},{default:a(()=>[e(u,{density:"compact","fixed-header":"",height:"300"},{default:a(()=>[Gt,g("tbody",null,[(x(!0),ae(we,null,Qe(f.value,(ee,Ie)=>(x(),ae("tr",{key:Ie},[g("td",Ht,I(ee.name||"-"),1),g("td",Qt,I(ee.username||ee.email||"-"),1),g("td",Xt,I(le(ee.url)),1),g("td",null,[e(A,{color:j(ee)?"warning":"success",size:"x-small"},{default:a(()=>[v(I(j(ee)?"Duplicate":"New"),1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})],64)):B("",!0),P.value?(x(),ae("div",Zt,[e(w,{indeterminate:"",color:"primary"}),g("div",ea,I(U.value),1)])):B("",!0),E.value&&i.value!=="decrypt"?(x(),W(X,{key:4,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:a(()=>[v(I(E.value),1)]),_:1})):B("",!0)]),_:1}),e(ie,{class:"pa-4 pt-0"},{default:a(()=>[i.value!=="select"?(x(),W(D,{key:0,variant:"text",onClick:C,disabled:P.value},{default:a(()=>[v(" Back ")]),_:1},8,["disabled"])):B("",!0),e(re),e(D,{variant:"text",onClick:M,disabled:P.value},{default:a(()=>[v(" Cancel ")]),_:1},8,["disabled"]),i.value==="decrypt"?(x(),W(D,{key:1,color:"primary",loading:P.value,disabled:!Y.value,onClick:K},{default:a(()=>[v(" Decrypt ")]),_:1},8,["loading","disabled"])):B("",!0),i.value==="preview"?(x(),W(D,{key:2,color:"primary",loading:P.value,disabled:f.value.length===0,onClick:G},{default:a(()=>[v(" Import "+I(f.value.length)+" Entries ",1)]),_:1},8,["loading","disabled"])):B("",!0)]),_:1})]),_:1})]),_:1},8,["model-value"])}}},aa=$e(ta,[["__scopeId","data-v-b883892c"]]),_e=t=>(Xe("data-v-dadde15c"),t=t(),Ze(),t),na=_e(()=>g("p",{class:"mb-2"},[v(" Your password vault is encrypted with "),g("strong",null,"Age encryption"),v(", a modern and secure encryption format. All data is stored locally in your browser and never leaves your device. ")],-1)),oa={class:"ml-4 mb-2"},la=_e(()=>g("li",null,[g("strong",null,"Master password"),v(" - Choose a strong, unique password you'll remember")],-1)),sa=_e(()=>g("strong",null,"Auto-lock",-1)),ra=_e(()=>g("li",null,[g("strong",null,"Local storage"),v(" - Data stays on your device, works offline")],-1)),ia=_e(()=>g("li",null,[g("strong",null,"Import/Export"),v(" - Migrate from other password managers via CSV/JSON")],-1)),ua={class:"text-h5 mb-2"},ca={class:"text-body-1 text-medium-emphasis mb-4"},da={key:0,class:"mt-4"},ma={class:"d-flex flex-wrap align-center gap-2"},pa={class:"d-flex align-center justify-space-between mb-3"},va={class:"text-body-2 text-medium-emphasis"},fa={key:0},ya={class:"text-h6 mb-2"},wa={class:"text-body-2 text-medium-emphasis mb-4"},_a={key:0,class:"d-flex justify-center gap-2"},ga={key:1,class:"entry-grid"},ha=_e(()=>g("p",null,"Are you sure you want to delete your vault?",-1)),ka=_e(()=>g("p",{class:"mb-3"},"Enter a password to encrypt the exported file.",-1)),ba={__name:"PasswordManager",setup(t){const{isLocked:r,isLoading:o,error:n,hasVault:s,createVault:y,unlockVault:i,lockVault:k,addEntry:l,updateEntry:h,deleteEntry:f,searchEntries:Z,getEntries:Y,getAutoLockMinutes:J,deleteVault:H}=tt(),{snackbar:P,snackbarText:U,snackbarColor:E,showSnackbar:S}=rt(),T=wt({onLock:()=>{k(),S("Vault auto-locked due to inactivity","info")},getTimeout:()=>J(),isLocked:()=>r.value}),_=b(""),C=b(!1),R=b(!1),K=b(!1),q=b(!1),G=b(!1),M=b(null),j=b(""),le=b(!1),m=b(null),L=b(!1),z=Q(()=>T.isActive.value),se=Q(()=>J()),X=b(null);let ne=null;function N(O){if(O===null||O<=0)return"0s";const p=Math.floor(O/60),F=O%60;return p>0?F>0?`${p}m ${F}s`:`${p}m`:`${F}s`}function A(){if(!T.isActive.value||r.value){X.value=null;return}X.value=T.getTimeRemaining()}function ce(){A(),ne&&clearInterval(ne),ne=setInterval(A,1e3)}function u(){ne&&(clearInterval(ne),ne=null),X.value=null}const d=Q(()=>_.value?Z(_.value):Y());xe(r,O=>{O?(T.stop(),u()):(T.start(),ce())}),Fe(()=>{s.value&&(C.value=!0)}),Ve(()=>{u()});async function w(O){const p=!s.value;let F;p?(F=await y(O),F&&S("Vault created successfully","success")):(F=await i(O),F&&S("Vault unlocked","success")),F&&(C.value=!1)}function V(){S("Biometric unlock not yet configured","info")}function D(){T.clear(),k(),S("Vault locked","info")}function re(){M.value=null,R.value=!0}function ie(O){M.value=O,R.value=!0}async function pe(O){let p;M.value?(p=await h(M.value.id,O),p&&S("Entry updated","success")):(p=await l(O),p&&S("Entry added","success")),p?(R.value=!1,M.value=null):S(n.value||"Failed to save entry","error")}async function ee(O){await f(O.id)?S("Entry deleted","success"):S(n.value||"Failed to delete entry","error")}async function Ie(O){S(`Import complete: ${O.added} added, ${O.updated} updated, ${O.skipped} skipped`,"success"),K.value=!1}function Ee(O){if(O.includes("encrypted")){m.value=O,j.value="",G.value=!0;return}ze(O)}async function je(){!j.value||!m.value||(G.value=!1,await ze(m.value,j.value),j.value="",m.value=null)}async function ze(O,p=null){const F=Y();let te,ue,me;if(O.replace("-encrypted","")==="csv"?(te=_t(F),ue=Ge("csv"),me="text/csv"):(te=ht(F),ue=Ge("json"),me="application/json"),p)try{const fe=new TextEncoder().encode(te),de=new Worker(new URL("/assets/cryptoWorker-DRYHjFPq.js",import.meta.url),{type:"module"}),De=await new Promise((Pe,Ce)=>{de.onmessage=ge=>{const[Ne,he]=ge.data;Ne==="ERROR"?Ce(new Error(he)):Pe(he),de.terminate()},de.onerror=ge=>{Ce(ge),de.terminate()};const Te=new Blob([fe]);de.postMessage(["ENCRYPT",Te,p,ue,"age"])});ue+=".age",Ke(De,ue),S(`Exported ${F.length} entries (encrypted)`,"success")}catch(ve){console.error("Export encryption failed:",ve),S("Failed to encrypt export","error")}else{const ve=new Blob([te],{type:me}),fe=new Uint8Array(await ve.arrayBuffer());Ke(fe,ue),S(`Exported ${F.length} entries`,"success")}}function nt(){H(),q.value=!1,S("Vault deleted","success")}return(O,p)=>{const F=c("v-icon"),te=c("v-btn"),ue=c("v-card-text"),me=c("v-card"),Ue=c("v-text-field"),ve=c("v-spacer"),fe=c("v-list-item-title"),de=c("v-list-item"),De=c("v-divider"),Pe=c("v-list"),Ce=c("v-menu"),Te=c("v-chip"),ge=c("v-card-title"),Ne=c("v-alert"),he=c("v-card-actions"),Be=c("v-dialog");return x(),ae("div",null,[e(ut,{title:"Password Manager",description:"Securely store and manage passwords with Age encryption",icon:"mdi-key","avatar-color":"primary"}),e(lt,{title:"Password Security Best Practices","storage-key":"slurm-help-password-manager"},{default:a(()=>[na,g("ul",oa,[la,g("li",null,[sa,v(" - Vault automatically locks after "+I(se.value)+" minutes of inactivity",1)]),ra,ia]),e(ct,{title:"Backup Reminder",type:"warning",spacing:"mt-3"},{default:a(()=>[v(" Export your vault regularly to a secure location. If you clear browser data, your vault will be lost. ")]),_:1})]),_:1}),oe(r)?(x(),W(me,{key:0,class:"mb-4"},{default:a(()=>[e(ue,{class:"pa-6 text-center"},{default:a(()=>[e(F,{icon:oe(s)?"mdi-lock":"mdi-shield-key",size:"64",color:"primary",class:"mb-4"},null,8,["icon"]),g("h2",ua,I(oe(s)?"Vault Locked":"Create Your Vault"),1),g("p",ca,I(oe(s)?"Enter your master password to unlock your password vault.":"Set up a secure vault to store your passwords. All data is encrypted and stored locally."),1),e(te,{color:"primary",size:"large",onClick:p[0]||(p[0]=$=>C.value=!0)},{default:a(()=>[e(F,{icon:oe(s)?"mdi-lock-open":"mdi-plus",class:"mr-2"},null,8,["icon"]),v(" "+I(oe(s)?"Unlock Vault":"Create Vault"),1)]),_:1}),oe(s)?(x(),ae("div",da,[e(te,{variant:"text",color:"error",size:"small",onClick:p[1]||(p[1]=$=>q.value=!0)},{default:a(()=>[v(" Delete Vault ")]),_:1})])):B("",!0)]),_:1})]),_:1})):(x(),ae(we,{key:1},[e(me,{class:"mb-4"},{default:a(()=>[e(ue,{class:"pa-3"},{default:a(()=>[g("div",ma,[e(Ue,{modelValue:_.value,"onUpdate:modelValue":p[2]||(p[2]=$=>_.value=$),"prepend-inner-icon":"mdi-magnify",placeholder:"Search passwords...","hide-details":"",density:"compact",clearable:"",style:{"max-width":"300px","min-width":"200px"},class:"flex-grow-1"},null,8,["modelValue"]),e(ve,{class:"d-none d-sm-flex"}),e(te,{color:"primary",onClick:re},{default:a(()=>[e(F,{icon:"mdi-plus",class:"mr-1"}),v(" Add ")]),_:1}),e(te,{variant:"tonal",onClick:p[3]||(p[3]=$=>K.value=!0)},{default:a(()=>[e(F,{icon:"mdi-upload",class:"mr-1"}),v(" Import ")]),_:1}),e(Ce,null,{activator:a(({props:$})=>[e(te,ye({variant:"tonal"},$),{default:a(()=>[e(F,{icon:"mdi-download",class:"mr-1"}),v(" Export ")]),_:2},1040)]),default:a(()=>[e(Pe,{density:"compact"},{default:a(()=>[e(de,{onClick:p[4]||(p[4]=$=>Ee("csv"))},{default:a(()=>[e(fe,null,{default:a(()=>[v("Export as CSV")]),_:1})]),_:1}),e(de,{onClick:p[5]||(p[5]=$=>Ee("json"))},{default:a(()=>[e(fe,null,{default:a(()=>[v("Export as JSON")]),_:1})]),_:1}),e(De),e(de,{onClick:p[6]||(p[6]=$=>Ee("csv-encrypted"))},{default:a(()=>[e(fe,null,{default:a(()=>[v("Export as Encrypted CSV")]),_:1})]),_:1}),e(de,{onClick:p[7]||(p[7]=$=>Ee("json-encrypted"))},{default:a(()=>[e(fe,null,{default:a(()=>[v("Export as Encrypted JSON")]),_:1})]),_:1})]),_:1})]),_:1}),e(te,{variant:"tonal",color:"warning",onClick:D},{default:a(()=>[e(F,{icon:"mdi-lock",class:"mr-1"}),v(" Lock ")]),_:1})])]),_:1})]),_:1}),g("div",pa,[g("span",va,[v(I(d.value.length)+" "+I(d.value.length===1?"entry":"entries")+" ",1),_.value?(x(),ae("span",fa,"(filtered)")):B("",!0)]),z.value&&X.value!==null?(x(),W(Te,{key:0,size:"small",color:"info",variant:"tonal"},{default:a(()=>[e(F,{icon:"mdi-clock",size:"14",class:"mr-1"}),v(" Auto-lock in "+I(N(X.value)),1)]),_:1})):B("",!0)]),d.value.length===0?(x(),W(me,{key:0,class:"mb-4"},{default:a(()=>[e(ue,{class:"pa-6 text-center"},{default:a(()=>[e(F,{icon:_.value?"mdi-magnify":"mdi-key",size:"48",color:"grey",class:"mb-3"},null,8,["icon"]),g("h3",ya,I(_.value?"No matches found":"No passwords yet"),1),g("p",wa,I(_.value?"Try a different search term":"Add your first password entry or import from a file"),1),_.value?B("",!0):(x(),ae("div",_a,[e(te,{color:"primary",onClick:re},{default:a(()=>[e(F,{icon:"mdi-plus",class:"mr-1"}),v(" Add Entry ")]),_:1}),e(te,{variant:"tonal",onClick:p[8]||(p[8]=$=>K.value=!0)},{default:a(()=>[e(F,{icon:"mdi-upload",class:"mr-1"}),v(" Import ")]),_:1})]))]),_:1})]),_:1})):(x(),ae("div",ga,[(x(!0),ae(we,null,Qe(d.value,$=>(x(),W(Dt,{key:$.id,entry:$,onEdit:ie,onDelete:ee,onCopySuccess:p[9]||(p[9]=Me=>oe(S)(Me,"success")),onCopyError:p[10]||(p[10]=Me=>oe(S)(Me,"error"))},null,8,["entry"]))),128))]))],64)),e(jt,{modelValue:C.value,"onUpdate:modelValue":p[11]||(p[11]=$=>C.value=$),"is-new-vault":!oe(s),"is-loading":oe(o),error:oe(n),"has-web-authn":L.value,onSubmit:w,onWebauthn:V},null,8,["modelValue","is-new-vault","is-loading","error","has-web-authn"]),e(Ot,{modelValue:R.value,"onUpdate:modelValue":p[12]||(p[12]=$=>R.value=$),entry:M.value,"is-loading":oe(o),onSubmit:pe},null,8,["modelValue","entry","is-loading"]),e(aa,{modelValue:K.value,"onUpdate:modelValue":p[13]||(p[13]=$=>K.value=$),onImport:Ie},null,8,["modelValue"]),e(Be,{modelValue:q.value,"onUpdate:modelValue":p[15]||(p[15]=$=>q.value=$),"max-width":"400"},{default:a(()=>[e(me,null,{default:a(()=>[e(ge,{class:"bg-surface-variant"},{default:a(()=>[e(F,{icon:"mdi-alert",color:"error",class:"mr-2"}),v(" Delete Vault ")]),_:1}),e(ue,{class:"pa-4"},{default:a(()=>[e(Ne,{type:"error",variant:"tonal",class:"mb-3"},{default:a(()=>[v(" This will permanently delete your password vault and all stored passwords. This action cannot be undone. ")]),_:1}),ha]),_:1}),e(he,{class:"pa-4 pt-0"},{default:a(()=>[e(ve),e(te,{variant:"text",onClick:p[14]||(p[14]=$=>q.value=!1)},{default:a(()=>[v("Cancel")]),_:1}),e(te,{color:"error",onClick:nt},{default:a(()=>[v("Delete Forever")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Be,{modelValue:G.value,"onUpdate:modelValue":p[19]||(p[19]=$=>G.value=$),"max-width":"400"},{default:a(()=>[e(me,null,{default:a(()=>[e(ge,{class:"bg-surface-variant"},{default:a(()=>[e(F,{icon:"mdi-lock",class:"mr-2"}),v(" Export Password ")]),_:1}),e(ue,{class:"pa-4"},{default:a(()=>[ka,e(Ue,{modelValue:j.value,"onUpdate:modelValue":p[16]||(p[16]=$=>j.value=$),type:le.value?"text":"password",label:"Export Password","append-inner-icon":le.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":p[17]||(p[17]=$=>le.value=!le.value),onKeyup:be(je,["enter"]),autofocus:""},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(he,{class:"pa-4 pt-0"},{default:a(()=>[e(ve),e(te,{variant:"text",onClick:p[18]||(p[18]=$=>G.value=!1)},{default:a(()=>[v("Cancel")]),_:1}),e(te,{color:"primary",onClick:je,disabled:!j.value},{default:a(()=>[v(" Export ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(it,{modelValue:oe(P),"onUpdate:modelValue":p[20]||(p[20]=$=>st(P)?P.value=$:null),text:oe(U),color:oe(E)},null,8,["modelValue","text","color"])])}}},$a=$e(ba,[["__scopeId","data-v-dadde15c"]]);export{$a as default};
