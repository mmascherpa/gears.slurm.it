import{_ as se,a as le,c as L,b as a,i as O,j,w as s,r as y,d as E,k as Y,e as l,o as b,F as K,g as e,f as o,t as ie,l as ce}from"./index-CLKbXmT3.js";import{d as de}from"./fileDownload-B1vhVzTR.js";import{C as pe,p as ue}from"./CsvPreviewTable-BMBUPjQu.js";import{P as me,u as ye,a as fe,b as ve}from"./PasswordInput-k2LxuvAN.js";import{u as he}from"./useClipboard-KqVwDR14.js";import{u as ge}from"./useDebounce-lrs_ZA3J.js";import{T as be,S as _e,u as we}from"./ToolPageHeader-BI_QYBdR.js";import{_ as xe}from"./EducationalAlert-Z7WFHq04.js";import{T as Ce,F as ke}from"./TextInputWithActions-DFbxHJqB.js";import{_ as Pe}from"./InfoTooltip-BFpW9KY-.js";import"./PasswordStrengthIndicator-CaVB0Qrk.js";import"./FileUpload-BTI_bZc9.js";const Ae={name:"Encrypt",components:{CsvPreviewTable:pe,EducationalAlert:xe,FileUploadWithValidation:ke,InfoTooltip:Pe,LearnMorePanel:le,PasswordInput:me,SharedSnackbar:_e,TextInputWithActions:Ce,ToolPageHeader:be},setup(){const u=y(""),n=y(""),p=y(""),t=y(""),f=y(null),v=y(""),_=y("jsAesCrypt"),m=y([]),w=y([]),{snackbar:V,snackbarColor:x,snackbarText:C,showSnackbar:d}=we(),{copyToClipboard:D,pasteFromClipboard:k}=he(),{announceToScreenReader:h}=ve(),{rememberPassword:P,isPasswordRemembered:M,saveSessionPassword:I,clearSessionPassword:R,autoLoadPassword:W}=ye("encrypt"),T=W();T&&(p.value=T,t.value=T);const{encrypt:U,isLoading:H}=fe((r,i)=>{S.value?(X(r),h("Text encrypted successfully")):(de(r,i),d("✓ File encrypted successfully!","success"),h("File encrypted and download started"),J())},(r,i)=>{n.value=i,d(r,"error"),h("Encryption failed: "+r,"assertive"),u.value=""}),N=E(()=>({jsAesCrypt:"What is AES Encryption?",webCrypto:"What is WebCrypto AES Encryption?",age:"What is Age Encryption?"})[_.value]||"What is Encryption?"),A=E(()=>B.value&&(F.value||S.value)),F=E(()=>!!f.value),c=E(()=>w.value.length>0||m.value.length>0),B=E(()=>p.value.trim()!==""&&p.value===t.value),S=E(()=>v.value.trim()!==""),J=()=>{P.value||(p.value="",t.value=""),v.value="",f.value=null,u.value="",q()},q=()=>{m.value=[],w.value=[],search.value="",n.value=""},Q=()=>{v.value="",u.value="",n.value="",re()},X=r=>{try{const i=new Blob([r]),g=new FileReader;g.onload=()=>{const z=g.result.split(",")[1];u.value=z,d("✓ Text encrypted successfully!","success")},g.onerror=()=>{n.value="Failed to convert encrypted data",d("❌ Encryption failed","error")},g.readAsDataURL(i)}catch(i){console.error("Base64 conversion error:",i),n.value="Failed to convert encrypted data",d("❌ Encryption failed","error")}},Z=()=>{if(!A.value){d("Invalid inputs","error");return}n.value="";let r=null,i=null;S.value?(r=new Blob([v.value],{type:"text/plain"}),i="plaintext.txt"):F.value&&(r=f.value,i=f.value.name),r&&i&&U(r,p.value,i,_.value)},$=r=>{if(f.value&&r.isValid){const i=f.value;if(i.type==="text/csv"){const g=new FileReader;g.onload=()=>{const z=g.result;ee(z)},g.readAsText(i)}}},ee=r=>{const i=ue(r);w.value=i.headers,m.value=i.data},te=()=>{if(A.value){n.value="",u.value="";try{const r=new Blob([v.value],{type:"text/plain"});U(r,p.value,"plaintext.txt",_.value)}catch(r){console.error("Encryption error:",r),n.value="Failed to initiate encryption",d("❌ Encryption failed","error")}}},oe=async()=>{await D(u.value,r=>d(r,"success"),r=>d(r,"error"))},ae=async()=>{await k((r,i)=>{v.value=r,d(i,"success"),G()},r=>d(r,"error"))},ne=()=>{u.value="",n.value="",G()},{cancel:re,debounce:G}=ge(()=>{A.value&&S.value&&te()},800);return Y(P,r=>{r&&B.value&&I(p.value)}),Y([p,t],()=>{P.value&&B.value&&I(p.value),S.value&&(u.value="",n.value="",G())}),{encryptedText:u,error:n,isLoading:H,password:p,passwordConfirm:t,plainFile:f,plainText:v,selectedAlgorithm:_,tableData:m,tableHeaders:w,rememberPassword:P,isPasswordRemembered:M,clearSessionPassword:R,snackbar:V,snackbarColor:x,snackbarText:C,canEncrypt:A,infoPanelTitle:N,isFilePopulated:F,isOutputPopulated:c,isPasswordConfirmed:B,isPlaintextPopulated:S,clearOutputs:q,clearPlainText:Q,encryptFile:Z,handleCopy:oe,handleFileValidation:$,handlePaste:ae,handlePlainTextChange:ne}}},Se=e("p",{class:"mb-2"},[e("strong",null,"AES (Advanced Encryption Standard)"),o(" is a military-grade encryption algorithm trusted by governments and organizations worldwide to protect sensitive data. ")],-1),Ee=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"AES-256"),o(" - This tool uses 256-bit keys, the strongest AES variant")]),e("li",null,[e("strong",null,"Password-based"),o(" - Your password is converted into an encryption key")]),e("li",null,[e("strong",null,"Cross-platform"),o(" - Compatible with desktop AES Crypt applications")]),e("li",null,[e("strong",null,"Unbreakable"),o(" - With a strong password, AES-256 would take billions of years to crack")])],-1),Te=e("strong",null,"cannot be recovered",-1),Fe=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Encrypt sensitive documents before uploading to cloud storage, secure backups, protect confidential files on shared computers. ")],-1),Ve=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),o(" • "),e("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard "),o(" • "),e("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," jsAesCrypt ")],-1),Ie=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" AES-256-CBC cipher mode with PBKDF2 key derivation (10,000 iterations). Uses jsAesCrypt and CryptoJS libraries. Produces .aes files compatible with AES Crypt format. ")],-1),We=e("p",{class:"mb-2"},[e("strong",null,"Web Cryptography API"),o(" provides browser-native AES-256 encryption with hardware acceleration, offering fast, secure encryption without external libraries. ")],-1),Ue=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"AES-256-GCM"),o(" - Modern authenticated encryption mode that prevents tampering")]),e("li",null,[e("strong",null,"Hardware-accelerated"),o(" - Uses CPU crypto instructions for optimal performance")]),e("li",null,[e("strong",null,"Browser-native"),o(" - Built into modern browsers, no external dependencies")]),e("li",null,[e("strong",null,"High security"),o(" - PBKDF2 with 100,000 iterations for strong key derivation")])],-1),Be=e("strong",null,"cannot be recovered",-1),Le=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Fast encryption for modern browsers, maximum compatibility, browser-based secure storage, privacy-focused applications. ")],-1),je=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," MDN: Web Crypto API "),o(" • "),e("a",{href:"https://www.w3.org/TR/WebCryptoAPI/",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," W3C Specification ")],-1),De=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" AES-256-GCM authenticated encryption with PBKDF2 key derivation (100,000 iterations). Browser-native Web Crypto API. Produces .enc files. ")],-1),Me=e("p",{class:"mb-2"},[e("strong",null,"Age encryption"),o(" is a modern, simple file encryption tool designed as a replacement for GPG. Created by Filippo Valsorda, it focuses on simplicity and ease of use. ")],-1),Re=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Simple format"),o(" - Compact, easy-to-use encryption format")]),e("li",null,[e("strong",null,"CLI-compatible"),o(" - Works with age and rage command-line tools")]),e("li",null,[e("strong",null,"scrypt derivation"),o(" - Secure against GPU-based password cracking")]),e("li",null,[e("strong",null,"Armor format"),o(" - ASCII-armored output for text-safe transmission")])],-1),He=e("strong",null,"cannot be recovered",-1),Ne=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Cross-platform encrypted backups, scripting and automation, developer workflows, command-line integration. ")],-1),Ge=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://age-encryption.org",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age specification "),o(" • "),e("a",{href:"https://github.com/FiloSottile/age",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age on GitHub "),o(" • "),e("a",{href:"https://github.com/str4d/rage",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," rage (Rust) ")],-1),ze=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" Uses rage-wasm (Rust compiled to WebAssembly) with scrypt password derivation. Produces .age files with optional armor encoding. ")],-1),Oe=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (jsAesCrypt)"),e("div",{class:"text-caption text-medium-emphasis"},"Compatible with AES Crypt format (.aes files)")],-1),Ke=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (WebCrypto)"),e("div",{class:"text-caption text-medium-emphasis"},"Browser-native encryption (.enc files)")],-1),qe=e("div",null,[e("div",{class:"font-weight-medium"},"Age Encryption"),e("div",{class:"text-caption text-medium-emphasis"},"Modern encryption format (.age files)")],-1),Ye=e("a",{href:"https://age-encryption.org",target:"_blank",class:"text-info"},"age CLI tool",-1),Je=e("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Qe=e("p",{class:"text-h6 mt-4"},"Encrypting...",-1);function Xe(u,n,p,t,f,v){const _=l("ToolPageHeader"),m=l("EducationalAlert"),w=l("LearnMorePanel"),V=l("v-alert"),x=l("v-icon"),C=l("v-card-title"),d=l("v-radio"),D=l("v-radio-group"),k=l("v-card-text"),h=l("v-card"),P=l("InfoTooltip"),M=l("PasswordInput"),I=l("v-checkbox"),R=l("v-chip"),W=l("TextInputWithActions"),T=l("v-divider"),U=l("FileUploadWithValidation"),H=l("CsvPreviewTable"),N=l("SharedSnackbar"),A=l("v-progress-circular"),F=l("v-overlay");return b(),L("div",null,[a(_,{icon:"mdi-lock",title:"Encryption",description:"Encrypt files and text with password protection using military-grade encryption","avatar-color":"primary"}),a(w,{title:t.infoPanelTitle,"storage-key":"slurm-help-encrypt"},{default:s(()=>[t.selectedAlgorithm==="jsAesCrypt"?(b(),L(K,{key:0},[Se,Ee,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Te,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Fe,Ve,Ie],64)):t.selectedAlgorithm==="webCrypto"?(b(),L(K,{key:1},[We,Ue,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Be,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Le,je,De],64)):t.selectedAlgorithm==="age"?(b(),L(K,{key:2},[Me,Re,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),He,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Ne,Ge,ze],64)):j("",!0)]),_:1},8,["title"]),t.error?(b(),O(V,{key:0,type:"error",variant:"tonal",closable:"","onClick:close":n[0]||(n[0]=c=>t.error=""),class:"mb-4"},{default:s(()=>[o(ie(t.error),1)]),_:1})):j("",!0),a(h,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-shield-lock",class:"mr-2"}),o(" Encryption Algorithm ")]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(D,{modelValue:t.selectedAlgorithm,"onUpdate:modelValue":n[1]||(n[1]=c=>t.selectedAlgorithm=c),inline:""},{default:s(()=>[a(d,{value:"jsAesCrypt"},{label:s(()=>[Oe]),_:1}),a(d,{value:"webCrypto"},{label:s(()=>[Ke]),_:1}),a(d,{value:"age"},{label:s(()=>[qe]),_:1})]),_:1},8,["modelValue"]),t.selectedAlgorithm==="age"?(b(),O(V,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:s(()=>[o(" Age encrypted files (.age) are compatible with the "),Ye]),_:1})):j("",!0)]),_:1})]),_:1}),a(h,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-key",class:"mr-2"}),o(" Password Protection "),a(P,{text:"Password strength directly determines your encryption security. A weak 6-character password can be cracked in minutes, while a strong 16+ character password would take centuries to brute-force.",location:"bottom"})]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(m,{title:"Password Strength Matters",type:"info",spacing:"mb-3"},{default:s(()=>[o(" Use at least 12 characters with a mix of uppercase, lowercase, numbers, and symbols. Your password security determines how long your encrypted data stays protected. ")]),_:1}),e("form",{onSubmit:n[5]||(n[5]=ce(()=>{},["prevent"]))},[Je,a(M,{password:t.password,"onUpdate:password":n[2]||(n[2]=c=>t.password=c),"password-confirm":t.passwordConfirm,"onUpdate:passwordConfirm":n[3]||(n[3]=c=>t.passwordConfirm=c),"require-confirmation":!0,"show-strength":!0,"show-requirements":!0,"show-feedback":!1,autocomplete:"new-password"},null,8,["password","password-confirm"]),a(I,{modelValue:t.rememberPassword,"onUpdate:modelValue":n[4]||(n[4]=c=>t.rememberPassword=c),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),t.isPasswordRemembered?(b(),O(R,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":t.clearSessionPassword,class:"mt-2"},{default:s(()=>[o(" Password remembered for session ")]),_:1},8,["onClick:close"])):j("",!0)],32)]),_:1})]),_:1}),a(h,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-text",class:"mr-2"}),o(" Text Encryption ")]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(W,{modelValue:t.plainText,"onUpdate:modelValue":n[6]||(n[6]=c=>t.plainText=c),label:"Plain Text",placeholder:"Enter your plain text here",rows:4,disabled:t.isFilePopulated,"show-paste":!t.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"plain-text-input",onPaste:t.handlePaste,onClear:t.clearPlainText,onInput:t.handlePlainTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),a(T,{class:"my-4"}),a(W,{modelValue:t.encryptedText,"onUpdate:modelValue":n[7]||(n[7]=c=>t.encryptedText=c),label:"Encrypted Text (Base64)",placeholder:"Encrypted output will appear here...",rows:4,"is-loading":t.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:t.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),a(h,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-file",class:"mr-2"}),o(" File Encryption ")]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(U,{modelValue:t.plainFile,"onUpdate:modelValue":n[8]||(n[8]=c=>t.plainFile=c),label:"Select file to encrypt","button-text":"Encrypt","button-icon":"mdi-lock",disabled:t.isPlaintextPopulated,"can-submit":t.canEncrypt,onSubmit:t.encryptFile,onValidationChange:t.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1}),a(H,{headers:t.tableHeaders,data:t.tableData,onClose:t.clearOutputs},null,8,["headers","data","onClose"]),a(N,{modelValue:t.snackbar,"onUpdate:modelValue":n[9]||(n[9]=c=>t.snackbar=c),text:t.snackbarText,color:t.snackbarColor},null,8,["modelValue","text","color"]),a(F,{"model-value":t.isLoading,class:"align-center justify-center"},{default:s(()=>[a(A,{indeterminate:"",size:"64",color:"primary"}),Qe]),_:1},8,["model-value"])])}const dt=se(Ae,[["render",Xe]]);export{dt as default};
