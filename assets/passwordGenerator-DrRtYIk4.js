const r={uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",lowercase:"abcdefghijklmnopqrstuvwxyz",numbers:"0123456789",special:"!@#$%^&*()_+-=[]{}|;:,.<>?"};function h(c){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]%c}function d(c){const e=[...c];for(let s=e.length-1;s>0;s--){const o=h(s+1);[e[s],e[o]]=[e[o],e[s]]}return e}function w(c){const{length:e=16,includeUppercase:s=!0,includeLowercase:o=!0,includeNumbers:p=!0,includeSpecial:i=!0}=c;if(e<8||e>64)throw new Error("Password length must be between 8 and 64 characters");let n="";const t=[];if(s&&(n+=r.uppercase,t.push({chars:r.uppercase,name:"uppercase"})),o&&(n+=r.lowercase,t.push({chars:r.lowercase,name:"lowercase"})),p&&(n+=r.numbers,t.push({chars:r.numbers,name:"numbers"})),i&&(n+=r.special,t.push({chars:r.special,name:"special"})),n.length===0)throw new Error("At least one character type must be selected");const u=[];for(const a of t){const l=h(a.chars.length);u.push(a.chars[l])}const f=e-t.length;for(let a=0;a<f;a++){const l=h(n.length);u.push(n[l])}return d(u).join("")}export{w as g};
