import{_ as ue,a as pe,c as me,b as o,g as a,i as S,j as E,w as s,l as ve,r as y,d as D,k as O,e as i,o as C,f as r,t as J}from"./index-B-OSmdDu.js";import{d as X}from"./fileDownload-B1vhVzTR.js";import{C as ye,p as fe}from"./CsvPreviewTable-CVo4TOOC.js";import{P as he,u as _e,a as we}from"./PasswordInput-B8JL8r9z.js";import{u as be}from"./useClipboard-KqVwDR14.js";import{u as xe}from"./useDebounce-CPmkfBar.js";import{T as ge,S as Te,u as ke}from"./ToolPageHeader-BJQ7B0XN.js";import{_ as Pe}from"./EducationalAlert-DkUlmwt3.js";import{T as Ce,F as Se}from"./TextInputWithActions-kl_sTwEg.js";import"./PasswordStrengthIndicator-BC1YKonA.js";import"./FileUpload-D9EThhA_.js";const Ee={name:"AesDecrypt",components:{CsvPreviewTable:ye,EducationalAlert:Pe,FileUploadWithValidation:Se,LearnMorePanel:pe,PasswordInput:he,SharedSnackbar:Te,TextInputWithActions:Ce,ToolPageHeader:ge},setup(){const n=y(null),h=y(""),e=y(""),b=y(null),x=y(""),m=y(""),v=y(""),g=y(""),u=y([]),f=y([]),{snackbar:I,snackbarColor:B,snackbarText:L,showSnackbar:l}=ke(),{copyToClipboard:_,pasteFromClipboard:F}=be(),{rememberPassword:T,isPasswordRemembered:W,saveSessionPassword:w,clearSessionPassword:z,autoLoadPassword:M}=_e("decrypt"),V=M();V&&(v.value=V);const{decrypt:A,isLoading:U}=we((t,d)=>{c.value?ae(t):oe(t,d)},(t,d)=>{m.value=d,l(t,"error"),e.value=""}),k=D(()=>q.value&&(K.value||c.value)),c=D(()=>x.value.trim()!==""),K=D(()=>!!b.value),Z=D(()=>!!g.value||f.value.length>0||u.value.length>0),q=D(()=>v.value.trim()!==""),j=()=>{T.value||(v.value=""),b.value=null,x.value=""},N=()=>{g.value="",e.value="",u.value=[],f.value=[],n.value=null,h.value=""},G=()=>{x.value="",e.value="",m.value="",ce()},Q=()=>{try{const t=atob(x.value),d=new Uint8Array(t.length);for(let p=0;p<t.length;p++)d[p]=t.charCodeAt(p);return new Blob([d])}catch(t){return console.error("Base64 decode error:",t),m.value="Invalid Base64 format",l("❌ Invalid encrypted text format","error"),null}},$=()=>{if(!k.value)return;m.value="",e.value="";const t=Q();t&&A(t,v.value,"encrypted.aes")},ee=()=>{if(!k.value){l("Invalid inputs","error");return}m.value="",A(b.value,v.value,b.value.name)},te=()=>{n.value&&h.value&&(X(n.value,h.value),l("✓ File downloaded successfully!","success"))},oe=(t,d)=>{if(n.value=t,h.value=d,d.endsWith(".csv")){if(t.byteLength<=8388608){const p=fe(t);f.value=p.headers,u.value=p.data;const H=(t.byteLength/1024).toFixed(2);l(`✓ CSV file decrypted (${H} KB) - Preview shown`,"success")}else{X(t,d);const p=(t.byteLength/(1024*1024)).toFixed(2);l(`✓ CSV file decrypted (${p} MB) - Too large to preview, downloaded`,"info")}j();return}if(de(d,t)){const P=new TextDecoder().decode(t);g.value=P;const p=(t.byteLength/1024).toFixed(2);l(`✓ Text file decrypted (${p} KB) - Preview shown`,"success"),j();return}if(X(t,d),t.byteLength>8388608){const P=(t.byteLength/1048576).toFixed(2);l(`✓ File decrypted (${P} MB) - Too large to preview, downloaded`,"info")}else l("✓ File decrypted and downloaded!","success");j()},ae=t=>{try{const d=new TextDecoder().decode(t);e.value=d,l("✓ Text decrypted successfully!","success")}catch(d){console.error("Text decode error:",d),m.value="Failed to decode decrypted data",l("❌ Decryption failed","error")}},se=()=>{},ne=async()=>{await _(e.value,t=>l(t,"success"),t=>l(t,"error"))},re=async()=>{await F((t,d)=>{x.value=t,l(d,"success"),R()},t=>l(t,"error"))},le=()=>{e.value="",m.value="",R()},{cancel:ce,debounce:R}=xe(()=>{k.value&&c.value&&$()},800),de=(t,d)=>{const p=[".txt",".md",".json",".xml",".html",".css",".js",".log",".yaml",".yml"].some(ie=>t.toLowerCase().endsWith(ie)),H=d.byteLength<=8388608;return p&&H};return O(b,t=>{t&&(Z.value||h.value)&&N()}),O(T,t=>{t&&v.value&&w(v.value)}),O(v,(t,d)=>{T.value&&t&&w(t),t&&t!==d&&(Z.value||h.value)&&N(),c.value&&(e.value="",m.value="",R())}),{decryptedFileName:h,decryptedText:e,encryptedFile:b,encryptedText:x,error:m,isLoading:U,password:v,plainText:g,tableData:u,tableHeaders:f,rememberPassword:T,isPasswordRemembered:W,clearSessionPassword:z,snackbar:I,snackbarColor:B,snackbarText:L,canDecrypt:k,isEncryptedTextPopulated:c,isFilePopulated:K,isPasswordPopulated:q,clearEncryptedText:G,clearOutputs:N,decryptFile:ee,downloadDecryptedText:te,handleCopy:ne,handleEncryptedTextChange:le,handleFileValidation:se,handlePaste:re}}},De=a("p",{class:"mb-2"},[a("strong",null,"AES decryption"),r(" reverses the encryption process, converting encrypted data back to its original form using the same password that was used for encryption. ")],-1),Fe=a("ul",{class:"ml-4 mb-2"},[a("li",null,[a("strong",null,"Password required"),r(" - You must use the EXACT same password that was used to encrypt the data")]),a("li",null,[a("strong",null,"Case-sensitive"),r(' - "Password123" and "password123" are different passwords')]),a("li",null,[a("strong",null,"No recovery"),r(" - If you forgot the password, the data cannot be decrypted")]),a("li",null,[a("strong",null,"Secure process"),r(" - Decryption happens entirely in your browser, nothing is sent to any server")])],-1),Ve=a("p",{class:"mt-3 mb-2"},[a("strong",null,"Common use cases:"),r(" Decrypting files from cloud storage, accessing encrypted backups, retrieving protected documents. ")],-1),Ae=a("div",{class:"text-caption text-medium-emphasis mt-3"},[a("strong",null,"Learn more:"),a("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),r(" • "),a("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard ")],-1),Ie=a("div",{class:"text-caption text-medium-emphasis mt-2"},[a("strong",null,"Technical:"),r(" Uses "),a("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"jsAesCrypt"),r(" with "),a("a",{href:"https://cryptojs.gitbook.io/docs/",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"CryptoJS"),r(" for AES-256-CBC decryption. Compatible with files encrypted using this tool. ")],-1),Be=a("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Le={class:"d-flex align-start"},We={class:"flex-grow-1"},ze=a("div",{class:"text-h6 font-weight-medium mb-2"},"Decryption Failed",-1),Me={class:"text-body-1"},Ue={class:"flex-grow-1"},je=a("div",{class:"text-subtitle-1 font-weight-medium"},"File Decrypted Successfully",-1),Ne={class:"text-body-2"},Re=a("p",{class:"text-h6 mt-4"},"Decrypting...",-1);function He(Y,n,h,e,b,x){const m=i("ToolPageHeader"),v=i("EducationalAlert"),g=i("LearnMorePanel"),u=i("v-icon"),f=i("v-card-title"),I=i("PasswordInput"),B=i("v-checkbox"),L=i("v-chip"),l=i("v-card-text"),_=i("v-card"),F=i("TextInputWithActions"),T=i("v-divider"),W=i("FileUploadWithValidation"),w=i("v-btn"),z=i("v-spacer"),M=i("v-textarea"),V=i("CsvPreviewTable"),A=i("SharedSnackbar"),U=i("v-progress-circular"),k=i("v-overlay");return C(),me("div",null,[o(m,{icon:"mdi-lock-open",title:"AES Decryption",description:"Decrypt password-protected AES encrypted files and text","avatar-color":"primary-darken-1"}),o(g,{title:"How Does AES Decryption Work?","storage-key":"slurm-help-aes-decrypt"},{default:s(()=>[De,Fe,o(v,{title:"Password Must Match Exactly",type:"warning",spacing:"mt-3"},{default:s(()=>[r(' The decryption password must be identical to the encryption password. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),Ve,Ae,Ie]),_:1}),a("form",{onSubmit:n[5]||(n[5]=ve((...c)=>e.decryptFile&&e.decryptFile(...c),["prevent"]))},[Be,o(_,{class:"mb-4"},{default:s(()=>[o(f,{class:"bg-surface-variant"},{default:s(()=>[o(u,{icon:"mdi-key",class:"mr-2"}),r(" Enter Password ")]),_:1}),o(l,{class:"pa-4"},{default:s(()=>[o(I,{password:e.password,"onUpdate:password":n[0]||(n[0]=c=>e.password=c),"require-confirmation":!1,"show-strength":!0,"show-requirements":!1,"show-feedback":!1,autocomplete:"current-password","password-label":"Decryption Password","password-placeholder":"Enter the password used for encryption","password-icon":"mdi-lock-open"},null,8,["password"]),o(B,{modelValue:e.rememberPassword,"onUpdate:modelValue":n[1]||(n[1]=c=>e.rememberPassword=c),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),e.isPasswordRemembered?(C(),S(L,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":e.clearSessionPassword,class:"mt-2"},{default:s(()=>[r(" Password remembered for session ")]),_:1},8,["onClick:close"])):E("",!0)]),_:1})]),_:1}),o(_,{class:"mb-4"},{default:s(()=>[o(f,{class:"bg-surface-variant"},{default:s(()=>[o(u,{icon:"mdi-lock",class:"mr-2"}),r(" Encrypted Text ")]),_:1}),o(l,{class:"pa-4"},{default:s(()=>[o(F,{modelValue:e.encryptedText,"onUpdate:modelValue":n[2]||(n[2]=c=>e.encryptedText=c),label:"Paste encrypted Base64 text",placeholder:"Paste the encrypted text here...",rows:4,disabled:e.isFilePopulated,"show-paste":!e.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"encrypted-text-input",onPaste:e.handlePaste,onClear:e.clearEncryptedText,onInput:e.handleEncryptedTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),o(T,{class:"my-4"}),o(F,{modelValue:e.decryptedText,"onUpdate:modelValue":n[3]||(n[3]=c=>e.decryptedText=c),label:"Decrypted Text",placeholder:"Decrypted output will appear here...",rows:4,"is-loading":e.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:e.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),o(_,{class:"mb-4"},{default:s(()=>[o(f,{class:"bg-surface-variant"},{default:s(()=>[o(u,{icon:"mdi-file-lock",class:"mr-2"}),r(" Encrypted File ")]),_:1}),o(l,{class:"pa-4"},{default:s(()=>[o(W,{modelValue:e.encryptedFile,"onUpdate:modelValue":n[4]||(n[4]=c=>e.encryptedFile=c),label:"Select encrypted file (.aes)",accept:".aes","button-text":"Decrypt","button-icon":"mdi-lock-open",disabled:e.isEncryptedTextPopulated,"can-submit":e.canDecrypt,onSubmit:e.decryptFile,onValidationChange:e.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1})],32),e.error?(C(),S(_,{key:0,variant:"tonal",color:"error",class:"mb-4"},{default:s(()=>[o(l,{class:"pa-4"},{default:s(()=>[a("div",Le,[o(u,{icon:"mdi-alert-circle",size:"32",color:"error",class:"mr-4 mt-1"}),a("div",We,[ze,a("div",Me,J(e.error),1)]),o(w,{icon:"",size:"small",variant:"text",onClick:n[6]||(n[6]=c=>e.error=""),class:"ml-2"},{default:s(()=>[o(u,null,{default:s(()=>[r("mdi-close")]),_:1})]),_:1})])]),_:1})]),_:1})):E("",!0),e.plainText?(C(),S(_,{key:1,variant:"tonal",class:"mb-4"},{default:s(()=>[o(f,{class:"d-flex align-center","data-testid":"file-info"},{default:s(()=>[o(u,{icon:"mdi-text",class:"mr-2"}),r(" Decrypted Text "),o(z),e.decryptedFileName?(C(),S(w,{key:0,variant:"text",color:"primary",onClick:e.downloadDecryptedText,class:"mr-2"},{default:s(()=>[o(u,{start:""},{default:s(()=>[r("mdi-download")]),_:1}),r(" Download ")]),_:1},8,["onClick"])):E("",!0),o(w,{icon:"",size:"small",variant:"text",onClick:e.clearOutputs},{default:s(()=>[o(u,null,{default:s(()=>[r("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1}),o(l,{class:"pa-4"},{default:s(()=>[o(M,{modelValue:e.plainText,"onUpdate:modelValue":n[7]||(n[7]=c=>e.plainText=c),variant:"outlined",rows:"10",readonly:"","bg-color":"grey-lighten-4",placeholder:"Decrypted text","data-testid":"file-preview","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})):E("",!0),o(V,{headers:e.tableHeaders,data:e.tableData,"show-download":!!e.decryptedFileName,"card-class":"mb-4","test-id":"file-preview",onClose:e.clearOutputs,onDownload:e.downloadDecryptedText},null,8,["headers","data","show-download","onClose","onDownload"]),e.decryptedFileName&&!e.plainText&&!e.tableData.length?(C(),S(_,{key:2,variant:"tonal",color:"success"},{default:s(()=>[o(l,{class:"d-flex align-center pa-4"},{default:s(()=>[o(u,{icon:"mdi-check-circle",size:"32",class:"mr-4"}),a("div",Ue,[je,a("div",Ne,J(e.decryptedFileName),1)]),o(w,{variant:"elevated",color:"white",onClick:e.downloadDecryptedText,class:"mr-2"},{default:s(()=>[o(u,{start:""},{default:s(()=>[r("mdi-download")]),_:1}),r(" Download Again ")]),_:1},8,["onClick"]),o(w,{icon:"",size:"small",variant:"text",onClick:e.clearOutputs},{default:s(()=>[o(u,null,{default:s(()=>[r("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})):E("",!0),o(A,{modelValue:e.snackbar,"onUpdate:modelValue":n[8]||(n[8]=c=>e.snackbar=c),text:e.snackbarText,color:e.snackbarColor},null,8,["modelValue","text","color"]),o(k,{"model-value":e.isLoading,class:"align-center justify-center"},{default:s(()=>[o(U,{indeterminate:"",size:"64",color:"primary"}),Re]),_:1},8,["model-value"])])}const tt=ue(Ee,[["render",He]]);export{tt as default};
