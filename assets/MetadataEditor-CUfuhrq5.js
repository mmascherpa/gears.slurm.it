import{d as At}from"./fileDownload-B1vhVzTR.js";import{F as Hi,f as Wi}from"./FileUpload-BDujieA5.js";import{y as Xi,_ as nt,r as j,b as se,f as E,w as u,d as S,o as T,a as d,e as k,g as B,c as oe,F as Ee,x as Re,t as N,i as O,p as rt,j as st,h as Ve,z as Ki,m as vi,n as Ji,l as Yi}from"./index-Be9HKwpV.js";import{T as qi,S as Qi,u as Zi}from"./ToolPageHeader-TgTx7KLi.js";import{C as $i}from"./CardSectionHeader-B739stJ-.js";function ea(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Nt={exports:{}};(function(a,e){(function(){var t={};t.version="1.0.4",t.remove=function(l){var c=!1;if(l.slice(0,2)!="ÿØ")if(l.slice(0,23)=="data:image/jpeg;base64,"||l.slice(0,22)=="data:image/jpg;base64,")l=F(l.split(",")[1]),c=!0;else throw new Error("Given data is not jpeg.");var f=K(l),g=f.filter(function(m){return!(m.slice(0,2)=="ÿá"&&m.slice(4,10)=="Exif\0\0")}),p=g.join("");return c&&(p="data:image/jpeg;base64,"+v(p)),p},t.insert=function(l,c){var f=!1;if(l.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(c.slice(0,2)!="ÿØ")if(c.slice(0,23)=="data:image/jpeg;base64,"||c.slice(0,22)=="data:image/jpg;base64,")c=F(c.split(",")[1]),f=!0;else throw new Error("Given data is not jpeg.");var g="ÿá"+C(">H",[l.length+2])+l,p=K(c),m=ne(p,g);return f&&(m="data:image/jpeg;base64,"+v(m)),m},t.load=function(l){var c;if(typeof l=="string")if(l.slice(0,2)=="ÿØ")c=l;else if(l.slice(0,23)=="data:image/jpeg;base64,"||l.slice(0,22)=="data:image/jpg;base64,")c=F(l.split(",")[1]);else if(l.slice(0,4)=="Exif")c=l.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var f={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},g=new b(c);if(g.tiftag===null)return f;g.tiftag.slice(0,2)=="II"?g.endian_mark="<":g.endian_mark=">";var p=P(g.endian_mark+"L",g.tiftag.slice(4,8))[0];f["0th"]=g.get_ifd(p,"0th");var m=f["0th"].first_ifd_pointer;if(delete f["0th"].first_ifd_pointer,34665 in f["0th"]&&(p=f["0th"][34665],f.Exif=g.get_ifd(p,"Exif")),34853 in f["0th"]&&(p=f["0th"][34853],f.GPS=g.get_ifd(p,"GPS")),40965 in f.Exif&&(p=f.Exif[40965],f.Interop=g.get_ifd(p,"Interop")),m!="\0\0\0\0"&&(p=P(g.endian_mark+"L",m)[0],f["1st"]=g.get_ifd(p,"1st"),513 in f["1st"]&&514 in f["1st"])){var _=f["1st"][513]+f["1st"][514],I=g.tiftag.slice(f["1st"][513],_);f.thumbnail=I}return f},t.dump=function(l){var c=8,f=i(l),g="Exif\0\0MM\0*\0\0\0\b",p=!1,m=!1,_=!1,I=!1,L,D,V,U,ye;"0th"in f?L=f["0th"]:L={},"Exif"in f&&Object.keys(f.Exif).length||"Interop"in f&&Object.keys(f.Interop).length?(L[34665]=1,p=!0,D=f.Exif,"Interop"in f&&Object.keys(f.Interop).length?(D[40965]=1,_=!0,V=f.Interop):Object.keys(D).indexOf(t.ExifIFD.InteroperabilityTag.toString())>-1&&delete D[40965]):Object.keys(L).indexOf(t.ImageIFD.ExifTag.toString())>-1&&delete L[34665],"GPS"in f&&Object.keys(f.GPS).length?(L[t.ImageIFD.GPSTag]=1,m=!0,U=f.GPS):Object.keys(L).indexOf(t.ImageIFD.GPSTag.toString())>-1&&delete L[t.ImageIFD.GPSTag],"1st"in f&&"thumbnail"in f&&f.thumbnail!=null&&(I=!0,f["1st"][513]=1,f["1st"][514]=1,ye=f["1st"]);var w=y(L,"0th",0),X=w[0].length+p*12+m*12+4+w[1].length,te,Ue="",fe=0,ke,He="",Ie=0,dt,We="",Xe=0,Se,x="",A;if(p&&(te=y(D,"Exif",X),fe=te[0].length+_*12+te[1].length),m&&(ke=y(U,"GPS",X+fe),He=ke.join(""),Ie=He.length),_){var M=X+fe+Ie;dt=y(V,"Interop",M),We=dt.join(""),Xe=We.length}if(I){var M=X+fe+Ie+Xe;if(Se=y(ye,"1st",M),A=n(f.thumbnail),A.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var W="",q="",de="",ue="\0\0\0\0";if(p){var ie=c+X,Ke=C(">L",[ie]),Je=34665,Ye=C(">H",[Je]),qe=C(">H",[z.Long]),Qe=C(">L",[1]);W=Ye+qe+Qe+Ke}if(m){var ie=c+X+fe,Ke=C(">L",[ie]),Je=34853,Ye=C(">H",[Je]),qe=C(">H",[z.Long]),Qe=C(">L",[1]);q=Ye+qe+Qe+Ke}if(_){var ie=c+X+fe+Ie,Ke=C(">L",[ie]),Je=40965,Ye=C(">H",[Je]),qe=C(">H",[z.Long]),Qe=C(">L",[1]);de=Ye+qe+Qe+Ke}if(I){var ie=c+X+fe+Ie+Xe;ue=C(">L",[ie]);var Bi=ie+Se[0].length+24+4+Se[1].length,Vi="\0\0\0\0"+C(">L",[Bi]),zi="\0\0\0\0"+C(">L",[A.length]);x=Se[0]+Vi+zi+"\0\0\0\0"+Se[1]+A}var ji=w[0]+W+q+ue+w[1];return p&&(Ue=te[0]+de+te[1]),g+ji+Ue+He+We+x};function i(l){return JSON.parse(JSON.stringify(l))}function n(l){for(var c=K(l);"ÿà"<=c[1].slice(0,2)&&c[1].slice(0,2)<="ÿï";)c=[c[0]].concat(c.slice(2));return c.join("")}function r(l){return C(">"+G("B",l.length),l)}function s(l){return C(">"+G("H",l.length),l)}function o(l){return C(">"+G("L",l.length),l)}function h(l,c,f){var g="",p="",m,_,I,L;if(c=="Byte")m=l.length,m<=4?p=r(l)+G("\0",4-m):(p=C(">L",[f]),g=r(l));else if(c=="Short")m=l.length,m<=2?p=s(l)+G("\0\0",2-m):(p=C(">L",[f]),g=s(l));else if(c=="Long")m=l.length,m<=1?p=o(l):(p=C(">L",[f]),g=o(l));else if(c=="Ascii")_=l+"\0",m=_.length,m>4?(p=C(">L",[f]),g=_):p=_+G("\0",4-m);else if(c=="Rational"){if(typeof l[0]=="number")m=1,I=l[0],L=l[1],_=C(">L",[I])+C(">L",[L]);else{m=l.length,_="";for(var D=0;D<m;D++)I=l[D][0],L=l[D][1],_+=C(">L",[I])+C(">L",[L])}p=C(">L",[f]),g=_}else if(c=="SRational"){if(typeof l[0]=="number")m=1,I=l[0],L=l[1],_=C(">l",[I])+C(">l",[L]);else{m=l.length,_="";for(var D=0;D<m;D++)I=l[D][0],L=l[D][1],_+=C(">l",[I])+C(">l",[L])}p=C(">L",[f]),g=_}else c=="Undefined"&&(m=l.length,m>4?(p=C(">L",[f]),g=l):p=l+G("\0",4-m));var V=C(">L",[m]);return[V,p,g]}function y(l,c,f){var g=8,p=Object.keys(l).length,m=C(">H",[p]),_;["0th","1st"].indexOf(c)>-1?_=2+p*12+4:_=2+p*12;var I="",L="",D;for(var D in l)if(typeof D=="string"&&(D=parseInt(D)),!(c=="0th"&&[34665,34853].indexOf(D)>-1)){{if(c=="Exif"&&D==40965)continue;if(c=="1st"&&[513,514].indexOf(D)>-1)continue}var V=l[D],U=C(">H",[D]),ye=Z[c][D].type,w=C(">H",[z[ye]]);typeof V=="number"&&(V=[V]);var X=g+_+f+L.length,te=h(V,ye,X),Ue=te[0],fe=te[1],ke=te[2];I+=U+w+Ue+fe,L+=ke}return[m+I,L]}function b(l){var c,f;if(l.slice(0,2)=="ÿØ")c=K(l),f=J(c),f?this.tiftag=f.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(l.slice(0,2))>-1)this.tiftag=l;else if(l.slice(0,4)=="Exif")this.tiftag=l.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(b.prototype={get_ifd:function(l,c){var f={},g=P(this.endian_mark+"H",this.tiftag.slice(l,l+2))[0],p=l+2,m;["0th","1st"].indexOf(c)>-1?m="Image":m=c;for(var _=0;_<g;_++){l=p+12*_;var I=P(this.endian_mark+"H",this.tiftag.slice(l,l+2))[0],L=P(this.endian_mark+"H",this.tiftag.slice(l+2,l+4))[0],D=P(this.endian_mark+"L",this.tiftag.slice(l+4,l+8))[0],V=this.tiftag.slice(l+8,l+12),U=[L,D,V];I in Z[m]&&(f[I]=this.convert_value(U))}return c=="0th"&&(l=p+12*g,f.first_ifd_pointer=this.tiftag.slice(l,l+4)),f},convert_value:function(l){var c=null,f=l[0],g=l[1],p=l[2],m;if(f==1)g>4?(m=P(this.endian_mark+"L",p)[0],c=P(this.endian_mark+G("B",g),this.tiftag.slice(m,m+g))):c=P(this.endian_mark+G("B",g),p.slice(0,g));else if(f==2)g>4?(m=P(this.endian_mark+"L",p)[0],c=this.tiftag.slice(m,m+g-1)):c=p.slice(0,g-1);else if(f==3)g>2?(m=P(this.endian_mark+"L",p)[0],c=P(this.endian_mark+G("H",g),this.tiftag.slice(m,m+g*2))):c=P(this.endian_mark+G("H",g),p.slice(0,g*2));else if(f==4)g>1?(m=P(this.endian_mark+"L",p)[0],c=P(this.endian_mark+G("L",g),this.tiftag.slice(m,m+g*4))):c=P(this.endian_mark+G("L",g),p);else if(f==5)if(m=P(this.endian_mark+"L",p)[0],g>1){c=[];for(var _=0;_<g;_++)c.push([P(this.endian_mark+"L",this.tiftag.slice(m+_*8,m+4+_*8))[0],P(this.endian_mark+"L",this.tiftag.slice(m+4+_*8,m+8+_*8))[0]])}else c=[P(this.endian_mark+"L",this.tiftag.slice(m,m+4))[0],P(this.endian_mark+"L",this.tiftag.slice(m+4,m+8))[0]];else if(f==7)g>4?(m=P(this.endian_mark+"L",p)[0],c=this.tiftag.slice(m,m+g)):c=p.slice(0,g);else if(f==9)g>1?(m=P(this.endian_mark+"L",p)[0],c=P(this.endian_mark+G("l",g),this.tiftag.slice(m,m+g*4))):c=P(this.endian_mark+G("l",g),p);else if(f==10)if(m=P(this.endian_mark+"L",p)[0],g>1){c=[];for(var _=0;_<g;_++)c.push([P(this.endian_mark+"l",this.tiftag.slice(m+_*8,m+4+_*8))[0],P(this.endian_mark+"l",this.tiftag.slice(m+4+_*8,m+8+_*8))[0]])}else c=[P(this.endian_mark+"l",this.tiftag.slice(m,m+4))[0],P(this.endian_mark+"l",this.tiftag.slice(m+4,m+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+f);return c instanceof Array&&c.length==1?c[0]:c}},typeof window<"u"&&typeof window.btoa=="function")var v=window.btoa;if(typeof v>"u")var v=function(c){for(var f="",g,p,m,_,I,L,D,V=0,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";V<c.length;)g=c.charCodeAt(V++),p=c.charCodeAt(V++),m=c.charCodeAt(V++),_=g>>2,I=(g&3)<<4|p>>4,L=(p&15)<<2|m>>6,D=m&63,isNaN(p)?L=D=64:isNaN(m)&&(D=64),f=f+U.charAt(_)+U.charAt(I)+U.charAt(L)+U.charAt(D);return f};if(typeof window<"u"&&typeof window.atob=="function")var F=window.atob;if(typeof F>"u")var F=function(c){var f="",g,p,m,_,I,L,D,V=0,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");V<c.length;)_=U.indexOf(c.charAt(V++)),I=U.indexOf(c.charAt(V++)),L=U.indexOf(c.charAt(V++)),D=U.indexOf(c.charAt(V++)),g=_<<2|I>>4,p=(I&15)<<4|L>>2,m=(L&3)<<6|D,f=f+String.fromCharCode(g),L!=64&&(f=f+String.fromCharCode(p)),D!=64&&(f=f+String.fromCharCode(m));return f};function C(l,c){if(!(c instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(l.length-1!=c.length)throw new Error("'pack' error. "+(l.length-1)+" marks, "+c.length+" elements.");var f;if(l[0]=="<")f=!0;else if(l[0]==">")f=!1;else throw new Error("");for(var g="",p=1,m=null,_=null,I=null;_=l[p];){if(_.toLowerCase()=="b"){if(m=c[p-1],_=="b"&&m<0&&(m+=256),m>255||m<0)throw new Error("'pack' error.");I=String.fromCharCode(m)}else if(_=="H"){if(m=c[p-1],m>65535||m<0)throw new Error("'pack' error.");I=String.fromCharCode(Math.floor(m%65536/256))+String.fromCharCode(m%256),f&&(I=I.split("").reverse().join(""))}else if(_.toLowerCase()=="l"){if(m=c[p-1],_=="l"&&m<0&&(m+=4294967296),m>4294967295||m<0)throw new Error("'pack' error.");I=String.fromCharCode(Math.floor(m/16777216))+String.fromCharCode(Math.floor(m%16777216/65536))+String.fromCharCode(Math.floor(m%65536/256))+String.fromCharCode(m%256),f&&(I=I.split("").reverse().join(""))}else throw new Error("'pack' error.");g+=I,p+=1}return g}function P(l,c){if(typeof c!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var f=0,g=1;g<l.length;g++)if(l[g].toLowerCase()=="b")f+=1;else if(l[g].toLowerCase()=="h")f+=2;else if(l[g].toLowerCase()=="l")f+=4;else throw new Error("'unpack' error. Got invalid mark.");if(f!=c.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+f+":"+c.length);var p;if(l[0]=="<")p=!0;else if(l[0]==">")p=!1;else throw new Error("'unpack' error.");for(var m=[],_=0,I=1,L=null,D=null,V=null,U="";D=l[I];){if(D.toLowerCase()=="b")V=1,U=c.slice(_,_+V),L=U.charCodeAt(0),D=="b"&&L>=128&&(L-=256);else if(D=="H")V=2,U=c.slice(_,_+V),p&&(U=U.split("").reverse().join("")),L=U.charCodeAt(0)*256+U.charCodeAt(1);else if(D.toLowerCase()=="l")V=4,U=c.slice(_,_+V),p&&(U=U.split("").reverse().join("")),L=U.charCodeAt(0)*16777216+U.charCodeAt(1)*65536+U.charCodeAt(2)*256+U.charCodeAt(3),D=="l"&&L>=2147483648&&(L-=4294967296);else throw new Error("'unpack' error. "+D);m.push(L),_+=V,I+=1}return m}function G(l,c){for(var f="",g=0;g<c;g++)f+=l;return f}function K(l){if(l.slice(0,2)!="ÿØ")throw new Error("Given data isn't JPEG.");for(var c=2,f=["ÿØ"];;){if(l.slice(c,c+2)=="ÿÚ"){f.push(l.slice(c));break}else{var g=P(">H",l.slice(c+2,c+4))[0],p=c+g+2;f.push(l.slice(c,p)),c=p}if(c>=l.length)throw new Error("Wrong JPEG data.")}return f}function J(l){for(var c,f=0;f<l.length;f++)if(c=l[f],c.slice(0,2)=="ÿá"&&c.slice(4,10)=="Exif\0\0")return c;return null}function ne(l,c){var f=!1,g=[];return l.forEach(function(p,m){p.slice(0,2)=="ÿá"&&p.slice(4,10)=="Exif\0\0"&&(f?g.unshift(m):(l[m]=c,f=!0))}),g.forEach(function(p){l.splice(p,1)}),!f&&c&&(l=[l[0],c].concat(l.slice(1))),l.join("")}var z={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},Z={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};Z["0th"]=Z.Image,Z["1st"]=Z.Image,t.TAGS=Z,t.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},t.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},t.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},t.InteropIFD={InteroperabilityIndex:1},t.GPSHelper={degToDmsRational:function(l){var c=Math.abs(l),f=c%1*60,g=f%1*60,p=Math.floor(c),m=Math.floor(f),_=Math.round(g*100);return[[p,1],[m,1],[_,100]]},dmsRationalToDeg:function(l,c){var f=c==="S"||c==="W"?-1:1,g=l[0][0]/l[0][1]+l[1][0]/l[1][1]/60+l[2][0]/l[2][1]/3600;return g*f}},a.exports&&(e=a.exports=t),e.piexif=t})()})(Nt,Nt.exports);var ta=Nt.exports;const ce=ea(ta),bi={"0th.271":{label:"Camera Make",section:"Camera",editable:!0,type:"string"},"0th.272":{label:"Camera Model",section:"Camera",editable:!0,type:"string"},"Exif.42033":{label:"Serial Number",section:"Camera",editable:!0,type:"string"},"Exif.42034":{label:"Lens Make",section:"Camera",editable:!0,type:"string"},"Exif.42035":{label:"Lens Serial Number",section:"Camera",editable:!0,type:"string"},"Exif.42036":{label:"Lens Model",section:"Camera",editable:!0,type:"string"},"0th.274":{label:"Orientation",section:"Camera",editable:!0,type:"number",editWarning:"Changing orientation may not rotate the image visually. Use image editing software for rotation."},"0th.282":{label:"X Resolution",section:"Camera",editable:!0,type:"rational",editWarning:"Changing resolution metadata does not resize the image. Only metadata will be updated."},"0th.283":{label:"Y Resolution",section:"Camera",editable:!0,type:"rational",editWarning:"Changing resolution metadata does not resize the image. Only metadata will be updated."},"0th.296":{label:"Resolution Unit",section:"Camera",editable:!0,type:"number"},"GPS.0":{label:"GPS Version ID",section:"Location",editable:!0,type:"array"},"GPS.1":{label:"GPS Latitude Ref",section:"Location",editable:!0,type:"string"},"GPS.2":{label:"GPS Latitude",section:"Location",editable:!0,type:"gps"},"GPS.3":{label:"GPS Longitude Ref",section:"Location",editable:!0,type:"string"},"GPS.4":{label:"GPS Longitude",section:"Location",editable:!0,type:"gps"},"GPS.5":{label:"GPS Altitude Ref",section:"Location",editable:!0,type:"number"},"GPS.6":{label:"GPS Altitude",section:"Location",editable:!0,type:"rational"},"GPS.7":{label:"GPS Timestamp",section:"Location",editable:!0,type:"array"},"GPS.8":{label:"GPS Satellites",section:"Location",editable:!0,type:"string"},"GPS.9":{label:"GPS Status",section:"Location",editable:!0,type:"string"},"GPS.10":{label:"GPS Measure Mode",section:"Location",editable:!0,type:"string"},"GPS.11":{label:"GPS DOP",section:"Location",editable:!0,type:"rational"},"GPS.12":{label:"GPS Speed Ref",section:"Location",editable:!0,type:"string"},"GPS.13":{label:"GPS Speed",section:"Location",editable:!0,type:"rational"},"GPS.14":{label:"GPS Track Ref",section:"Location",editable:!0,type:"string"},"GPS.15":{label:"GPS Track",section:"Location",editable:!0,type:"rational"},"GPS.16":{label:"GPS Image Direction Ref",section:"Location",editable:!0,type:"string"},"GPS.17":{label:"GPS Image Direction",section:"Location",editable:!0,type:"rational"},"GPS.18":{label:"GPS Map Datum",section:"Location",editable:!0,type:"string"},"GPS.29":{label:"GPS Date",section:"Location",editable:!0,type:"string"},"Exif.36867":{label:"Date Taken (Original)",section:"Timestamps",editable:!0,type:"datetime"},"Exif.36868":{label:"Date Digitized",section:"Timestamps",editable:!0,type:"datetime"},"0th.306":{label:"Date Modified",section:"Timestamps",editable:!0,type:"datetime"},"Exif.37520":{label:"Subsec Time",section:"Timestamps",editable:!0,type:"string"},"Exif.37521":{label:"Subsec Time Original",section:"Timestamps",editable:!0,type:"string"},"Exif.37522":{label:"Subsec Time Digitized",section:"Timestamps",editable:!0,type:"string"},"0th.315":{label:"Author",section:"Author",editable:!0,type:"string"},"0th.33432":{label:"Copyright",section:"Author",editable:!0,type:"string"},"Exif.34855":{label:"ISO Speed",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual ISO used when the photo was taken. Editing creates incorrect metadata."},"Exif.34856":{label:"ISO Speed Ratings",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual ISO used. Editing creates incorrect metadata."},"Exif.33434":{label:"Exposure Time",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual shutter speed used. Editing creates incorrect technical metadata."},"Exif.33437":{label:"F-Number",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual aperture used. Editing creates incorrect technical metadata."},"Exif.37377":{label:"Shutter Speed",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual shutter speed used. Editing creates incorrect technical metadata."},"Exif.37378":{label:"Aperture",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual aperture used. Editing creates incorrect technical metadata."},"Exif.37379":{label:"Brightness Value",section:"Technical",editable:!0,type:"rational"},"Exif.37380":{label:"Exposure Bias",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual exposure compensation used. Editing creates incorrect metadata."},"Exif.37381":{label:"Max Aperture Value",section:"Technical",editable:!0,type:"rational"},"Exif.37382":{label:"Subject Distance",section:"Technical",editable:!0,type:"rational"},"Exif.37383":{label:"Metering Mode",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual metering mode used. Editing creates incorrect technical metadata."},"Exif.37384":{label:"Light Source",section:"Technical",editable:!0,type:"number"},"Exif.37385":{label:"Flash",section:"Technical",editable:!0,type:"number",editWarning:"This reflects whether flash was actually used. Editing creates incorrect metadata."},"Exif.37386":{label:"Focal Length",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual focal length used. Editing creates incorrect technical metadata."},"Exif.41486":{label:"Focal Length (35mm)",section:"Technical",editable:!0,type:"number",editWarning:"This is the calculated 35mm equivalent. Editing creates incorrect metadata."},"Exif.41989":{label:"Focal Length in 35mm Film",section:"Technical",editable:!0,type:"number",editWarning:"This is the calculated 35mm equivalent. Editing creates incorrect metadata."},"Exif.40962":{label:"Image Width",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"Exif.40963":{label:"Image Height",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"0th.256":{label:"Image Width",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"0th.257":{label:"Image Height",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"Exif.34850":{label:"Exposure Program",section:"Technical",editable:!0,type:"number"},"Exif.37396":{label:"Subject Area",section:"Technical",editable:!0,type:"array"},"Exif.41483":{label:"Flash Energy",section:"Technical",editable:!0,type:"rational"},"Exif.41495":{label:"Sensing Method",section:"Technical",editable:!0,type:"number"},"Exif.41728":{label:"File Source",section:"Technical",editable:!0,type:"number"},"Exif.41729":{label:"Scene Type",section:"Technical",editable:!0,type:"number"},"Exif.41985":{label:"Custom Rendered",section:"Technical",editable:!0,type:"number"},"Exif.41986":{label:"Exposure Mode",section:"Technical",editable:!0,type:"number"},"Exif.41987":{label:"White Balance",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual white balance used. Editing creates incorrect metadata."},"Exif.41988":{label:"Digital Zoom Ratio",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual digital zoom used. Editing creates incorrect metadata."},"Exif.41990":{label:"Scene Capture Type",section:"Technical",editable:!0,type:"number"},"Exif.41991":{label:"Gain Control",section:"Technical",editable:!0,type:"number"},"Exif.41992":{label:"Contrast",section:"Technical",editable:!0,type:"number"},"Exif.41993":{label:"Saturation",section:"Technical",editable:!0,type:"number"},"Exif.41994":{label:"Sharpness",section:"Technical",editable:!0,type:"number"},"Exif.41996":{label:"Subject Distance Range",section:"Technical",editable:!0,type:"number"},"Exif.42240":{label:"Gamma",section:"Technical",editable:!0,type:"rational"},"0th.305":{label:"Software",section:"Technical",editable:!0,type:"string"},"Exif.40960":{label:"EXIF Version",section:"Technical",editable:!0,type:"string"},"Exif.40961":{label:"Color Space",section:"Technical",editable:!0,type:"number"},"0th.258":{label:"Bits Per Sample",section:"Technical",editable:!0,type:"array"},"0th.259":{label:"Compression",section:"Technical",editable:!0,type:"number"},"0th.262":{label:"Photometric Interpretation",section:"Technical",editable:!0,type:"number"},"0th.277":{label:"Samples Per Pixel",section:"Technical",editable:!0,type:"number"},"0th.284":{label:"Planar Configuration",section:"Technical",editable:!0,type:"number"},"0th.530":{label:"YCbCr SubSampling",section:"Technical",editable:!0,type:"array"},"0th.531":{label:"YCbCr Positioning",section:"Technical",editable:!0,type:"number"},"Exif.37510":{label:"User Comment",section:"Hidden",steganography:!0,editable:!0,type:"string"},"0th.270":{label:"Image Description",section:"Hidden",steganography:!0,editable:!0,type:"string"},"Exif.42016":{label:"Image Unique ID",section:"Hidden",editable:!0,type:"string"}},Te={Camera:{name:"Camera Information",icon:"mdi-camera",color:"primary",description:"Camera make, model, and lens information"},Location:{name:"Location (GPS)",icon:"mdi-map-marker",color:"info",description:"GPS coordinates and location data"},Timestamps:{name:"Timestamps",icon:"mdi-clock",color:"info",description:"When the photo was taken and modified"},Author:{name:"Copyright & Author",icon:"mdi-copyright",color:"secondary",description:"Copyright and authorship information"},Technical:{name:"Technical Details",icon:"mdi-cog",color:"grey",description:"Camera settings and image properties"},Hidden:{name:"Hidden Data",icon:"mdi-incognito",color:"warning",description:"User comments and custom fields"}};function ia(a,e){const t=`${a}.${e}`;return bi[t]||null}function aa(){return Object.entries(bi).map(([a,e])=>{const[t,i]=a.split(".");return{key:a,ifd:t,tagId:parseInt(i),...e}})}function na(){const a={};return Object.keys(Te).forEach(e=>{a[e]=[]}),aa().forEach(e=>{a[e.section]&&a[e.section].push(e)}),a}function Ci(a,e){if(!e)return{valid:!0,warning:null};const t=String(a).trim();switch(e){case"string":return{valid:!0,warning:null};case"number":return isNaN(Number(t))?{valid:!1,warning:`Expected a number, but got "${t}". This may cause errors.`}:{valid:!0,warning:null};case"rational":if(t.includes("/")){const r=t.split("/");if(r.length!==2||isNaN(Number(r[0]))||isNaN(Number(r[1])))return{valid:!1,warning:`Expected a fraction like "1/125" or decimal number, but got "${t}".`}}else if(isNaN(Number(t)))return{valid:!1,warning:`Expected a number or fraction (e.g., "1/125"), but got "${t}".`};return{valid:!0,warning:null};case"datetime":return/^\d{4}:\d{2}:\d{2} \d{2}:\d{2}:\d{2}$/.test(t)?{valid:!0,warning:null}:{valid:!1,warning:`Expected datetime format "YYYY:MM:DD HH:MM:SS", but got "${t}".`};case"gps":const n=parseFloat(t);return isNaN(n)?{valid:!1,warning:`Expected GPS coordinate as decimal degrees (e.g., "37.7749"), but got "${t}".`}:n<-180||n>180?{valid:!1,warning:`GPS coordinate "${t}" is out of range (-180 to 180).`}:{valid:!0,warning:null};case"array":return{valid:!0,warning:"Array values are complex. Ensure format matches the original value structure."};default:return{valid:!0,warning:null}}}function Zt(a,e,t){if(a==null)return"N/A";if(Array.isArray(a)){if(e==="GPS"&&(t===2||t===4))try{const[i,n,r]=a,s=Array.isArray(i)?i[0]/(i[1]||1):i,o=Array.isArray(n)?n[0]/(n[1]||1):n,h=Array.isArray(r)?r[0]/(r[1]||1):r;return typeof s!="number"||typeof o!="number"||typeof h!="number"||isNaN(s)||isNaN(o)||isNaN(h)?a.join(", "):`${(s+o/60+h/3600).toFixed(6)}°`}catch{return a.join(", ")}return e==="GPS"&&t===6?Array.isArray(a)&&a.length>=1?`${Array.isArray(a[0])?a[0][0]/(a[0][1]||1):a[0]} m`:a.join(", "):e==="Exif"&&t===33434?Array.isArray(a)&&a.length>=2&&typeof a[0]=="number"&&typeof a[1]=="number"?a[1]?`1/${a[1]} s`:`${a[0]} s`:a.join(", "):e==="Exif"&&t===33437&&Array.isArray(a)&&a.length>=2&&typeof a[0]=="number"&&typeof a[1]=="number"&&a[1]!==0?`f/${(a[0]/a[1]).toFixed(1)}`:a.join(", ")}if(a instanceof Uint8Array||a instanceof ArrayBuffer){const i=new TextDecoder("utf-8",{fatal:!1});try{return i.decode(a)}catch{return"[Binary Data]"}}return typeof a=="string"?a.trim():typeof a=="number"?a.toString():String(a)}async function ra(a){try{const e=a.includes(",")?a.split(",")[1]:a,t=ce.load("data:image/jpeg;base64,"+e);return sa(t)}catch(e){throw e.message&&e.message.includes("not a valid JPEG")?new Error("Image does not contain EXIF data or is not a valid JPEG"):new Error(`Failed to load EXIF data: ${e.message||"Unknown error"}`)}}function sa(a,e=!0){const t={};if(Object.keys(Te).forEach(i=>{t[i]={name:Te[i].name,icon:Te[i].icon,color:Te[i].color,description:Te[i].description,warning:Te[i].warning||!1,fields:[]}}),e){const i=na();Object.entries(i).forEach(([n,r])=>{t[n]&&r.forEach(s=>{let o=null,h=null,y=!1;a[s.ifd]&&a[s.ifd][s.tagId]!==void 0&&a[s.ifd][s.tagId]!==null&&(h=a[s.ifd][s.tagId],o=Zt(h,s.ifd,s.tagId),y=!0),t[n].fields.push({label:s.label,key:s.key,ifd:s.ifd,tagId:s.tagId,value:o||"",rawValue:h,editable:s.editable,warning:s.warning||!1,editWarning:s.editWarning||null,icon:s.icon,type:s.type,isPopulated:y})})})}else for(const[i,n]of Object.entries(a))if(!(i==="thumbnail"||typeof n!="object"||n===null))for(const[r,s]of Object.entries(n)){if(s==null)continue;const o=ia(i,parseInt(r));if(o){const h=t[o.section];h&&h.fields.push({label:o.label,key:`${i}.${r}`,ifd:i,tagId:parseInt(r),value:Zt(s,i,parseInt(r)),rawValue:s,editable:o.editable,warning:o.warning||!1,editWarning:o.editWarning||null,icon:o.icon,type:o.type,isPopulated:!0})}}return t}async function oa(a){try{const e=a.includes(",")?a.split(",")[1]:a;return ce.remove("data:image/jpeg;base64,"+e).split(",")[1]}catch(e){throw new Error(`Failed to remove metadata: ${e.message||"Unknown error"}`)}}function la(a){return a.Location&&a.Location.fields.length>0}function ca(a){return Object.values(a).reduce((e,t)=>e+t.fields.length,0)}function da(a){const e=ca(a),t=la(a),i=Object.keys(a).length,n=Object.values(a).reduce((o,h)=>o+h.fields.filter(y=>y.editable).length,0),r=Object.values(a).reduce((o,h)=>o+h.fields.filter(y=>y.warning).length,0),s=Object.values(a).reduce((o,h)=>o+h.fields.filter(y=>y.isPopulated).length,0);return{totalFields:e,populatedFields:s,sections:i,editableFields:n,privacyFields:r,hasGPS:t,hasCameraInfo:!!a.Camera,hasTimestamps:!!a.Timestamps,hasAuthorInfo:!!a.Author}}function ua(a){return new Promise((e,t)=>{const i=new FileReader;i.onload=n=>{e(n.target.result)},i.onerror=n=>{t(new Error(`Failed to read file: ${n.message||"Unknown error"}`))},i.readAsDataURL(a)})}function Ft(a,e="image/jpeg"){const t=a.includes(",")?a.split(",")[1]:a,i=atob(t),n=new Uint8Array(i.length);for(let r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return new Blob([n],{type:e})}async function fa(a,e,t){try{const i=a.includes(",")?a.split(",")[1]:a,n=ce.load("data:image/jpeg;base64,"+i),r=ma(t,e.ifd,e.tagId,e.rawValue);n[e.ifd]||(n[e.ifd]={}),n[e.ifd][e.tagId]=r;const s=ce.dump(n);return ce.insert(s,"data:image/jpeg;base64,"+i).split(",")[1]}catch(i){throw new Error(`Failed to edit metadata field: ${i.message||"Unknown error"}`)}}async function ha(a,e){try{const t=a.includes(",")?a.split(",")[1]:a,i=ce.load("data:image/jpeg;base64,"+t);i[e.ifd]&&i[e.ifd][e.tagId]&&delete i[e.ifd][e.tagId];const n=ce.dump(i);return ce.insert(n,"data:image/jpeg;base64,"+t).split(",")[1]}catch(t){throw new Error(`Failed to remove metadata field: ${t.message||"Unknown error"}`)}}function ma(a,e,t,i){if(typeof i=="string")return String(a);if(typeof i=="number")return Number(a);if(Array.isArray(i)){if(e==="GPS"&&(t===7||t===29))return a;if(e==="Exif"&&(t===33434||t===33437)){if(typeof a=="string"&&a.includes("/")){const[n,r]=a.split("/").map(s=>parseInt(s.trim()));return[n,r]}return i}if(e==="GPS"&&(t===2||t===4)){if(typeof a=="string"||typeof a=="number"){const n=parseFloat(a);if(!isNaN(n)){const r=Math.floor(Math.abs(n)),s=Math.floor((Math.abs(n)-r)*60),o=(Math.abs(n)-r-s/60)*3600;return[r,s,o]}}return i}return i}return String(a)}async function pa(a){try{const e=a.includes(",")?a.split(",")[1]:a,t=ce.load("data:image/jpeg;base64,"+e),i={"0th":{},Exif:{},GPS:{},"1st":{},Interop:{}},n=ce.dump(i);return ce.insert(n,"data:image/jpeg;base64,"+e).split(",")[1]}catch(e){throw new Error(`Failed to clear metadata: ${e.message||"Unknown error"}`)}}async function ga(a,e,t,i,n){try{const r=a.includes(",")?a.split(",")[1]:a,s=ce.load("data:image/jpeg;base64,"+r);let o;switch(n){case"number":if(o=parseInt(i),isNaN(o))throw new Error("Invalid number value");break;case"rational":if(i.includes("/")){const[b,v]=i.split("/").map(F=>parseInt(F.trim()));if(isNaN(b)||isNaN(v))throw new Error("Invalid rational value");o=[b,v]}else{const b=parseFloat(i);if(isNaN(b))throw new Error("Invalid rational value");o=[Math.round(b*100),100]}break;case"array":o=i.split(",").map(b=>{const v=parseInt(b.trim());return isNaN(v)?b.trim():v});break;case"string":case"datetime":default:o=String(i);break}s[e]||(s[e]={}),s[e][t]=o;const h=ce.dump(s);return ce.insert(h,"data:image/jpeg;base64,"+r).split(",")[1]}catch(r){throw new Error(`Failed to add custom field: ${r.message||"Unknown error"}`)}}var bt=typeof self<"u"?self:global;const at=typeof navigator<"u",ya=at&&typeof HTMLImageElement>"u",pt=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Ct=bt.Buffer,ut=bt.BigInt,Pt=!!Ct,Sa=a=>a;function gt(a,e=Sa){if(pt)try{return typeof require=="function"?Promise.resolve(e(require(a))):Xi(()=>import(a),__vite__mapDeps([])).then(e)}catch{console.warn(`Couldn't load ${a}`)}}let Ht=bt.fetch;const va=a=>Ht=a;if(!bt.fetch){const a=gt("http",i=>i),e=gt("https",i=>i),t=(i,{headers:n}={})=>new Promise(async(r,s)=>{let{port:o,hostname:h,pathname:y,protocol:b,search:v}=new URL(i);const F={method:"GET",hostname:h,path:encodeURI(y)+v,headers:n};o!==""&&(F.port=Number(o));const C=(b==="https:"?await e:await a).request(F,P=>{if(P.statusCode===301||P.statusCode===302){let G=new URL(P.headers.location,i).toString();return t(G,{headers:n}).then(r).catch(s)}r({status:P.statusCode,arrayBuffer:()=>new Promise(G=>{let K=[];P.on("data",J=>K.push(J)),P.on("end",()=>G(Buffer.concat(K)))})})});C.on("error",s),C.end()});va(t)}function R(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}const yt=a=>Pi(a)?void 0:a,ba=a=>a!==void 0;function Pi(a){return a===void 0||(a instanceof Map?a.size===0:Object.values(a).filter(ba).length===0)}function ee(a){let e=new Error(a);throw delete e.stack,e}function Ae(a){return(a=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(a).trim())===""?void 0:a}function Ut(a){let e=function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048}(a);return a.jfif.enabled&&(e+=50),a.xmp.enabled&&(e+=2e4),a.iptc.enabled&&(e+=14e3),a.icc.enabled&&(e+=6e3),e}const Bt=a=>String.fromCharCode.apply(null,a),$t=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function xi(a){return $t?$t.decode(a):Pt?Buffer.from(a).toString("utf8"):decodeURIComponent(escape(Bt(a)))}class le{static from(e,t){return e instanceof this&&e.le===t?e:new le(e,void 0,void 0,t)}constructor(e,t=0,i,n){if(typeof n=="boolean"&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let r=new DataView(e,t,i);this._swapDataView(r)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof le){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&ee("Creating view outside of available memory in ArrayBuffer");let r=new DataView(e.buffer,t,i);this._swapDataView(r)}else if(typeof e=="number"){let r=new DataView(new ArrayBuffer(e));this._swapDataView(r)}else ee("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=le){return e instanceof DataView||e instanceof le?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||ee("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new le(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return xi(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return Bt(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return Bt(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function Vt(a,e){ee(`${a} '${e}' was not loaded, try using full build of exifr.`)}class Wt extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||Vt(this.kind,e),t&&(e in t||function(i,n){ee(`Unknown ${i} '${n}'.`)}(this.kind,e),t[e].enabled||Vt(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var pe=new Wt("file parser"),$=new Wt("segment parser"),ge=new Wt("file reader");function Ca(a,e){return typeof a=="string"?ei(a,e):at&&!ya&&a instanceof HTMLImageElement?ei(a.src,e):a instanceof Uint8Array||a instanceof ArrayBuffer||a instanceof DataView?new le(a):at&&a instanceof Blob?zt(a,e,"blob",Me):void ee("Invalid input argument")}function ei(a,e){return(t=a).startsWith("data:")||t.length>1e4?jt(a,e,"base64"):pt&&a.includes("://")?zt(a,e,"url",Le):pt?jt(a,e,"fs"):at?zt(a,e,"url",Le):void ee("Invalid input argument");var t}async function zt(a,e,t,i){return ge.has(t)?jt(a,e,t):i?async function(n,r){let s=await r(n);return new le(s)}(a,i):void ee(`Parser ${t} is not loaded`)}async function jt(a,e,t){let i=new(ge.get(t))(a,e);return await i.read(),i}const Le=a=>Ht(a).then(e=>e.arrayBuffer()),Me=a=>new Promise((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(a)});class Pa extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function Q(a,e,t){let i=new Pa;for(let[n,r]of t)i.set(n,r);if(Array.isArray(e))for(let n of e)a.set(n,i);else a.set(e,i);return i}function Oe(a,e,t){let i,n=a.get(e);for(i of t)n.set(i[0],i[1])}const ae=new Map,me=new Map,we=new Map,be=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],ze=["jfif","xmp","icc","iptc","ihdr"],Ge=["tiff",...ze],Y=["ifd0","ifd1","exif","gps","interop"],Ce=[...Ge,...Y],Pe=["makerNote","userComment"],je=["translateKeys","translateValues","reviveValues","multiSegment"],xe=[...je,"sanitize","mergeOutput","silentErrors"];class wi{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Ze extends wi{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),R(this,"enabled",!1),R(this,"skip",new Set),R(this,"pick",new Set),R(this,"deps",new Set),R(this,"translateKeys",!1),R(this,"translateValues",!1),R(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=Y.includes(e),this.canBeFiltered&&(this.dict=ae.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:r,skip:s}=i;r&&r.length>0&&this.translateTagSet(r,this.pick),s&&s.length>0&&this.translateTagSet(s,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:ee(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of je)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:r,tagValues:s}=this.dict;for(i of e)typeof i=="string"?(n=s.indexOf(i),n===-1&&(n=r.indexOf(Number(i))),n!==-1&&t.add(Number(r[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,St(this.pick,this.deps)):this.enabled&&this.pick.size>0&&St(this.pick,this.deps)}}var re={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},ti=new Map;class Ne extends wi{static useCached(e){let t=ti.get(e);return t!==void 0||(t=new this(e),ti.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):ee(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=at?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of be)this[e]=re[e];for(e of xe)this[e]=re[e];for(e of Pe)this[e]=re[e];for(e of Ce)this[e]=new Ze(e,re[e],void 0,this)}setupFromTrue(){let e;for(e of be)this[e]=re[e];for(e of xe)this[e]=re[e];for(e of Pe)this[e]=!0;for(e of Ce)this[e]=new Ze(e,!0,void 0,this)}setupFromArray(e){let t;for(t of be)this[t]=re[t];for(t of xe)this[t]=re[t];for(t of Pe)this[t]=re[t];for(t of Ce)this[t]=new Ze(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Y)}setupFromObject(e){let t;for(t of(Y.ifd0=Y.ifd0||Y.image,Y.ifd1=Y.ifd1||Y.thumbnail,Object.assign(this,e),be))this[t]=Dt(e[t],re[t]);for(t of xe)this[t]=Dt(e[t],re[t]);for(t of Pe)this[t]=Dt(e[t],re[t]);for(t of Ge)this[t]=new Ze(t,re[t],e[t],this);for(t of Y)this[t]=new Ze(t,re[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Y,Ce),e.tiff===!0?this.batchEnableWithBool(Y,!0):e.tiff===!1?this.batchEnableWithUserValue(Y,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Y):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Y)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let n=t[i];this[i].enabled=n!==!1&&n!==void 0}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let s of n)this[s].enabled=!1;let r=ii(e,i);for(let[s,o]of r)St(this[s].pick,o),this[s].enabled=!0}else if(t&&t.length){let r=ii(t,i);for(let[s,o]of r)St(this[s].skip,o)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:r}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),r.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=Y.some(r=>this[r].enabled===!0)||this.makerNote||this.userComment;for(let r of Y)this[r].finalizeFilters()}get onlyTiff(){return!ze.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of Ge)this[e].enabled&&!$.has(e)&&Vt("segment parser",e)}}function ii(a,e){let t,i,n,r,s=[];for(n of e){for(r of(t=ae.get(n),i=[],t))(a.includes(r[0])||a.includes(r[1]))&&i.push(r[0]);i.length&&s.push([n,i])}return s}function Dt(a,e){return a!==void 0?a:e!==void 0?e:void 0}function St(a,e){for(let t of e)a.add(t)}R(Ne,"default",re);class _e{constructor(e){R(this,"parsers",{}),R(this,"output",{}),R(this,"errors",[]),R(this,"pushToErrors",t=>this.errors.push(t)),this.options=Ne.useCached(e)}async read(e){this.file=await Ca(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of pe)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),ee("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),yt(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async i=>{let n=await i.parse();i.assignToOutput(e,n)});this.options.silentErrors&&(t=t.map(i=>i.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=$.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),n===void 0)return;let r=await this.fileParser.ensureSegmentChunk(n),s=this.parsers.tiff=new i(r,e,t),o=await s.extractThumbnail();return t.close&&t.close(),o}}async function xt(a,e){let t=new _e(e);return await t.read(a),t.parse()}var xa=Object.freeze({__proto__:null,parse:xt,Exifr:_e,fileParsers:pe,segmentParsers:$,fileReaders:ge,tagKeys:ae,tagValues:me,tagRevivers:we,createDictionary:Q,extendDictionary:Oe,fetchUrlAsArrayBuffer:Le,readBlobAsArrayBuffer:Me,chunkedProps:be,otherSegments:ze,segments:Ge,tiffBlocks:Y,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:je,allFormatters:xe,Options:Ne});class wt{constructor(e,t,i){R(this,"errors",[]),R(this,"ensureSegmentChunk",async n=>{let r=n.start,s=n.size||65536;if(this.file.chunked)if(this.file.available(r,s))n.chunk=this.file.subarray(r,s);else try{n.chunk=await this.file.readChunk(r,s)}catch(o){ee(`Couldn't read segment: ${JSON.stringify(n)}. ${o.message}`)}else this.file.byteLength>r+s?n.chunk=this.file.subarray(r,s):n.size===void 0?n.chunk=this.file.subarray(r):ee("Segment unreachable: "+JSON.stringify(n));return n.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new($.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:n}=t,r=this.options[i];if(r&&r.enabled){let s=this.parsers[i];s&&s.append||s||this.createParser(i,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class he{static findPosition(e,t){let i=e.getUint16(t+2)+2,n=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,r=t+n,s=i-n;return{offset:t,length:i,headerLength:n,start:r,size:s,end:r+s}}static parse(e,t={}){return new this(e,new Ne({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof le?e:new le(e)}constructor(e,t={},i){R(this,"errors",[]),R(this,"raw",new Map),R(this,"handleError",n=>{if(!this.options.silentErrors)throw n;this.errors.push(n.message)}),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=we.get(t),n=me.get(t),r=ae.get(t),s=this.options[t],o=s.reviveValues&&!!i,h=s.translateValues&&!!n,y=s.translateKeys&&!!r,b={};for(let[v,F]of e)o&&i.has(v)?F=i.get(v)(F):h&&n.has(v)&&(F=this.translateValue(F,n.get(v))),y&&r.has(v)&&(v=r.get(v)||v),b[v]=F;return b}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}R(he,"headerLength",4),R(he,"type",void 0),R(he,"multiSegment",!1),R(he,"canHandle",()=>!1);function wa(a){return a===192||a===194||a===196||a===219||a===221||a===218||a===254}function _a(a){return a>=224&&a<=239}function ka(a,e,t){for(let[i,n]of $)if(n.canHandle(a,e,t))return i}class ai extends wt{constructor(...e){super(...e),R(this,"appSegments",[]),R(this,"jpegSegments",[]),R(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set($.keyList())):(e=e===void 0?$.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&$.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:r,remaining:s}=this;if(!n&&this.file.chunked&&(n=Array.from(r).some(o=>{let h=$.get(o),y=this.options[o];return h.multiSegment&&y.multiSegment}),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let o=!1;for(;s.size>0&&!o&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:h}=i,y=this.appSegments.some(b=>!this.file.available(b.offset||b.start,b.length||b.size));if(o=e>h&&!y?!await i.readNextChunk(e):!await i.readNextChunk(h),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,r,s,o,h,{file:y,findAll:b,wanted:v,remaining:F,options:C}=this;for(;e<t;e++)if(y.getUint8(e)===255){if(i=y.getUint8(e+1),_a(i)){if(n=y.getUint16(e+2),r=ka(y,e,n),r&&v.has(r)&&(s=$.get(r),o=s.findPosition(y,e),h=C[r],o.type=r,this.appSegments.push(o),!b&&(s.multiSegment&&h.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||F.delete(r)):F.delete(r),F.size===0)))break;C.recordUnknownSegments&&(o=he.findPosition(y,e),o.marker=i,this.unknownSegments.push(o)),e+=n+1}else if(wa(i)){if(n=y.getUint16(e+2),i===218&&C.stopAfterSos!==!1)return;C.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,i){let n,r,s,o=new Map;for(let h=0;h<t.length;h++)n=t[h],r=n[i],o.has(r)?s=o.get(r):o.set(r,s=[]),s.push(n);return Array.from(o)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,i])=>{let n=$.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(i)}:i[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}R(ai,"type","jpeg"),pe.set("jpeg",ai);const Ia=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Ta extends he{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:r}=this.options[t];n=new Set(n);let s=n.size>0,o=r.size===0,h=this.chunk.getUint16(e);e+=2;for(let y=0;y<h;y++){let b=this.chunk.getUint16(e);if(s){if(n.has(b)&&(i.set(b,this.parseTag(e,b,t)),n.delete(b),n.size===0))break}else!o&&r.has(b)||i.set(b,this.parseTag(e,b,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,r=n.getUint16(e+2),s=n.getUint32(e+4),o=Ia[r];if(o*s<=4?e+=8:e=n.getUint32(e+8),(r<1||r>13)&&ee(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>n.byteLength&&ee(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${n.byteLength}`),r===1)return n.getUint8Array(e,s);if(r===2)return Ae(n.getString(e,s));if(r===7)return n.getUint8Array(e,s);if(s===1)return this.parseTagValue(r,e);{let h=new(function(b){switch(b){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(r))(s),y=o;for(let b=0;b<s;b++)h[b]=this.parseTagValue(r,e),e+=y;return h}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:ee(`Invalid tiff type ${e}`)}}}class Et extends Ta{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&ee("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&ee(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,Ut(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,Ut(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ni(...e.get(2),e.get(1))),e.set("longitude",ni(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of Y)if(e=this[t],!Pi(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function ni(a,e,t,i){var n=a+e/60+t/3600;return i!=="S"&&i!=="W"||(n*=-1),n}R(Et,"type","tiff"),R(Et,"headerLength",10),$.set("tiff",Et);var Aa=Object.freeze({__proto__:null,default:xa,Exifr:_e,fileParsers:pe,segmentParsers:$,fileReaders:ge,tagKeys:ae,tagValues:me,tagRevivers:we,createDictionary:Q,extendDictionary:Oe,fetchUrlAsArrayBuffer:Le,readBlobAsArrayBuffer:Me,chunkedProps:be,otherSegments:ze,segments:Ge,tiffBlocks:Y,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:je,allFormatters:xe,Options:Ne,parse:xt});const Xt={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Kt=Object.assign({},Xt,{firstChunkSize:4e4,gps:[1,2,3,4]});async function _i(a){let e=new _e(Kt);await e.read(a);let t=await e.parse();if(t&&t.gps){let{latitude:i,longitude:n}=t.gps;return{latitude:i,longitude:n}}}const Jt=Object.assign({},Xt,{tiff:!1,ifd1:!0,mergeOutput:!1});async function ki(a){let e=new _e(Jt);await e.read(a);let t=await e.extractThumbnail();return t&&Pt?Ct.from(t):t}async function Ii(a){let e=await this.thumbnail(a);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}const Yt=Object.assign({},Xt,{firstChunkSize:4e4,ifd0:[274]});async function qt(a){let e=new _e(Yt);await e.read(a);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const Qt=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Fe=!0,De=!0;if(typeof navigator=="object"){let a=navigator.userAgent;if(a.includes("iPad")||a.includes("iPhone")){let e=a.match(/OS (\d+)_(\d+)/);if(e){let[,t,i]=e;Fe=Number(t)+.1*Number(i)<13.4,De=!1}}else if(a.includes("OS X 10")){let[,e]=a.match(/OS X 10[_.](\d+)/);Fe=De=Number(e)<15}if(a.includes("Chrome/")){let[,e]=a.match(/Chrome\/(\d+)/);Fe=De=Number(e)<81}else if(a.includes("Firefox/")){let[,e]=a.match(/Firefox\/(\d+)/);Fe=De=Number(e)<77}}async function Ti(a){let e=await qt(a);return Object.assign({canvas:Fe,css:De},Qt[e])}class Fa extends le{constructor(...e){super(...e),R(this,"ranges",new Da),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let n=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(n)}else{let n=e+t;if(n>this.byteLength){let{dataView:r}=this._extend(n);this._swapDataView(r)}}}_extend(e){let t;t=Pt?Ct.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Da{constructor(){R(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,r=this.list.filter(s=>ri(e,s.offset,n)||ri(e,s.end,n));if(r.length>0){e=Math.min(e,...r.map(o=>o.offset)),n=Math.max(n,...r.map(o=>o.end)),t=n-e;let s=r.shift();s.offset=e,s.length=t,s.end=n,this.list=this.list.filter(o=>!r.includes(o))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some(n=>n.offset<=e&&i<=n.end)}}function ri(a,e,t){return a<=e&&e<=t}class _t extends Fa{constructor(e,t){super(0),R(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}ge.set("blob",class extends _t{async readWhole(){this.chunked=!1;let a=await Me(this.input);this._swapArrayBuffer(a)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(a,e){let t=e?a+e:void 0,i=this.input.slice(a,t),n=await Me(i);return this.set(n,a,!0)}});var Ea=Object.freeze({__proto__:null,default:Aa,Exifr:_e,fileParsers:pe,segmentParsers:$,fileReaders:ge,tagKeys:ae,tagValues:me,tagRevivers:we,createDictionary:Q,extendDictionary:Oe,fetchUrlAsArrayBuffer:Le,readBlobAsArrayBuffer:Me,chunkedProps:be,otherSegments:ze,segments:Ge,tiffBlocks:Y,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:je,allFormatters:xe,Options:Ne,parse:xt,gpsOnlyOptions:Kt,gps:_i,thumbnailOnlyOptions:Jt,thumbnail:ki,thumbnailUrl:Ii,orientationOnlyOptions:Yt,orientation:qt,rotations:Qt,get rotateCanvas(){return Fe},get rotateCss(){return De},rotation:Ti});ge.set("url",class extends _t{async readWhole(){this.chunked=!1;let a=await Le(this.input);a instanceof ArrayBuffer?this._swapArrayBuffer(a):a instanceof Uint8Array&&this._swapBuffer(a)}async _readChunk(a,e){let t=e?a+e-1:void 0,i=this.options.httpHeaders||{};(a||t)&&(i.range=`bytes=${[a,t].join("-")}`);let n=await Ht(this.input,{headers:i}),r=await n.arrayBuffer(),s=r.byteLength;if(n.status!==416)return s!==e&&(this.size=a+s),this.set(r,a,!0)}});le.prototype.getUint64=function(a){let e=this.getUint32(a),t=this.getUint32(a+4);return e<1048575?e<<32|t:typeof ut!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),ut(e)<<ut(32)|ut(t)):void ee("Trying to read 64b value but JS can only handle 53b numbers.")};class Ra extends wt{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),i.length===0)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(i=>i.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return t===1&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Ai extends Ra{static canHandle(e,t){if(t!==0)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,r=[];for(;n<i;)r.push(e.getString(n,4)),n+=4;return r.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let i=this.findBox(t,"ipco");if(i===void 0)return;let n=this.findBox(i,"colr");n!==void 0&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let i=this.findBox(e,"iloc");if(i===void 0)return;let n=this.findExifLocIdInIinf(t),r=this.findExtentInIloc(i,n);if(r===void 0)return;let[s,o]=r;await this.file.ensureChunk(s,o);let h=4+this.file.getUint32(s);s+=h,o-=h,await this.registerSegment("tiff",s,o)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,r,s=e.start,o=this.file.getUint16(s);for(s+=2;o--;){if(t=this.parseBoxHead(s),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=t.version===3?4:2,r=this.file.getString(i+n+2,4),r==="Exif"))return this.file.getUintBytes(i,n);s+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,r]=this.get8bits(i++),[s,o]=this.get8bits(i++),h=e.version===2?4:2,y=e.version===1||e.version===2?2:0,b=o+n+r,v=e.version===2?4:2,F=this.file.getUintBytes(i,v);for(i+=v;F--;){let C=this.file.getUintBytes(i,h);i+=h+y+2+s;let P=this.file.getUint16(i);if(i+=2,C===t)return P>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(i+o,n),this.file.getUintBytes(i+o+n,r)];i+=P*b}}}class Fi extends Ai{}R(Fi,"type","heic");class si extends Ai{}R(si,"type","avif"),pe.set("heic",Fi),pe.set("avif",si),Q(ae,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),Q(ae,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),Q(ae,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),Q(me,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let it=Q(me,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const oi={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};it.set(37392,oi),it.set(41488,oi);const Rt={0:"Normal",1:"Low",2:"High"};function li(a){return typeof a=="object"&&a.length!==void 0?a[0]:a}function ci(a){let e=Array.from(a).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function Lt(a){if(typeof a=="string"){var[e,t,i,n,r,s]=a.trim().split(/[-: ]/g).map(Number),o=new Date(e,t-1,i);return Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(s)||(o.setHours(n),o.setMinutes(r),o.setSeconds(s)),Number.isNaN(+o)?a:o}}function $e(a){if(typeof a=="string")return a;let e=[];if(a[1]===0&&a[a.length-1]===0)for(let t=0;t<a.length;t+=2)e.push(di(a[t+1],a[t]));else for(let t=0;t<a.length;t+=2)e.push(di(a[t],a[t+1]));return Ae(String.fromCodePoint(...e))}function di(a,e){return a<<8|e}it.set(41992,Rt),it.set(41993,Rt),it.set(41994,Rt),Q(we,["ifd0","ifd1"],[[50827,function(a){return typeof a!="string"?xi(a):a}],[306,Lt],[40091,$e],[40092,$e],[40093,$e],[40094,$e],[40095,$e]]),Q(we,"exif",[[40960,ci],[36864,ci],[36867,Lt],[36868,Lt],[40962,li],[40963,li]]),Q(we,"gps",[[0,a=>Array.from(a).join(".")],[7,a=>Array.from(a).join(":")]]);class Mt extends he{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=i.headerLength===79,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:le.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(r){let s={},o={};for(let h of Li)s[h]=[],o[h]=0;return r.replace(Ga,(h,y,b)=>{if(y==="<"){let v=++o[b];return s[b].push(v),`${h}#${v}`}return`${h}#${s[b].pop()}`})}(e);let t=Be.findAll(e,"rdf","Description");t.length===0&&t.push(new Be("rdf","Description",void 0,e));let i,n={};for(let r of t)for(let s of r.properties)i=Oa(s.ns,n),Di(s,i);return function(r){let s;for(let o in r)s=r[o]=yt(r[o]),s===void 0&&delete r[o];return yt(r)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}R(Mt,"type","xmp"),R(Mt,"multiSegment",!0),$.set("xmp",Mt);class vt{static findAll(e){return Ei(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(vt.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=Ri(n),new vt(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class Be{static findAll(e,t,i){if(t!==void 0||i!==void 0){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return Ei(e,n).map(Be.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],r=e[8];return new Be(t,i,n,r)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=vt.findAll(i),this.children=Be.findAll(n),this.value=this.children.length===0?Ri(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return Ma(this.children.map(La));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)Di(t,e);return this.value!==void 0&&(e.value=this.value),yt(e)}}function Di(a,e){let t=a.serialize();t!==void 0&&(e[a.name]=t)}var La=a=>a.serialize(),Ma=a=>a.length===1?a[0]:a,Oa=(a,e)=>e[a]?e[a]:e[a]={};function Ei(a,e){let t,i=[];if(!a)return i;for(;(t=e.exec(a))!==null;)i.push(t);return i}function Ri(a){if(function(i){return i==null||i==="null"||i==="undefined"||i===""||i.trim()===""}(a))return;let e=Number(a);if(!Number.isNaN(e))return e;let t=a.toLowerCase();return t==="true"||t!=="false"&&a.trim()}const Li=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],Ga=new RegExp(`(<|\\/)(${Li.join("|")})`,"g");var Na=Object.freeze({__proto__:null,default:Ea,Exifr:_e,fileParsers:pe,segmentParsers:$,fileReaders:ge,tagKeys:ae,tagValues:me,tagRevivers:we,createDictionary:Q,extendDictionary:Oe,fetchUrlAsArrayBuffer:Le,readBlobAsArrayBuffer:Me,chunkedProps:be,otherSegments:ze,segments:Ge,tiffBlocks:Y,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:je,allFormatters:xe,Options:Ne,parse:xt,gpsOnlyOptions:Kt,gps:_i,thumbnailOnlyOptions:Jt,thumbnail:ki,thumbnailUrl:Ii,orientationOnlyOptions:Yt,orientation:qt,rotations:Qt,get rotateCanvas(){return Fe},get rotateCss(){return De},rotation:Ti});let ui=gt("fs",a=>a.promises);ge.set("fs",class extends _t{async readWhole(){this.chunked=!1,this.fs=await ui;let a=await this.fs.readFile(this.input);this._swapBuffer(a)}async readChunked(){this.chunked=!0,this.fs=await ui,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(a,e){this.fh===void 0&&await this.open(),a+e>this.size&&(e=this.size-a);var t=this.subarray(a,e,!0);return await this.fh.read(t.dataView,0,e,a),t}async close(){if(this.fh){let a=this.fh;this.fh=void 0,await a.close()}}});ge.set("base64",class extends _t{constructor(...a){super(...a),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(a,e){let t,i,n=this.input;a===void 0?(a=0,t=0,i=0):(t=4*Math.floor(a/3),i=a-t/4*3),e===void 0&&(e=this.size);let r=a+e,s=t+4*Math.ceil(r/3);n=n.slice(t,s);let o=Math.min(e,this.size-a);if(Pt){let h=Ct.from(n,"base64").slice(i,i+o);return this.set(h,a,!0)}{let h=this.subarray(a,o,!0),y=atob(n),b=h.toUint8();for(let v=0;v<o;v++)b[v]=y.charCodeAt(i+v);return h}}});class fi extends wt{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:r}=e;i.enabled&&t.deps.add(700),n.enabled&&t.deps.add(33723),r.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let r=Math.max(Ut(this.options),this.options.chunkSize);await this.file.ensureChunk(0,r),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}R(fi,"type","tiff"),pe.set("tiff",fi);let Ua=gt("zlib");const Ba=["ihdr","iccp","text","itxt","exif"];class hi extends wt{constructor(...e){super(...e),R(this,"catchError",t=>this.errors.push(t)),R(this,"metaChunks",[]),R(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let n=i.getUint32(e),r=i.getUint32(e+4),s=i.getString(e+4,4).toLowerCase(),o=n+4+4+4,h={type:s,offset:e,length:o,start:e+4+4,size:n,marker:r};Ba.includes(s)?this.metaChunks.push(h):this.unknownChunks.push(h),e+=o}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[i,n]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(i,n)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(o=>o.type==="iccp");if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),n=0;for(;n<80&&i[n]!==0;)n++;let r=n+2,s=t.getString(0,n);if(this.injectKeyValToIhdr("ProfileName",s),pt){let o=await Ua,h=t.getUint8Array(r);h=o.inflateSync(h),this.injectSegment("icc",h)}}}R(hi,"type","png"),pe.set("png",hi),Q(ae,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),Oe(ae,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let mi=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];Oe(ae,"ifd0",mi),Oe(ae,"exif",mi),Q(me,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Ot extends he{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}R(Ot,"type","jfif"),R(Ot,"headerLength",9),$.set("jfif",Ot),Q(ae,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class pi extends he{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}R(pi,"type","ihdr"),$.set("ihdr",pi),Q(ae,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),Q(me,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class mt extends he{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(t){let i=function(n){let r=n[0].constructor,s=0;for(let y of n)s+=y.length;let o=new r(s),h=0;for(let y of n)o.set(y,h),h+=y.length;return o}(t.map(n=>n.chunk.toUint8()));return new le(i)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&ee("ICC header is too short");for(let[t,i]of Object.entries(Va)){t=parseInt(t,10);let n=i(this.chunk,t);n!=="\0\0\0\0"&&e.set(t,n)}}parseTags(){let e,t,i,n,r,{raw:s}=this,o=this.chunk.getUint32(128),h=132,y=this.chunk.byteLength;for(;o--;){if(e=this.chunk.getString(h,4),t=this.chunk.getUint32(h+4),i=this.chunk.getUint32(h+8),n=this.chunk.getString(t,4),t+i>y)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");r=this.parseTag(n,t,i),r!==void 0&&r!=="\0\0\0\0"&&s.set(e,r),h+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return Ae(this.chunk.getString(e+12,t))}parseText(e,t){return Ae(this.chunk.getString(e+8,t-8))}parseSig(e){return Ae(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),r=e+16,s=[];for(let o=0;o<i;o++){let h=t.getString(r+0,2),y=t.getString(r+2,2),b=t.getUint32(r+4),v=t.getUint32(r+8)+e,F=Ae(t.getUnicodeString(v,b));s.push({lang:h,country:y,text:F}),r+=n}return i===1?s[0].text:s}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}R(mt,"type","icc"),R(mt,"multiSegment",!0),R(mt,"headerLength",18);const Va={4:ve,8:function(a,e){return[a.getUint8(e),a.getUint8(e+1)>>4,a.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:ve,16:ve,20:ve,24:function(a,e){const t=a.getUint16(e),i=a.getUint16(e+2)-1,n=a.getUint16(e+4),r=a.getUint16(e+6),s=a.getUint16(e+8),o=a.getUint16(e+10);return new Date(Date.UTC(t,i,n,r,s,o))},36:ve,40:ve,48:ve,52:ve,64:(a,e)=>a.getUint32(e),80:ve};function ve(a,e){return Ae(a.getString(e,4))}$.set("icc",mt),Q(ae,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const ft={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},gi={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};Q(me,"icc",[[4,ft],[12,gi],[40,Object.assign({},ft,gi)],[48,ft],[80,ft],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class ht extends he{static canHandle(e,t,i){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,i)!==void 0}static headerLength(e,t,i){let n,r=this.containsIptc8bim(e,t,i);if(r!==void 0)return n=e.getUint8(t+r+7),n%2!=0&&(n+=1),n===0&&(n=4),r+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(this.chunk.getUint8(n)===28&&this.chunk.getUint8(n+1)===2){i=!0;let r=this.chunk.getUint16(n+3),s=this.chunk.getUint8(n+2),o=this.chunk.getLatin1String(n+5,r);e.set(s,this.pluralizeValue(e.get(s),o)),n+=4+r}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}R(ht,"type","iptc"),R(ht,"translateValues",!1),R(ht,"reviveValues",!1),$.set("iptc",ht),Q(ae,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),Q(me,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);const Mi={Title:{label:"Title",section:"Description",icon:"mdi-text-box",description:"Short title or caption for the image",editable:!0},Author:{label:"Author",section:"Author",icon:"mdi-account",description:"Name of image creator",editable:!0},Description:{label:"Description",section:"Description",icon:"mdi-text",description:"Longer description of image",editable:!0},Copyright:{label:"Copyright",section:"Author",icon:"mdi-copyright",description:"Copyright notice",editable:!0},"Creation Time":{label:"Creation Time",section:"Timestamps",icon:"mdi-clock-outline",description:"Time of original image creation",editable:!0,editWarning:'Should be in RFC 1123 format (e.g., "21 Jan 2025 15:30:00 +0000")'},Software:{label:"Software",section:"Technical",icon:"mdi-application",description:"Software used to create the image",editable:!0},Disclaimer:{label:"Disclaimer",section:"Author",icon:"mdi-alert-circle-outline",description:"Legal disclaimer",editable:!0},Warning:{label:"Warning",section:"Technical",icon:"mdi-alert",description:"Warning of nature of content",editable:!0},Source:{label:"Source",section:"Technical",icon:"mdi-source-branch",description:"Device used to create the image",editable:!0},Comment:{label:"Comment",section:"Description",icon:"mdi-comment-text",description:"Miscellaneous comment",editable:!0},"XML:com.adobe.xmp":{label:"XMP Metadata",section:"Hidden",icon:"mdi-xml",description:"Adobe XMP metadata (XML format)",editable:!1,editWarning:"XMP metadata is complex XML data and should not be manually edited"}},yi={Description:{label:"Description",icon:"mdi-text-box",order:1},Author:{label:"Author & Copyright",icon:"mdi-account-circle",order:2},Timestamps:{label:"Timestamps",icon:"mdi-clock-outline",order:3},Technical:{label:"Technical",icon:"mdi-cog",order:4},Hidden:{label:"Hidden/Advanced",icon:"mdi-eye-off",order:5},Custom:{label:"Custom Fields",icon:"mdi-plus-box",order:6}};function za(a){return Mi[a]||{label:a,section:"Custom",icon:"mdi-tag",description:"Custom PNG text chunk",editable:!0}}function ja(a){return!a||a.length===0?{valid:!1,error:"Keyword cannot be empty"}:a.length>79?{valid:!1,error:"Keyword must be 79 characters or less"}:/^[\x20-\xFF]+$/.test(a)?a!==a.trim()?{valid:!1,error:"Keyword should not have leading or trailing spaces"}:{valid:!0}:{valid:!1,error:"Keyword must contain only Latin-1 printable characters"}}function ot(a){const e=a.replace(/^data:image\/png;base64,/,""),t=atob(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i.buffer}function kt(a){const e=new Uint8Array(a);let t="";for(let i=0;i<e.byteLength;i++)t+=String.fromCharCode(e[i]);return btoa(t)}const Oi=new Uint8Array([137,80,78,71,13,10,26,10]);function Ha(a){const e=new Uint32Array(256);for(let i=0;i<256;i++){let n=i;for(let r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[i]=n}let t=4294967295;for(let i=0;i<a.length;i++)t=e[(t^a[i])&255]^t>>>8;return(t^4294967295)>>>0}function It(a){const e=new DataView(a),t=[];let i=0;for(let n=0;n<8;n++)if(e.getUint8(i+n)!==Oi[n])throw new Error("Invalid PNG signature");for(i=8;i<a.byteLength;){const n=e.getUint32(i);i+=4;const r=String.fromCharCode(e.getUint8(i),e.getUint8(i+1),e.getUint8(i+2),e.getUint8(i+3));i+=4;const s=new Uint8Array(a,i,n);i+=n;const o=e.getUint32(i);if(i+=4,t.push({type:r,data:new Uint8Array(s),crc:o}),r==="IEND")break}return t}function Tt(a){let e=8;for(const r of a)e+=8+r.data.length+4;const t=new ArrayBuffer(e),i=new DataView(t);let n=0;for(let r=0;r<8;r++)i.setUint8(n++,Oi[r]);for(const r of a){i.setUint32(n,r.data.length),n+=4;const s=new Uint8Array(4);for(let y=0;y<4;y++)s[y]=r.type.charCodeAt(y),i.setUint8(n++,s[y]);for(let y=0;y<r.data.length;y++)i.setUint8(n++,r.data[y]);const o=new Uint8Array(4+r.data.length);o.set(s,0),o.set(r.data,4);const h=Ha(o);i.setUint32(n,h),n+=4}return t}function Gi(a,e){const t=new TextEncoder().encode(a),i=new TextEncoder().encode(e),n=new Uint8Array(t.length+1+i.length);return n.set(t,0),n[t.length]=0,n.set(i,t.length+1),{type:"tEXt",data:n}}function Ni(a){if(!a.data||a.data.length===0)return null;let e=-1;for(let i=0;i<a.data.length;i++)if(a.data[i]===0){e=i;break}if(e<0)return null;const t=a.data.slice(0,e);return new TextDecoder().decode(t)}async function Wa(a){try{const e=ot(a),t=await Na.parse(e,{tiff:!1,exif:!1,gps:!1,iptc:!1,icc:!1,jfif:!1,ihdr:!0,png:!0});return Si(t||{})}catch(e){throw console.error("PNG metadata loading error:",e),new Error(`Failed to load PNG metadata: ${e.message}`)}}function Si(a){const e={};Object.keys(yi).forEach(t=>{e[t]={...yi[t],fields:[]}});for(const[t,i]of Object.entries(a)){if(["width","height","bitDepth","colorType","compressionMethod","filterMethod","interlaceMethod"].includes(t))continue;const n=za(t),r=n.section||"Custom",s=i!=null&&i!=="";e[r].fields.push({label:n.label,key:t,value:i||"",editable:n.editable,icon:n.icon,description:n.description,editWarning:n.editWarning||null,isPopulated:s,rawValue:i})}return Object.entries(Mi).forEach(([t,i])=>{var s;const n=i.section;((s=e[n])==null?void 0:s.fields.find(o=>o.key===t))||e[n].fields.push({label:i.label,key:t,value:"",editable:i.editable,icon:i.icon,description:i.description,editWarning:i.editWarning||null,isPopulated:!1,rawValue:null})}),Object.keys(e).forEach(t=>{e[t].fields.length===0&&delete e[t]}),e}function Xa(a){if(!a)return{totalFields:0,populatedFields:0,sections:0};const e=Object.keys(a).length;let t=0,i=0;return Object.values(a).forEach(n=>{t+=n.fields.length,i+=n.fields.filter(r=>r.isPopulated).length}),{totalFields:t,populatedFields:i,sections:e}}async function Ka(a,e,t){try{const i=ot(a),n=It(i);let r=-1;for(let h=0;h<n.length;h++){const y=n[h];if((y.type==="tEXt"||y.type==="iTXt"||y.type==="zTXt")&&Ni(y)===e.key){r=h;break}}const s=Gi(e.key,t);if(r>=0)n[r]=s;else{const h=n.findIndex(y=>y.type==="IEND");h>=0?n.splice(h,0,s):n.push(s)}const o=Tt(n);return kt(o)}catch(i){throw console.error("PNG metadata edit error:",i),new Error(`Failed to edit PNG metadata: ${i.message}`)}}async function Ja(a,e){try{const t=ot(a),n=It(t).filter(s=>s.type==="tEXt"||s.type==="iTXt"||s.type==="zTXt"?Ni(s)!==e.key:!0),r=Tt(n);return kt(r)}catch(t){throw console.error("PNG metadata removal error:",t),new Error(`Failed to remove PNG metadata: ${t.message}`)}}async function Ya(a){try{const e=ot(a),i=It(e).filter(r=>!["tEXt","iTXt","zTXt","tIME"].includes(r.type)),n=Tt(i);return kt(n)}catch(e){throw console.error("PNG metadata removal error:",e),new Error(`Failed to remove all PNG metadata: ${e.message}`)}}async function qa(a,e,t){try{const i=ot(a),n=It(i),r=Gi(e,t),s=n.findIndex(h=>h.type==="IEND");s>=0?n.splice(s,0,r):n.push(r);const o=Tt(n);return kt(o)}catch(i){throw console.error("PNG custom field addition error:",i),new Error(`Failed to add custom PNG field: ${i.message}`)}}const H={JPEG:"JPEG",PNG:"PNG",UNKNOWN:"UNKNOWN"};function Qa(a){if(a instanceof File){const e=a.name.split(".").pop().toLowerCase(),t=a.type;if(e==="png"||t==="image/png")return H.PNG;if(e==="jpg"||e==="jpeg"||t==="image/jpeg")return H.JPEG}else if(typeof a=="string"){if(a.startsWith("data:image/png"))return H.PNG;if(a.startsWith("data:image/jpeg")||a.startsWith("data:image/jpg"))return H.JPEG;try{const e=a.replace(/^data:image\/[a-z]+;base64,/,""),t=atob(e.substring(0,20));if(t.charCodeAt(0)===137&&t.charCodeAt(1)===80&&t.charCodeAt(2)===78&&t.charCodeAt(3)===71)return H.PNG;if(t.charCodeAt(0)===255&&t.charCodeAt(1)===216&&t.charCodeAt(2)===255)return H.JPEG}catch(e){console.error("Error detecting format from magic bytes:",e)}}return H.UNKNOWN}async function et(a,e){switch(e){case H.JPEG:return await ra(a);case H.PNG:return await Wa(a);default:throw new Error(`Unsupported image format: ${e}`)}}async function Za(a,e,t,i){switch(e){case H.JPEG:return await fa(a,t,i);case H.PNG:return await Ka(a,t,i);default:throw new Error(`Unsupported image format: ${e}`)}}async function $a(a,e,t){switch(e){case H.JPEG:return await ha(a,t);case H.PNG:return await Ja(a,t);default:throw new Error(`Unsupported image format: ${e}`)}}async function en(a,e){switch(e){case H.JPEG:return await oa(a);case H.PNG:return await Ya(a);default:throw new Error(`Unsupported image format: ${e}`)}}async function tn(a,e,t){switch(e){case H.JPEG:return await ga(a,t.ifd,t.tagId,t.value,t.type);case H.PNG:return await qa(a,t.keyword,t.value);default:throw new Error(`Unsupported image format: ${e}`)}}function an(a,e){switch(e){case H.JPEG:return da(a);case H.PNG:return Xa(a);default:return{totalFields:0,populatedFields:0,sections:0}}}function Gt(a){switch(a){case H.JPEG:return"jpg";case H.PNG:return"png";default:return"bin"}}function tt(a){switch(a){case H.JPEG:return"image/jpeg";case H.PNG:return"image/png";default:return"application/octet-stream"}}const nn={name:"AddCustomFieldDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","add-field","cancel"],setup(a,{emit:e}){const t=j("0th"),i=j(null),n=j(""),r=j("string"),s=j(""),o=j(null),h=[{title:"0th - Main Image Data",value:"0th"},{title:"Exif - EXIF Data",value:"Exif"},{title:"GPS - GPS Data",value:"GPS"},{title:"1st - Thumbnail Data",value:"1st"}],y=[{title:"Text (String)",value:"string"},{title:"Number (Integer)",value:"number"},{title:"Rational (Fraction)",value:"rational"},{title:"DateTime",value:"datetime"},{title:"Array",value:"array"}],b=[{ifd:"0th",tagId:270,label:"Image Description",icon:"mdi-text",description:"General description of the image"},{ifd:"Exif",tagId:37510,label:"User Comment",icon:"mdi-message-text",description:"User-defined comment (ideal for hidden data)"},{ifd:"0th",tagId:315,label:"Artist/Author",icon:"mdi-account",description:"Creator of the image"},{ifd:"0th",tagId:33432,label:"Copyright",icon:"mdi-copyright",description:"Copyright information"},{ifd:"0th",tagId:305,label:"Software",icon:"mdi-application",description:"Software used to create/edit the image"}],v=se({get:()=>a.modelValue,set:z=>e("update:modelValue",z)}),F=se(()=>t.value&&i.value&&i.value>0&&n.value&&s.value&&!o.value),C=()=>({string:"Enter any text value",number:"Enter a whole number (e.g., 100, 400)",rational:"Enter a fraction (e.g., 1/125) or decimal (e.g., 2.8)",datetime:"Format: YYYY:MM:DD HH:MM:SS",array:"Enter comma-separated values (e.g., 1, 2, 3)"})[r.value]||"Enter field value",P=()=>({string:"Enter text...",number:"100",rational:"1/125",datetime:"2025:11:15 14:30:00",array:"1, 2, 3"})[r.value]||"",G=z=>{t.value=z.ifd,i.value=z.tagId,n.value=z.label},K=()=>{if(!s.value)return"Field value is required";const z=Ci(s.value,r.value);return z.valid?null:z.warning};return{dialog:v,selectedIfd:t,tagId:i,fieldLabel:n,valueType:r,fieldValue:s,validationError:o,ifdOptions:h,typeOptions:y,suggestions:b,canAdd:F,getValueHint:C,getValuePlaceholder:P,applySuggestion:G,addField:()=>{const z=K();if(z){o.value=z;return}e("add-field",{ifd:t.value,tagId:parseInt(i.value),label:n.value,type:r.value,value:s.value}),t.value="0th",i.value=null,n.value="",r.value="string",s.value="",o.value=null,v.value=!1},cancel:()=>{e("cancel"),t.value="0th",i.value=null,n.value="",r.value="string",s.value="",o.value=null,v.value=!1}}}},rn=a=>(rt("data-v-225e11dd"),a=a(),st(),a),sn=rn(()=>O("strong",null,"Note:",-1));function on(a,e,t,i,n,r){const s=S("v-icon"),o=S("v-card-title"),h=S("v-alert"),y=S("v-select"),b=S("v-col"),v=S("v-text-field"),F=S("v-row"),C=S("v-expansion-panel-title"),P=S("v-list-item-title"),G=S("v-list-item-subtitle"),K=S("v-list-item"),J=S("v-list"),ne=S("v-expansion-panel-text"),z=S("v-expansion-panel"),Z=S("v-expansion-panels"),l=S("v-textarea"),c=S("v-card-text"),f=S("v-btn"),g=S("v-spacer"),p=S("v-card-actions"),m=S("v-card"),_=S("v-dialog");return T(),E(_,{modelValue:i.dialog,"onUpdate:modelValue":e[5]||(e[5]=I=>i.dialog=I),"max-width":"700",persistent:""},{default:u(()=>[d(m,null,{default:u(()=>[d(o,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(s,{icon:"mdi-plus-circle",class:"mr-2"}),k(" Add Custom EXIF Field ")]),_:1}),d(c,{class:"pa-4"},{default:u(()=>[d(h,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:u(()=>[sn,k(" Adding custom fields to EXIF data can help with organization or steganography (hiding data). Choose from commonly used fields or select a custom tag ID. ")]),_:1}),d(F,null,{default:u(()=>[d(b,{cols:"12",md:"6"},{default:u(()=>[d(y,{modelValue:i.selectedIfd,"onUpdate:modelValue":e[0]||(e[0]=I=>i.selectedIfd=I),items:i.ifdOptions,label:"IFD (Image File Directory)",variant:"outlined",density:"comfortable",hint:"Choose where to store the field","persistent-hint":""},{"prepend-inner":u(()=>[d(s,{icon:"mdi-folder",size:"small"})]),_:1},8,["modelValue","items"])]),_:1}),d(b,{cols:"12",md:"6"},{default:u(()=>[d(v,{modelValue:i.tagId,"onUpdate:modelValue":e[1]||(e[1]=I=>i.tagId=I),label:"Tag ID",variant:"outlined",density:"comfortable",type:"number",hint:"Numeric tag identifier","persistent-hint":"",rules:[I=>!!I||"Tag ID is required",I=>I>0||"Must be positive"]},{"prepend-inner":u(()=>[d(s,{icon:"mdi-tag",size:"small"})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1}),d(Z,{class:"mt-4 mb-4"},{default:u(()=>[d(z,null,{default:u(()=>[d(C,null,{default:u(()=>[d(s,{icon:"mdi-lightbulb",class:"mr-2",size:"small"}),k(" Suggested Custom Fields ")]),_:1}),d(ne,null,{default:u(()=>[d(J,{density:"compact"},{default:u(()=>[(T(!0),oe(Ee,null,Re(i.suggestions,I=>(T(),E(K,{key:I.key,onClick:L=>i.applySuggestion(I),class:"suggestion-item"},{prepend:u(()=>[d(s,{icon:I.icon,size:"small"},null,8,["icon"])]),default:u(()=>[d(P,null,{default:u(()=>[k(N(I.label),1)]),_:2},1024),d(G,{class:"text-caption"},{default:u(()=>[k(N(I.ifd)+"."+N(I.tagId)+" - "+N(I.description),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),d(v,{modelValue:i.fieldLabel,"onUpdate:modelValue":e[2]||(e[2]=I=>i.fieldLabel=I),label:"Field Label",variant:"outlined",density:"comfortable",hint:"Human-readable name for this field","persistent-hint":"",class:"mb-3"},{"prepend-inner":u(()=>[d(s,{icon:"mdi-text",size:"small"})]),_:1},8,["modelValue"]),d(y,{modelValue:i.valueType,"onUpdate:modelValue":e[3]||(e[3]=I=>i.valueType=I),items:i.typeOptions,label:"Value Type",variant:"outlined",density:"comfortable",hint:"Data type for this field","persistent-hint":"",class:"mb-3"},{"prepend-inner":u(()=>[d(s,{icon:"mdi-format-list-bulleted-type",size:"small"})]),_:1},8,["modelValue","items"]),d(l,{modelValue:i.fieldValue,"onUpdate:modelValue":e[4]||(e[4]=I=>i.fieldValue=I),label:"Field Value",variant:"outlined",density:"comfortable",rows:"3",hint:i.getValueHint(),"persistent-hint":"",placeholder:i.getValuePlaceholder()},{"prepend-inner":u(()=>[d(s,{icon:"mdi-pencil",size:"small"})]),_:1},8,["modelValue","hint","placeholder"]),i.validationError?(T(),E(h,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:u(()=>[k(N(i.validationError),1)]),_:1})):B("",!0)]),_:1}),d(p,{class:"bg-surface-variant"},{default:u(()=>[d(f,{variant:"text",onClick:i.cancel},{default:u(()=>[k(" Cancel ")]),_:1},8,["onClick"]),d(g),d(f,{color:"primary",variant:"elevated","prepend-icon":"mdi-plus",onClick:i.addField,disabled:!i.canAdd},{default:u(()=>[k(" Add Field ")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ln=nt(nn,[["render",on],["__scopeId","data-v-225e11dd"]]),cn={name:"AddPngFieldDialog",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","add-field","cancel"],setup(a,{emit:e}){const t=j(""),i=j(""),n=j(""),r=[{keyword:"Title",icon:"mdi-text-box",description:"Short title or caption for the image"},{keyword:"Author",icon:"mdi-account",description:"Name of image creator"},{keyword:"Description",icon:"mdi-text",description:"Longer description of image"},{keyword:"Copyright",icon:"mdi-copyright",description:"Copyright notice"},{keyword:"Creation Time",icon:"mdi-clock-outline",description:"Time of original image creation"},{keyword:"Software",icon:"mdi-application",description:"Software used to create the image"},{keyword:"Comment",icon:"mdi-comment-text",description:"Miscellaneous comment"},{keyword:"Source",icon:"mdi-source-branch",description:"Device used to create the image"}],s=se({get:()=>a.modelValue,set:P=>e("update:modelValue",P)}),o=se(()=>[P=>!!P||"Keyword is required",P=>P&&P.length<=79||"Keyword must be 79 characters or less",P=>P&&P.trim()===P||"Keyword should not have leading/trailing spaces"]),h=se(()=>t.value&&i.value&&t.value.length<=79&&t.value.trim()===t.value&&!n.value),y=()=>{if(!t.value){n.value="";return}const P=ja(t.value);n.value=P.valid?"":P.error},b=P=>{t.value=P,y()},v=()=>{h.value&&(e("add-field",{keyword:t.value,value:i.value}),C(),s.value=!1)},F=()=>{C(),e("cancel"),s.value=!1},C=()=>{t.value="",i.value="",n.value=""};return Ve(()=>a.modelValue,P=>{P||C()}),{dialog:s,keyword:t,value:i,keywordError:n,keywordRules:o,standardKeywords:r,isValid:h,validateKeyword:y,applyKeyword:b,addField:v,closeDialog:F}}},dn=a=>(rt("data-v-626d211f"),a=a(),st(),a),un=dn(()=>O("strong",null,"PNG Text Chunks:",-1)),fn={class:"text-caption text-medium-emphasis mt-2"};function hn(a,e,t,i,n,r){const s=S("v-icon"),o=S("v-card-title"),h=S("v-alert"),y=S("v-text-field"),b=S("v-expansion-panel-title"),v=S("v-list-item-title"),F=S("v-list-item-subtitle"),C=S("v-list-item"),P=S("v-list"),G=S("v-expansion-panel-text"),K=S("v-expansion-panel"),J=S("v-expansion-panels"),ne=S("v-textarea"),z=S("v-card-text"),Z=S("v-spacer"),l=S("v-btn"),c=S("v-card-actions"),f=S("v-card"),g=S("v-dialog");return T(),E(g,{modelValue:i.dialog,"onUpdate:modelValue":e[2]||(e[2]=p=>i.dialog=p),"max-width":"600",persistent:""},{default:u(()=>[d(f,null,{default:u(()=>[d(o,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(s,{icon:"mdi-plus-circle",class:"mr-2"}),k(" Add PNG Text Field ")]),_:1}),d(z,{class:"pa-4"},{default:u(()=>[d(h,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:u(()=>[un,k(" PNG images store metadata as keyword-value pairs in tEXt chunks. Use standard keywords or create custom ones for your needs. ")]),_:1}),d(y,{modelValue:i.keyword,"onUpdate:modelValue":[e[0]||(e[0]=p=>i.keyword=p),i.validateKeyword],label:"Keyword",variant:"outlined",density:"comfortable",hint:"1-79 Latin-1 characters (e.g., 'Title', 'Author', 'MyCustomField')","persistent-hint":"",rules:i.keywordRules,"error-messages":i.keywordError,class:"mb-3"},{"prepend-inner":u(()=>[d(s,{icon:"mdi-tag",size:"small"})]),_:1},8,["modelValue","rules","error-messages","onUpdate:modelValue"]),d(J,{class:"mb-4"},{default:u(()=>[d(K,null,{default:u(()=>[d(b,null,{default:u(()=>[d(s,{icon:"mdi-lightbulb",class:"mr-2",size:"small"}),k(" Standard PNG Keywords ")]),_:1}),d(G,null,{default:u(()=>[d(P,{density:"compact"},{default:u(()=>[(T(!0),oe(Ee,null,Re(i.standardKeywords,p=>(T(),E(C,{key:p.keyword,onClick:m=>i.applyKeyword(p.keyword),class:"suggestion-item"},{prepend:u(()=>[d(s,{icon:p.icon,size:"small"},null,8,["icon"])]),default:u(()=>[d(v,null,{default:u(()=>[k(N(p.keyword),1)]),_:2},1024),d(F,{class:"text-caption"},{default:u(()=>[k(N(p.description),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),d(ne,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=p=>i.value=p),label:"Value",variant:"outlined",density:"comfortable",rows:"4",hint:"Text value for this field (UTF-8 supported)","persistent-hint":"",rules:[p=>!!p||"Value is required"]},{"prepend-inner":u(()=>[d(s,{icon:"mdi-text",size:"small"})]),_:1},8,["modelValue","rules"]),O("div",fn," Keyword: "+N(i.keyword.length)+"/79 characters | Value: "+N(i.value.length)+" characters ",1)]),_:1}),d(c,{class:"pa-4 pt-0"},{default:u(()=>[d(Z),d(l,{variant:"text",onClick:i.closeDialog},{default:u(()=>[k(" Cancel ")]),_:1},8,["onClick"]),d(l,{color:"primary",variant:"elevated",disabled:!i.isValid,onClick:i.addField},{default:u(()=>[d(s,{start:"",icon:"mdi-plus"}),k(" Add Field ")]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const mn=nt(cn,[["render",hn],["__scopeId","data-v-626d211f"]]),pn={name:"MetadataFieldEditor",props:{modelValue:{type:Boolean,default:!1},field:{type:Object,default:null}},emits:["update:modelValue","save","remove","cancel"],setup(a,{emit:e}){const t=j(""),i=j(null),n=se({get:()=>a.modelValue,set:v=>e("update:modelValue",v)}),r=se(()=>{var v;return t.value!==null&&t.value!==void 0&&t.value!==""&&t.value!==((v=a.field)==null?void 0:v.value)&&!i.value}),s=v=>{if(!v)return"";const F={DateTime:"Format: YYYY:MM:DD HH:MM:SS",DateTimeOriginal:"Format: YYYY:MM:DD HH:MM:SS",DateTimeDigitized:"Format: YYYY:MM:DD HH:MM:SS",Copyright:"Copyright notice or author name",Artist:"Photographer or creator name",Make:"Camera manufacturer (e.g., Canon, Nikon)",Model:"Camera model (e.g., EOS 5D)",ImageDescription:"Brief description of the image",UserComment:"User-defined comment or notes"};for(const[C,P]of Object.entries(F))if(v.label.includes(C))return P;return"Enter new value for this field"},o=v=>{var F;if(!v)return"Value cannot be empty";if(v.length>500)return"Value too long (max 500 characters)";if((F=a.field)!=null&&F.type){const C=Ci(v,a.field.type);if(!C.valid)return C.warning}return null},h=()=>{const v=o(t.value);if(v){i.value=v;return}e("save",{field:a.field,newValue:t.value}),t.value="",i.value=null,n.value=!1},y=()=>{e("remove",a.field),t.value="",i.value=null,n.value=!1},b=()=>{e("cancel"),t.value="",i.value=null,n.value=!1};return Ve(()=>a.field,v=>{v&&(t.value=v.value||"",i.value=null)},{immediate:!0}),Ve(t,()=>{i.value=null}),{dialog:n,editedValue:t,validationError:i,canSave:r,getFieldHint:s,validateValue:o,save:h,remove:y,cancel:b}}},Ui=a=>(rt("data-v-bb6e50e9"),a=a(),st(),a),gn={class:"mb-4"},yn=Ui(()=>O("div",{class:"text-caption text-medium-emphasis mb-1"},"Field",-1)),Sn={class:"text-body-1 font-weight-medium d-flex align-center"},vn={class:"mb-4"},bn=Ui(()=>O("div",{class:"text-caption text-medium-emphasis mb-1"},"Original Value",-1)),Cn={class:"text-body-2 pa-2 rounded bg-surface-variant"};function Pn(a,e,t,i,n,r){const s=S("v-icon"),o=S("v-card-title"),h=S("v-alert"),y=S("v-chip"),b=S("v-text-field"),v=S("v-card-text"),F=S("v-btn"),C=S("v-spacer"),P=S("v-card-actions"),G=S("v-card"),K=S("v-dialog");return T(),E(K,{modelValue:i.dialog,"onUpdate:modelValue":e[1]||(e[1]=J=>i.dialog=J),"max-width":"600",persistent:""},{default:u(()=>[d(G,null,{default:u(()=>[d(o,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(s,{icon:"mdi-pencil",class:"mr-2"}),k(" Edit Metadata Field ")]),_:1}),d(v,{class:"pa-4"},{default:u(()=>{var J,ne,z,Z,l,c;return[(J=t.field)!=null&&J.editWarning?(T(),E(h,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:u(()=>[d(s,{icon:"mdi-alert-circle-outline",size:"small",class:"mr-2"}),k(" "+N(t.field.editWarning),1)]),_:1})):B("",!0),O("div",gn,[yn,O("div",Sn,[d(s,{icon:((ne=t.field)==null?void 0:ne.icon)||"mdi-tag",size:"small",class:"mr-2",color:"grey"},null,8,["icon"]),k(" "+N((z=t.field)==null?void 0:z.label)+" ",1),(Z=t.field)!=null&&Z.type?(T(),E(y,{key:0,size:"x-small",variant:"outlined",color:"info",class:"ml-2"},{default:u(()=>[k(N(t.field.type),1)]),_:1})):B("",!0)])]),O("div",vn,[bn,O("div",Cn,N(((l=t.field)==null?void 0:l.value)||"N/A"),1)]),d(b,{modelValue:i.editedValue,"onUpdate:modelValue":e[0]||(e[0]=f=>i.editedValue=f),label:"New Value",variant:"outlined",density:"comfortable",clearable:"",autofocus:"",placeholder:(c=t.field)==null?void 0:c.value,hint:i.getFieldHint(t.field),"persistent-hint":"",onKeydown:Ki(i.save,["enter"])},{"prepend-inner":u(()=>[d(s,{icon:"mdi-pencil-outline",size:"small"})]),_:1},8,["modelValue","placeholder","hint","onKeydown"]),i.validationError?(T(),E(h,{key:1,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:u(()=>[k(N(i.validationError),1)]),_:1})):B("",!0)]}),_:1}),d(P,{class:"bg-surface-variant"},{default:u(()=>[d(F,{variant:"text",onClick:i.cancel},{default:u(()=>[k(" Cancel ")]),_:1},8,["onClick"]),d(C),d(F,{color:"error",variant:"text","prepend-icon":"mdi-delete",onClick:i.remove},{default:u(()=>[k(" Remove Field ")]),_:1},8,["onClick"]),d(F,{color:"primary",variant:"elevated","prepend-icon":"mdi-content-save",onClick:i.save,disabled:!i.canSave},{default:u(()=>[k(" Save Changes ")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const xn=nt(pn,[["render",Pn],["__scopeId","data-v-bb6e50e9"]]),wn={name:"MetadataViewer",props:{sections:{type:Object,required:!0},editable:{type:Boolean,default:!1},showQuickActions:{type:Boolean,default:!1}},emits:["edit-field","remove-field"],setup(a){const e=j(null),t=se(()=>!e.value||!a.sections?null:a.sections[e.value]);return Ve(()=>a.sections,i=>{if(i&&Object.keys(i).length>0){const n=Object.keys(i)[0];e.value=n}else e.value=null},{immediate:!0}),{selectedSection:e,currentSection:t}}},lt=a=>(rt("data-v-f946027e"),a=a(),st(),a),_n={key:0},kn=lt(()=>O("span",{class:"text-body-1"},"Categories",-1)),In={class:"text-body-1"},Tn={class:"metadata-fields-table"},An={class:"table-col-label text-body-2 font-weight-medium"},Fn={class:"tooltip-content"},Dn={class:"table-col-value text-body-2"},En={class:"table-col-actions-sm"},Rn=lt(()=>O("p",{class:"text-h6 text-medium-emphasis mt-4"},"Select a Category",-1)),Ln=lt(()=>O("p",{class:"text-body-2 text-medium-emphasis"}," Click a category on the left to view its metadata fields. ",-1)),Mn=lt(()=>O("p",{class:"text-h6 text-medium-emphasis mt-4"},"No Metadata Found",-1)),On=lt(()=>O("p",{class:"text-body-2 text-medium-emphasis"}," This image does not contain any EXIF metadata, or the metadata could not be read. ",-1));function Gn(a,e,t,i,n,r){const s=S("v-card-title"),o=S("v-icon"),h=S("v-list-item-title"),y=S("v-list-item-subtitle"),b=S("v-list-item"),v=S("v-list"),F=S("v-card"),C=S("v-col"),P=S("v-alert"),G=S("v-tooltip"),K=S("v-chip"),J=S("v-btn"),ne=S("v-table"),z=S("v-card-text"),Z=S("v-row");return t.sections&&Object.keys(t.sections).length>0?(T(),oe("div",_n,[d(Z,null,{default:u(()=>[d(C,{cols:"12",md:"4",lg:"3"},{default:u(()=>[d(F,{elevation:"2"},{default:u(()=>[d(s,{class:"bg-surface-variant pa-2"},{default:u(()=>[kn]),_:1}),d(v,{density:"compact",class:"pa-0"},{default:u(()=>[(T(!0),oe(Ee,null,Re(t.sections,(l,c)=>(T(),E(b,{key:c,value:c,active:i.selectedSection===c,onClick:f=>i.selectedSection=c,class:"list-item-hover"},{prepend:u(()=>[d(o,{icon:l.icon,color:l.color,size:"small"},null,8,["icon","color"])]),default:u(()=>[d(h,{class:"text-body-2"},{default:u(()=>[k(N(l.name),1)]),_:2},1024),d(y,{class:"text-caption"},{default:u(()=>[k(N(l.fields.length)+" field"+N(l.fields.length!==1?"s":""),1)]),_:2},1024)]),_:2},1032,["value","active","onClick"]))),128))]),_:1})]),_:1})]),_:1}),d(C,{cols:"12",md:"8",lg:"9"},{default:u(()=>[i.currentSection?(T(),E(F,{key:0,elevation:"2"},{default:u(()=>[d(s,{class:"bg-surface-variant pa-2"},{default:u(()=>[d(o,{icon:i.currentSection.icon,color:i.currentSection.color,size:"small",class:"mr-2"},null,8,["icon","color"]),O("span",In,N(i.currentSection.name),1)]),_:1}),i.currentSection.description?(T(),E(P,{key:0,color:"info",variant:"tonal",density:"compact",class:"ma-3"},{default:u(()=>[k(N(i.currentSection.description),1)]),_:1})):B("",!0),O("div",Tn,[d(ne,{density:"compact"},{default:u(()=>[O("tbody",null,[(T(!0),oe(Ee,null,Re(i.currentSection.fields,l=>(T(),oe("tr",{key:l.key},[O("td",An,[d(o,{icon:l.icon,size:"x-small",color:"grey",class:"mr-2"},null,8,["icon"]),k(" "+N(l.label)+" ",1),l.editWarning?(T(),E(G,{key:0,location:"top"},{activator:u(({props:c})=>[d(o,vi(c,{icon:"mdi-information-outline",size:"x-small",color:"info",class:"ml-1"}),null,16)]),default:u(()=>[O("span",Fn,N(l.editWarning),1)]),_:2},1024)):B("",!0)]),O("td",Dn,[O("span",{class:Ji({"text-medium-emphasis":!l.isPopulated})},N(l.value),3),l.isPopulated?B("",!0):(T(),E(K,{key:0,size:"x-small",variant:"text",color:"grey",class:"ml-2"},{default:u(()=>[k(" empty ")]),_:1}))]),O("td",En,[t.editable&&l.editable?(T(),E(J,{key:0,icon:"mdi-pencil",size:"x-small",variant:"text",color:"primary",onClick:c=>a.$emit("edit-field",l)},{default:u(()=>[d(o,{size:"small"},{default:u(()=>[k("mdi-pencil")]),_:1}),d(G,{activator:"parent",location:"top"},{default:u(()=>[k("Edit field")]),_:1})]),_:2},1032,["onClick"])):B("",!0),t.editable&&l.editable?(T(),E(J,{key:1,icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:c=>a.$emit("remove-field",l)},{default:u(()=>[d(o,{size:"small"},{default:u(()=>[k("mdi-delete")]),_:1}),d(G,{activator:"parent",location:"top"},{default:u(()=>[k("Remove this field")]),_:1})]),_:2},1032,["onClick"])):l.warning&&t.showQuickActions?(T(),E(J,{key:2,icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:c=>a.$emit("remove-field",l)},{default:u(()=>[d(o,{size:"small"},{default:u(()=>[k("mdi-delete")]),_:1}),d(G,{activator:"parent",location:"top"},{default:u(()=>[k("Remove this field")]),_:1})]),_:2},1032,["onClick"])):B("",!0)])]))),128))])]),_:1})])]),_:1})):(T(),E(F,{key:1,variant:"tonal",color:"grey-lighten-4",elevation:"0"},{default:u(()=>[d(z,{class:"text-center pa-8"},{default:u(()=>[d(o,{icon:"mdi-arrow-left",size:"64",color:"grey"}),Rn,Ln]),_:1})]),_:1}))]),_:1})]),_:1})])):(T(),E(F,{key:1,variant:"tonal",color:"grey-lighten-4",elevation:"0"},{default:u(()=>[d(z,{class:"text-center pa-8"},{default:u(()=>[d(o,{icon:"mdi-image-off",size:"64",color:"grey"}),Mn,On]),_:1})]),_:1}))}const Nn=nt(wn,[["render",Gn],["__scopeId","data-v-f946027e"]]),Un={name:"MetadataEditor",components:{AddCustomFieldDialog:ln,AddPngFieldDialog:mn,CardSectionHeader:$i,FileUpload:Hi,MetadataFieldEditor:xn,MetadataViewer:Nn,SharedSnackbar:Qi,ToolPageHeader:qi},setup(){const a=j(null),e=j(null),t=j([]),i=j(""),n=j(""),r=j(null),s=j(H.UNKNOWN),o=j(null),h=j(!1),y=j("Processing..."),b=j(null),v=j(null),F=j(null),C=j(null),P=j(null),G=j(null),K=j(!1),J=j(!1),ne=j(!1),{snackbar:z,snackbarColor:Z,snackbarText:l,showSnackbar:c}=Zi(),f=se(()=>!G.value||!b.value?null:b.value[G.value]),g=se(()=>{const x=new Set;return t.value.forEach(A=>{A.field&&typeof A.field=="object"&&A.field.key&&x.add(A.field.key)}),x}),p=x=>g.value.has(x.key),m=x=>{if(!C.value)return!1;for(const A of Object.values(C.value)){const M=A.fields.find(W=>W.key===x.key);if(M&&M.isPopulated&&!x.isPopulated)return!0}return!1},_=x=>{if(!C.value)return null;for(const A of Object.values(C.value)){const M=A.fields.find(W=>W.key===x.key);if(M)return M.value}return null},I=async x=>{const A=_(x);if(A===null||A===""){c("❌ No original value to restore","error");return}await ke({field:x,newValue:A}),t.value=t.value.filter(M=>!(M.field&&M.field.key===x.key)),c(`✓ Field "${x.label}" restored to original value`,"success")},L=se(()=>b.value?getMetadataStats(b.value):{totalFields:0,sections:0,editableFields:0,privacyFields:0,hasGPS:!1,hasCameraInfo:!1,hasTimestamps:!1,hasAuthorInfo:!1}),D=se(()=>t.value.length>0),V=se(()=>t.value.length),U=se(()=>{if(!b.value||!b.value.Location)return console.log("[GPS] No metadata or Location section"),!1;const x=b.value.Location.fields,A=x.find(ue=>ue.key==="GPS.2"),M=x.find(ue=>ue.key==="GPS.4");if(console.log("[GPS] latField:",A),console.log("[GPS] lonField:",M),!A||!M)return console.log("[GPS] Missing lat or lon field"),!1;const W=parseFloat(A.value),q=parseFloat(M.value);console.log("[GPS] lat:",W,"lon:",q),console.log("[GPS] isPopulated:",A.isPopulated,M.isPopulated);const de=A.isPopulated&&M.isPopulated&&!isNaN(W)&&!isNaN(q)&&(W!==0||q!==0);return console.log("[GPS] hasValidGpsCoordinates:",de),de}),ye=se(()=>{if(!U.value||!b.value)return"";const x=b.value.Location.fields,A=x.find(ie=>ie.key==="GPS.2"),M=x.find(ie=>ie.key==="GPS.4"),W=x.find(ie=>ie.key==="GPS.1"),q=x.find(ie=>ie.key==="GPS.3");let de=parseFloat(A.value.replace("°","")),ue=parseFloat(M.value.replace("°",""));return W&&W.value==="S"&&(de=-de),q&&q.value==="W"&&(ue=-ue),`https://www.google.com/maps/search/?api=1&query=${de},${ue}`}),w=async x=>{if(x){h.value=!0,y.value="Analyzing metadata...";try{i.value=x.name,n.value=Wi(x.size);const A=await ua(x);r.value=A;const M=Qa(x);if(s.value=M,M===H.UNKNOWN){c("❌ Unsupported image format. Please use JPEG or PNG.","error");return}o.value=A;const W=await et(A,M);if(b.value=W,C.value=JSON.parse(JSON.stringify(W)),F.value=A,Object.keys(W).length===0)c(`ℹ️ No metadata found in this ${M} image`,"info");else{const q=an(W,M);c(`✓ Found ${q.populatedFields} populated field${q.populatedFields!==1?"s":""} in the ${M} image`,"success")}a.value=null,v.value=null,t.value=[]}catch(A){console.error("Analysis error:",A),c(`❌ ${A.message}`,"error"),b.value=null}finally{h.value=!1}}},X=async()=>{if(r.value){h.value=!0,y.value="Removing all metadata...";try{const x=await en(r.value,s.value),A=tt(s.value);a.value=`data:${A};base64,`+x,c("✓ All metadata removed successfully!","success");const M=Ft(a.value),W=Gt(s.value),q=i.value.replace(/\.[^/.]+$/,"")+`_clean.${W}`;At(M,q)}catch(x){console.error("Metadata removal error:",x),c(`❌ Failed to remove metadata: ${x.message}`,"error")}finally{h.value=!1}}},te=()=>{if(!a.value)return;const x=Ft(a.value),A=Gt(s.value),M=i.value.replace(/\.[^/.]+$/,"")+`_clean.${A}`;At(x,M),c("✓ Clean image downloaded!","success")},Ue=x=>{e.value=x,J.value=!0},fe=()=>{e.value=null,J.value=!1},ke=async({field:x,newValue:A})=>{if(r.value){h.value=!0,y.value="Saving changes...";try{const M=await Za(r.value,s.value,x,A),W=tt(s.value);r.value=`data:${W};base64,`+M,v.value=r.value;const q=await et(r.value,s.value);b.value=q,t.value.push({field:x,oldValue:x.value,newValue:A,timestamp:new Date}),c(`✓ Field "${x.label}" updated successfully!`,"success")}catch(M){console.error("Field edit error:",M),c(`❌ Failed to edit field: ${M.message}`,"error")}finally{h.value=!1}}},He=async x=>{if(r.value){h.value=!0,y.value="Removing field...";try{const A=await $a(r.value,s.value,x),M=tt(s.value);r.value=`data:${M};base64,`+A,v.value=r.value;const W=await et(r.value,s.value);b.value=W,t.value.push({field:x.label,oldValue:x.value,newValue:"[Removed]",timestamp:new Date}),c(`✓ Field "${x.label}" removed successfully!`,"success")}catch(A){console.error("Field removal error:",A),c(`❌ Failed to remove field: ${A.message}`,"error")}finally{h.value=!1}}},Ie=()=>{if(!v.value)return;const x=Ft(v.value),A=Gt(s.value),M=i.value.replace(/\.[^/.]+$/,"")+`_modified.${A}`;At(x,M),c("✓ Modified image downloaded!","success")},dt=()=>{!F.value||!C.value||(r.value=F.value,b.value=JSON.parse(JSON.stringify(C.value)),v.value=null,t.value=[],c("✓ Changes discarded","info"))},We=async()=>{if(r.value){if(s.value!==H.JPEG){c('Clear all values is only supported for JPEG images. Use "Download Clean" to remove all PNG metadata.',"info");return}h.value=!0,y.value="Clearing metadata values...";try{const x=await pa(r.value),A=tt(s.value);r.value=`data:${A};base64,`+x,v.value=r.value;const M=await et(r.value,s.value);b.value=M,t.value.push({field:"All Fields",oldValue:"Various values",newValue:"[Cleared]",timestamp:new Date}),c("✓ All metadata values cleared. Fields are now empty and ready for editing.","success")}catch(x){console.error("Clear metadata error:",x),c(`❌ Failed to clear metadata: ${x.message}`,"error")}finally{h.value=!1}}},Xe=async x=>{if(r.value){h.value=!0,y.value="Adding custom field...";try{const A=await tn(r.value,s.value,x),M=tt(s.value);r.value=`data:${M};base64,`+A,v.value=r.value;const W=await et(r.value,s.value);b.value=W;let q;s.value===H.JPEG?q=`${x.ifd}.${x.tagId}`:s.value===H.PNG&&(q=x.keyword);let de=null;for(const ue of Object.values(W))if(de=ue.fields.find(ie=>ie.key===q),de)break;t.value.push({field:de||{key:q,label:x.label||x.keyword},oldValue:"[Not set]",newValue:x.value,timestamp:new Date}),c(`✓ Custom field "${x.label||x.keyword}" added successfully!`,"success")}catch(A){console.error("Add custom field error:",A),c(`❌ Failed to add custom field: ${A.message}`,"error")}finally{h.value=!1}}},Se=()=>{var x,A,M;(x=o.value)!=null&&x.startsWith("blob:")&&URL.revokeObjectURL(o.value),(A=v.value)!=null&&A.startsWith("blob:")&&URL.revokeObjectURL(v.value),(M=a.value)!=null&&M.startsWith("blob:")&&URL.revokeObjectURL(a.value)};return Ve(P,(x,A)=>{A&&Se(),x?w(x):(Se(),b.value=null,r.value=null,s.value=H.UNKNOWN,o.value=null,a.value=null,v.value=null,F.value=null,C.value=null,t.value=[],i.value="",n.value="",G.value=null)}),Ve(b,x=>{if(x&&Object.keys(x).length>0){const A=Object.keys(x)[0];G.value=A}else G.value=null}),Yi(()=>{Se()}),{cleanedImageUrl:a,currentEditField:e,currentSection:f,editCount:V,fileName:i,fileSize:n,googleMapsUrl:ye,hasValidGpsCoordinates:U,imageFormat:s,imagePreviewUrl:o,isModified:D,isProcessing:h,loadingMessage:y,metadata:b,modifiedImageUrl:v,selectedFile:P,selectedSection:G,showAddFieldDialog:K,showFieldEditor:J,showImageDialog:ne,stats:L,snackbar:z,snackbarColor:Z,snackbarText:l,IMAGE_FORMATS:H,addCustomFieldToImage:Xe,clearMetadataValues:We,closeFieldEditor:fe,confirmRemoveField:He,discardChanges:dt,downloadCleanImage:te,downloadModifiedImage:Ie,executeRemoveAll:X,isClearedField:m,isFieldModified:p,openFieldEditor:Ue,restoreField:I,saveFieldEdit:ke}}},ct=a=>(rt("data-v-4c5ed1ff"),a=a(),st(),a),Bn={class:"sidebar-sticky"},Vn={class:"preview-overlay"},zn=ct(()=>O("div",{class:"text-caption text-white mt-1"},"Click to expand",-1)),jn={class:"text-caption text-medium-emphasis mt-2"},Hn={class:"text-caption text-medium-emphasis"},Wn={key:0,class:"text-caption text-warning mt-1"},Xn=ct(()=>O("div",{class:"text-caption text-medium-emphasis mb-2 font-weight-medium"}," Attribute Actions ",-1)),Kn=ct(()=>O("div",{class:"text-caption text-medium-emphasis mb-2 font-weight-medium"}," Download Actions ",-1)),Jn={class:"metadata-fields-table"},Yn={class:"table-col-label text-body-2 font-weight-medium"},qn={class:"tooltip-content"},Qn={class:"table-col-value text-body-2"},Zn={key:0},$n={class:"table-col-actions-md"},er={class:"d-sm-none"},tr={class:"d-flex align-center mb-2"},ir={class:"text-body-2 font-weight-medium"},ar={class:"text-body-2 mb-2",style:{"word-break":"break-word"}},nr={key:0},rr={class:"d-flex gap-2"},sr=ct(()=>O("p",{class:"text-h6 text-medium-emphasis mt-4"},"Select a Category",-1)),or=ct(()=>O("p",{class:"text-body-2 text-medium-emphasis"}," Click a category on the left to view its metadata fields. ",-1)),lr={class:"text-h6 mt-4"},cr={class:"text-caption text-medium-emphasis"};function dr(a,e,t,i,n,r){const s=S("ToolPageHeader"),o=S("v-icon"),h=S("v-card-title"),y=S("FileUpload"),b=S("v-card-text"),v=S("v-card"),F=S("v-chip"),C=S("v-progress-circular"),P=S("v-row"),G=S("v-img"),K=S("v-col"),J=S("v-list-item-title"),ne=S("v-list-item-subtitle"),z=S("v-list-item"),Z=S("v-list"),l=S("v-btn"),c=S("v-divider"),f=S("v-tooltip"),g=S("v-alert"),p=S("v-table"),m=S("v-spacer"),_=S("SharedSnackbar"),I=S("MetadataFieldEditor"),L=S("AddCustomFieldDialog"),D=S("AddPngFieldDialog"),V=S("v-overlay"),U=S("v-card-actions"),ye=S("v-dialog");return T(),oe("div",null,[d(s,{icon:"mdi-image-filter-hdr",title:"Metadata Editor",description:"View, edit, and remove metadata from JPEG and PNG images for complete privacy control","avatar-color":"warning"}),d(P,null,{default:u(()=>[d(K,{cols:"12",lg:"4",md:"5",class:"sidebar-column"},{default:u(()=>[O("div",Bn,[d(v,{class:"mb-3"},{default:u(()=>[d(h,{class:"bg-surface-variant"},{default:u(()=>[d(o,{icon:"mdi-image",class:"mr-2"}),k(" Edit image metadata ")]),_:1}),d(b,{class:"pa-3"},{default:u(()=>[d(y,{modelValue:i.selectedFile,"onUpdate:modelValue":e[0]||(e[0]=w=>i.selectedFile=w),label:"Select Image",accept:".jpg,.jpeg,.png","prepend-icon":"mdi-camera",hint:"Supported formats: JPEG, PNG"},null,8,["modelValue"])]),_:1})]),_:1}),i.metadata&&i.imagePreviewUrl?(T(),E(v,{key:0},{actions:u(()=>[i.isModified?(T(),E(F,{key:0,size:"x-small",color:"warning",variant:"flat",class:"ml-2"},{default:u(()=>[d(o,{start:"",icon:"mdi-pencil",size:"x-small"}),k(" Modified ")]),_:1})):B("",!0)]),default:u(()=>[d(h,{class:"bg-surface-variant"},{default:u(()=>[d(o,{icon:"mdi-image",class:"mr-2"}),k(" Preview ")]),_:1}),d(b,{class:"pa-3"},{default:u(()=>[d(G,{src:i.isModified?i.modifiedImageUrl:i.imagePreviewUrl,"aspect-ratio":"1",class:"rounded cursor-pointer preview-thumbnail",cover:"",onClick:e[1]||(e[1]=w=>i.showImageDialog=!0)},{placeholder:u(()=>[d(P,{align:"center",justify:"center",class:"fill-height"},{default:u(()=>[d(C,{indeterminate:"",size:"32"})]),_:1})]),default:u(()=>[O("div",Vn,[d(o,{icon:"mdi-magnify-plus-outline",size:"32",color:"white"}),zn])]),_:1},8,["src"]),O("div",jn,N(i.fileName),1),O("div",Hn,N(i.fileSize),1),i.isModified?(T(),oe("div",Wn,[d(o,{icon:"mdi-alert",size:"x-small",class:"mr-1"}),k(" "+N(i.editCount)+" unsaved change"+N(i.editCount!==1?"s":""),1)])):B("",!0)]),_:1})]),_:1})):B("",!0)])]),_:1}),d(K,{cols:"12",lg:"8",md:"7"},{default:u(()=>[i.metadata?(T(),E(P,{key:0},{default:u(()=>[d(K,{cols:"12",md:"4"},{default:u(()=>[d(v,null,{default:u(()=>[d(h,{class:"bg-surface-variant"},{default:u(()=>[d(o,{icon:"mdi-format-list-bulleted",class:"mr-2"}),k(" Categories ")]),_:1}),d(Z,{density:"compact",class:"pa-0"},{default:u(()=>[(T(!0),oe(Ee,null,Re(i.metadata,(w,X)=>(T(),E(z,{key:X,value:X,active:i.selectedSection===X,onClick:te=>i.selectedSection=X,class:"list-item-hover"},{prepend:u(()=>[d(o,{icon:w.icon,color:w.color,size:"small"},null,8,["icon","color"])]),default:u(()=>[d(J,{class:"text-body-2"},{default:u(()=>[k(N(w.name)+" ",1),w.fields.filter(te=>i.isFieldModified(te)).length>0?(T(),E(F,{key:0,size:"x-small",variant:"flat",color:"warning",class:"ml-2"},{default:u(()=>[k(N(w.fields.filter(te=>i.isFieldModified(te)).length)+" modified ",1)]),_:2},1024)):B("",!0)]),_:2},1024),d(ne,{class:"text-caption"},{default:u(()=>[k(N(w.fields.filter(te=>te.isPopulated).length)+" / "+N(w.fields.length)+" populated ",1)]),_:2},1024)]),_:2},1032,["value","active","onClick"]))),128))]),_:1})]),_:1}),d(v,{class:"mt-3"},{default:u(()=>[d(h,{class:"bg-surface-variant"},{default:u(()=>[d(o,{icon:"mdi-cog",class:"mr-2"}),k(" Actions ")]),_:1}),d(b,{class:"pa-3"},{default:u(()=>[Xn,d(l,{color:"primary",variant:"elevated","prepend-icon":"mdi-plus-circle",onClick:e[2]||(e[2]=w=>i.showAddFieldDialog=!0),size:"small",block:"",class:"mb-2"},{default:u(()=>[k(" Add Custom Field ")]),_:1}),d(l,{color:"error",variant:"outlined","prepend-icon":"mdi-eraser",onClick:i.clearMetadataValues,size:"small",block:"",disabled:i.isModified,class:"mb-2"},{default:u(()=>[k(" Clear All Values ")]),_:1},8,["onClick","disabled"]),i.isModified?(T(),E(l,{key:0,color:"grey",variant:"outlined","prepend-icon":"mdi-undo",onClick:i.discardChanges,size:"small",block:"",class:"mb-4"},{default:u(()=>[k(" Discard Changes ")]),_:1},8,["onClick"])):B("",!0),i.isModified?(T(),E(c,{key:1,class:"my-3"})):(T(),E(c,{key:2,class:"my-2"})),Kn,i.isModified?(T(),E(l,{key:3,color:"success",variant:"elevated","prepend-icon":"mdi-download",onClick:i.downloadModifiedImage,size:"small",block:"",class:"mb-2"},{default:u(()=>[k(" Download Modified ")]),_:1},8,["onClick"])):B("",!0),d(l,{color:"error",variant:"elevated","prepend-icon":"mdi-shield-lock",onClick:i.executeRemoveAll,size:"small",block:""},{default:u(()=>[k(" Download Clean ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),d(K,{cols:"12",md:"8"},{default:u(()=>[i.currentSection?(T(),E(v,{key:0},{default:u(()=>[d(h,{class:"bg-surface-variant"},{default:u(()=>[d(o,{icon:i.currentSection.icon,color:i.currentSection.color},null,8,["icon","color"]),k(" "+N(i.currentSection.name)+" ",1),i.selectedSection==="Location"&&i.hasValidGpsCoordinates?(T(),E(l,{key:0,href:i.googleMapsUrl,target:"_blank",size:"small",variant:"text",color:"primary","prepend-icon":"mdi-map-marker",class:"ml-3"},{default:u(()=>[k(" View on Maps "),d(f,{activator:"parent",location:"bottom"},{default:u(()=>[k("Open coordinates in Google Maps")]),_:1})]),_:1},8,["href"])):B("",!0)]),_:1}),i.currentSection.description?(T(),E(g,{key:0,color:"info",variant:"tonal",density:"compact",class:"ma-3"},{default:u(()=>[k(N(i.currentSection.description),1)]),_:1})):B("",!0),O("div",Jn,[d(p,{density:"compact",class:"d-none d-sm-table"},{default:u(()=>[O("tbody",null,[(T(!0),oe(Ee,null,Re(i.currentSection.fields,w=>(T(),oe("tr",{key:w.key},[O("td",Yn,[k(N(w.label)+" ",1),i.isFieldModified(w)&&!i.isClearedField(w)?(T(),E(o,{key:0,icon:"mdi-pencil",size:"x-small",color:"warning",class:"ml-1"})):B("",!0),i.isClearedField(w)?(T(),E(o,{key:1,icon:"mdi-delete",size:"x-small",color:"error",class:"ml-1"})):B("",!0),w.editWarning?(T(),E(f,{key:2,location:"top"},{activator:u(({props:X})=>[d(o,vi(X,{icon:"mdi-information-outline",size:"x-small",color:"info",class:"ml-1"}),null,16)]),default:u(()=>[O("span",qn,N(w.editWarning),1)]),_:2},1024)):B("",!0)]),O("td",Qn,[w.isPopulated||i.isFieldModified(w)?(T(),oe("span",Zn,N(w.value),1)):B("",!0),!w.isPopulated&&!i.isFieldModified(w)?(T(),E(F,{key:1,size:"x-small",variant:"text",color:"grey"},{default:u(()=>[k(" empty ")]),_:1})):B("",!0)]),O("td",$n,[i.isFieldModified(w)||i.isClearedField(w)?(T(),E(l,{key:0,icon:"mdi-restore",size:"x-small",variant:"text",color:"success",onClick:X=>i.restoreField(w)},{default:u(()=>[d(o,{size:"small"},{default:u(()=>[k("mdi-restore")]),_:1}),d(f,{activator:"parent",location:"top"},{default:u(()=>[k("Restore original value")]),_:1})]),_:2},1032,["onClick"])):B("",!0),w.editable?(T(),E(l,{key:1,icon:"mdi-pencil",size:"x-small",variant:"text",color:"primary",onClick:X=>i.openFieldEditor(w)},{default:u(()=>[d(o,{size:"small"},{default:u(()=>[k("mdi-pencil")]),_:1}),d(f,{activator:"parent",location:"top"},{default:u(()=>[k("Edit field")]),_:1})]),_:2},1032,["onClick"])):B("",!0),w.editable?(T(),E(l,{key:2,icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:X=>i.confirmRemoveField(w)},{default:u(()=>[d(o,{size:"small"},{default:u(()=>[k("mdi-delete")]),_:1}),d(f,{activator:"parent",location:"top"},{default:u(()=>[k("Remove this field")]),_:1})]),_:2},1032,["onClick"])):B("",!0)])]))),128))])]),_:1}),O("div",er,[(T(!0),oe(Ee,null,Re(i.currentSection.fields,w=>(T(),E(v,{key:w.key,variant:"outlined",class:"mb-2"},{default:u(()=>[d(b,{class:"pa-3"},{default:u(()=>[O("div",tr,[O("span",ir,N(w.label),1),d(m),i.isFieldModified(w)&&!i.isClearedField(w)?(T(),E(o,{key:0,icon:"mdi-pencil",size:"small",color:"warning"})):B("",!0),i.isClearedField(w)?(T(),E(o,{key:1,icon:"mdi-delete",size:"small",color:"error"})):B("",!0)]),O("div",ar,[w.isPopulated||i.isFieldModified(w)?(T(),oe("span",nr,N(w.value),1)):B("",!0),!w.isPopulated&&!i.isFieldModified(w)?(T(),E(F,{key:1,size:"x-small",variant:"text",color:"grey"},{default:u(()=>[k(" empty ")]),_:1})):B("",!0)]),O("div",rr,[i.isFieldModified(w)||i.isClearedField(w)?(T(),E(l,{key:0,size:"small",variant:"outlined",color:"success",onClick:X=>i.restoreField(w)},{default:u(()=>[d(o,{start:"",size:"small"},{default:u(()=>[k("mdi-restore")]),_:1}),k(" Restore ")]),_:2},1032,["onClick"])):B("",!0),w.editable?(T(),E(l,{key:1,size:"small",variant:"outlined",color:"primary",onClick:X=>i.openFieldEditor(w)},{default:u(()=>[d(o,{start:"",size:"small"},{default:u(()=>[k("mdi-pencil")]),_:1}),k(" Edit ")]),_:2},1032,["onClick"])):B("",!0),w.editable?(T(),E(l,{key:2,size:"small",variant:"outlined",color:"error",onClick:X=>i.confirmRemoveField(w)},{default:u(()=>[d(o,{start:"",size:"small"},{default:u(()=>[k("mdi-delete")]),_:1}),k(" Remove ")]),_:2},1032,["onClick"])):B("",!0)])]),_:2},1024)]),_:2},1024))),128))])])]),_:1})):(T(),E(v,{key:1,variant:"tonal",color:"grey-lighten-4",elevation:"0"},{default:u(()=>[d(b,{class:"text-center pa-8"},{default:u(()=>[d(o,{icon:"mdi-arrow-left",size:"64",color:"grey"}),sr,or]),_:1})]),_:1}))]),_:1})]),_:1})):B("",!0)]),_:1})]),_:1}),d(_,{modelValue:i.snackbar,"onUpdate:modelValue":e[3]||(e[3]=w=>i.snackbar=w),text:i.snackbarText,color:i.snackbarColor},null,8,["modelValue","text","color"]),d(I,{modelValue:i.showFieldEditor,"onUpdate:modelValue":e[4]||(e[4]=w=>i.showFieldEditor=w),field:i.currentEditField,onSave:i.saveFieldEdit,onRemove:i.confirmRemoveField,onCancel:i.closeFieldEditor},null,8,["modelValue","field","onSave","onRemove","onCancel"]),i.imageFormat===i.IMAGE_FORMATS.JPEG?(T(),E(L,{key:0,modelValue:i.showAddFieldDialog,"onUpdate:modelValue":e[5]||(e[5]=w=>i.showAddFieldDialog=w),onAddField:i.addCustomFieldToImage,onCancel:e[6]||(e[6]=w=>i.showAddFieldDialog=!1)},null,8,["modelValue","onAddField"])):B("",!0),i.imageFormat===i.IMAGE_FORMATS.PNG?(T(),E(D,{key:1,modelValue:i.showAddFieldDialog,"onUpdate:modelValue":e[7]||(e[7]=w=>i.showAddFieldDialog=w),onAddField:i.addCustomFieldToImage,onCancel:e[8]||(e[8]=w=>i.showAddFieldDialog=!1)},null,8,["modelValue","onAddField"])):B("",!0),d(V,{"model-value":i.isProcessing,class:"align-center justify-center"},{default:u(()=>[d(C,{indeterminate:"",size:"64",color:"warning"}),O("p",lr,N(i.loadingMessage),1)]),_:1},8,["model-value"]),d(ye,{modelValue:i.showImageDialog,"onUpdate:modelValue":e[10]||(e[10]=w=>i.showImageDialog=w),"max-width":"90vw"},{default:u(()=>[d(v,null,{default:u(()=>[d(h,{class:"d-flex align-center bg-surface-variant"},{default:u(()=>[d(o,{icon:"mdi-image",class:"mr-2"}),k(" "+N(i.fileName)+" ",1),d(m),d(l,{icon:"mdi-close",variant:"text",onClick:e[9]||(e[9]=w=>i.showImageDialog=!1)})]),_:1}),d(b,{class:"pa-0"},{default:u(()=>[d(G,{src:i.imagePreviewUrl,"max-height":"80vh",contain:""},{placeholder:u(()=>[d(P,{align:"center",justify:"center",class:"fill-height"},{default:u(()=>[d(C,{indeterminate:"",size:"64"})]),_:1})]),_:1},8,["src"])]),_:1}),d(U,{class:"bg-surface-variant"},{default:u(()=>[d(m),O("div",cr,N(i.fileSize),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const gr=nt(Un,[["render",dr],["__scopeId","data-v-4c5ed1ff"]]);export{gr as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
