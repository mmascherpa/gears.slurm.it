import{_ as N,c as d,j as x,b as u,g as i,w as _,f as S,t as b,e as g,p as q,h as R,o as h,F as A,D as M,q as U}from"./index-fTqGz_jn.js";const o={WEAK:35,MEDIUM:60,STRONG:80};function I(e){if(!e||e.length===0)return{entropy:0,charsetSize:0,length:0};let s=0;const t=/[a-z]/.test(e),n=/[A-Z]/.test(e),a=/\d/.test(e),r=/[^A-Za-z0-9]/.test(e);return t&&(s+=26),n&&(s+=26),a&&(s+=10),r&&(s+=32),{entropy:s>0?e.length*Math.log2(s):0,charsetSize:s,length:e.length,hasLowercase:t,hasUppercase:n,hasNumbers:a,hasSpecialChars:r}}function k(e){let s,t,n,a;return e<o.WEAK?(s="weak",t="error",n="Weak",a=e/o.WEAK*33):e<o.MEDIUM?(s="medium",t="warning",n="Medium",a=33+(e-o.WEAK)/(o.MEDIUM-o.WEAK)*34):e<o.STRONG?(s="strong",t="success",n="Strong",a=67+(e-o.MEDIUM)/(o.STRONG-o.MEDIUM)*23):(s="very-strong",t="success",n="Very Strong",a=100),{level:s,color:t,label:n,percentage:Math.min(100,Math.round(a))}}function z(e,s){const t=[],{length:n,hasLowercase:a,hasUppercase:r,hasNumbers:p,hasSpecialChars:c}=e;return s>=o.STRONG||(n<12?t.push("Use at least 12 characters"):n<16&&s<o.MEDIUM&&t.push("Consider using 16+ characters"),!r&&!a?t.push("Add letters to your password"):(!r||!a)&&t.push("Mix uppercase and lowercase letters"),p||t.push("Add numbers for more entropy"),c||t.push("Add special characters (!@#$%^&*)")),t}function B(e){if(!e||e.length===0)return{level:"empty",score:0,entropy:0,color:"grey",label:"Enter password",percentage:0,feedback:[],requirements:E(e,null)};const s=I(e),{entropy:t,hasLowercase:n,hasUppercase:a,hasNumbers:r,hasSpecialChars:p}=s,c=k(t),m=z(s,t),f=/abc|bcd|cde|123|234|345|456|567|678|789/i.test(e),y=/(.)\1{2,}/.test(e);f&&m.unshift("Avoid sequential characters (abc, 123)"),y&&m.unshift("Avoid repeating characters (aaa, 111)");const l={hasLowercase:n,hasUppercase:a,hasNumbers:r,hasSpecialChars:p};return{level:c.level,score:Math.round(t),entropy:Math.round(t*10)/10,color:c.color,label:c.label,percentage:c.percentage,feedback:c.level==="very-strong"||c.level==="strong"?[]:m,requirements:E(e,l)}}function E(e,s){const t=e||"";s||(s={hasLowercase:/[a-z]/.test(t),hasUppercase:/[A-Z]/.test(t),hasNumbers:/\d/.test(t),hasSpecialChars:/[^A-Za-z0-9]/.test(t)});const n=s.hasLowercase&&s.hasUppercase,a=t.length>=12;return[{text:"At least 12 characters",met:a,icon:a?"mdi-check-circle":"mdi-circle-outline"},{text:"Uppercase and lowercase letters",met:n,icon:n?"mdi-check-circle":"mdi-circle-outline"},{text:"At least one number",met:s.hasNumbers,icon:s.hasNumbers?"mdi-check-circle":"mdi-circle-outline"},{text:"At least one special character",met:s.hasSpecialChars,icon:s.hasSpecialChars?"mdi-check-circle":"mdi-circle-outline"}]}function P(e,s=[]){const t=k(e);return{level:t.level,color:t.color,label:t.label,percentage:t.percentage,entropy:Math.round(e*10)/10,feedback:t.level==="very-strong"||t.level==="strong"?[]:s}}function Q(e,s){const t=[],{wordCount:n,appendNumber:a,specialPosition:r}=e;return s>=o.STRONG||(n<5&&t.push("Add more words for stronger security"),a||t.push("Enable numbers for extra entropy"),r==="none"&&t.push("Add special characters for additional security")),t}const D={name:"PasswordStrengthIndicator",props:{password:{type:String,required:!0,default:""},showRequirements:{type:Boolean,default:!0},showFeedback:{type:Boolean,default:!0},entropyBits:{type:Number,default:null},suggestions:{type:Array,default:()=>[]}},computed:{strength(){return this.entropyBits!==null?P(this.entropyBits,this.suggestions):B(this.password)},displayEntropy(){return this.entropyBits!==null?Math.round(this.entropyBits):this.strength.entropy||0},displayFeedback(){return this.strength.feedback||[]},passwordRequirements(){const e=this.password;return[{met:e.length>=12,text:"At least 12 characters"},{met:/[a-z]/.test(e)&&/[A-Z]/.test(e),text:"Uppercase and lowercase letters"},{met:/\d/.test(e),text:"At least one number"},{met:/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),text:"At least one special character"}]}},watch:{strength:{handler(e){this.$emit("strength-changed",e)},deep:!0,immediate:!0}}},w=e=>(q("data-v-339ae457"),e=e(),R(),e),F={key:0,class:"password-strength-indicator","data-testid":"strength-indicator",tabindex:"-1"},L={class:"d-flex align-center justify-space-between mb-2",tabindex:"-1"},T={class:"d-flex align-center flex-wrap"},C={class:"text-caption text-medium-emphasis"},O=w(()=>i("a",{href:"https://en.wikipedia.org/wiki/Password_strength#Entropy_as_a_measure_of_password_strength",target:"_blank",rel:"noopener noreferrer",class:"text-info",title:"Learn about password entropy"},"bits of entropy",-1)),W={key:0,class:"mt-2","data-testid":"requirements",tabindex:"-1"},G=w(()=>i("div",{class:"text-caption text-medium-emphasis mb-1 font-weight-medium"}," Password Requirements: ",-1)),K={class:"requirements-list"},V={class:"requirement-text"},Z={key:0,class:"mt-2",tabindex:"-1"},j=w(()=>i("div",{class:"text-caption font-weight-medium mb-1"},"Suggestions:",-1)),H={class:"mb-0 pl-4"};function Y(e,s,t,n,a,r){const p=g("v-progress-linear"),c=g("v-chip"),m=g("v-icon"),f=g("v-expand-transition"),y=g("v-alert");return t.password?(h(),d("div",F,[u(p,{"model-value":r.strength.percentage,color:r.strength.color,height:"8",rounded:"",class:"mb-2",tabindex:"-1"},null,8,["model-value","color"]),i("div",L,[i("div",T,[u(c,{color:r.strength.color,size:"small",variant:"flat",class:"mr-2",tabindex:"-1"},{default:_(()=>[S(b(r.strength.label),1)]),_:1},8,["color"]),i("span",C,[u(m,{icon:"mdi-shield-lock",size:"x-small",class:"mr-1"}),S(" ~"+b(r.displayEntropy)+" ",1),O])])]),u(f,null,{default:_(()=>[t.showRequirements&&r.strength.level!=="empty"?(h(),d("div",W,[G,i("div",K,[(h(!0),d(A,null,M(r.passwordRequirements,(l,v)=>(h(),d("div",{key:v,class:U(["requirement-item",l.met?"requirement-met":"requirement-unmet"])},[u(m,{icon:l.met?"mdi-check-circle":"mdi-close",color:l.met?"success":"error",size:"small",class:"requirement-icon"},null,8,["icon","color"]),i("span",V,b(l.text),1)],2))),128))])])):x("",!0)]),_:1}),u(f,null,{default:_(()=>[r.displayFeedback.length>0&&t.showFeedback?(h(),d("div",Z,[u(y,{color:r.strength.color,variant:"tonal",density:"compact",class:"text-caption pa-2",tabindex:"-1"},{default:_(()=>[j,i("ul",H,[(h(!0),d(A,null,M(r.displayFeedback,(l,v)=>(h(),d("li",{key:v},b(l),1))),128))])]),_:1},8,["color"])])):x("",!0)]),_:1})])):x("",!0)}const X=N(D,[["render",Y],["__scopeId","data-v-339ae457"]]);export{X as P,B as c,Q as g};
