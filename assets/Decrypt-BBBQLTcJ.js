import{_ as fe,a as ve,c as L,b as s,g as e,i as D,j as P,w as r,l as ge,r as f,d as E,k as G,e as c,o as v,F as Z,f as a,t as ee}from"./index-fTqGz_jn.js";import{d as Y}from"./fileDownload-B1vhVzTR.js";import{C as _e,p as we}from"./CsvPreviewTable-Csp5wEd1.js";import{u as be}from"./useClipboard-KqVwDR14.js";import{P as xe,u as Ce,a as ke,b as Pe}from"./PasswordInput-D_PdvLqg.js";import{u as Te}from"./useDebounce-1cjLtdXG.js";import{u as Ae}from"./usePreferences-Ds38W-Dg.js";import{T as Se,S as De,u as Ee}from"./ToolPageHeader-BduMV4Mp.js";import{_ as Fe}from"./EducationalAlert-Cm5e4R6U.js";import{T as Ve,F as We}from"./TextInputWithActions-DQkjOWaJ.js";import"./PasswordStrengthIndicator-DnWSal2I.js";import"./FileUpload-BhrqJf-9.js";const Ie={name:"Decrypt",components:{CsvPreviewTable:_e,EducationalAlert:Fe,FileUploadWithValidation:We,LearnMorePanel:ve,PasswordInput:xe,SharedSnackbar:De,TextInputWithActions:Ve,ToolPageHeader:Se},setup(){const n=f(null),w=f(""),t=f(""),b=f(null),x=f(""),y=f(""),u=f(""),T=f(""),p=f([]),h=f([]),{snackbar:F,snackbarColor:M,snackbarText:z,showSnackbar:i}=Ee(),{copyToClipboard:g,pasteFromClipboard:U}=be(),{announceToScreenReader:V}=Pe(),{preferences:_}=Ae("decrypt",{selectedAlgorithm:"jsAesCrypt"}),{rememberPassword:C,isPasswordRemembered:j,saveSessionPassword:W,clearSessionPassword:k,autoLoadPassword:H}=Ce("decrypt"),I=H();I&&(u.value=I);const{decrypt:B,isLoading:R}=ke((o,d)=>{l.value?(ie(o),V("Text decrypted successfully")):(le(o,d),V("File decrypted successfully"))},(o,d)=>{y.value=d,i(o,"error"),V("Decryption failed: "+o,"assertive"),t.value=""}),N=E(()=>({jsAesCrypt:"How Does AES Decryption Work?",webCrypto:"How Does WebCrypto Decryption Work?",age:"How Does Age Decryption Work?"})[_.selectedAlgorithm]||"How Does Decryption Work?"),A=E(()=>$.value&&(J.value||l.value)),l=E(()=>x.value.trim()!==""),J=E(()=>!!b.value),Q=E(()=>!!T.value||h.value.length>0||p.value.length>0),$=E(()=>u.value.trim()!==""),X=()=>{C.value||(u.value=""),b.value=null,x.value=""},K=()=>{T.value="",t.value="",p.value=[],h.value=[],n.value=null,w.value=""},oe=()=>{x.value="",t.value="",y.value="",me()},se=()=>{try{const o=atob(x.value),d=new Uint8Array(o.length);for(let m=0;m<o.length;m++)d[m]=o.charCodeAt(m);return new Blob([d])}catch(o){return console.error("Base64 decode error:",o),y.value="Invalid Base64 format",i("❌ Invalid encrypted text format","error"),null}},ae=()=>{if(!A.value)return;y.value="",t.value="";const o=se();o&&B(o,u.value,"encrypted.aes",_.selectedAlgorithm)},re=()=>{if(!A.value){i("Invalid inputs","error");return}y.value="",B(b.value,u.value,b.value.name,_.selectedAlgorithm)},ne=()=>{n.value&&w.value&&(Y(n.value,w.value),i("✓ File downloaded successfully!","success"))},le=(o,d)=>{if(n.value=o,w.value=d,d.endsWith(".csv")){if(o.byteLength<=8388608){const m=we(o);h.value=m.headers,p.value=m.data;const q=(o.byteLength/1024).toFixed(2);i(`✓ CSV file decrypted (${q} KB) - Preview shown`,"success")}else{Y(o,d);const m=(o.byteLength/(1024*1024)).toFixed(2);i(`✓ CSV file decrypted (${m} MB) - Too large to preview, downloaded`,"info")}X();return}if(ye(d,o)){const S=new TextDecoder().decode(o);T.value=S;const m=(o.byteLength/1024).toFixed(2);i(`✓ Text file decrypted (${m} KB) - Preview shown`,"success"),X();return}if(Y(o,d),o.byteLength>8388608){const S=(o.byteLength/1048576).toFixed(2);i(`✓ File decrypted (${S} MB) - Too large to preview, downloaded`,"info")}else i("✓ File decrypted and downloaded!","success");X()},ie=o=>{try{const d=new TextDecoder().decode(o);t.value=d,i("✓ Text decrypted successfully!","success")}catch(d){console.error("Text decode error:",d),y.value="Failed to decode decrypted data",i("❌ Decryption failed","error")}},ce=()=>{},de=async()=>{await g(t.value,o=>i(o,"success"),o=>i(o,"error"))},pe=async()=>{await U((o,d)=>{x.value=o,i(d,"success"),O()},o=>i(o,"error"))},ue=()=>{t.value="",y.value="",O()},{cancel:me,debounce:O}=Te(()=>{A.value&&l.value&&ae()},800),ye=(o,d)=>{const m=[".txt",".md",".json",".xml",".html",".css",".js",".log",".yaml",".yml"].some(he=>o.toLowerCase().endsWith(he)),q=d.byteLength<=8388608;return m&&q};return G(b,o=>{o&&(o.name.endsWith(".age")?_.selectedAlgorithm="age":o.name.endsWith(".aes")?_.selectedAlgorithm="jsAesCrypt":o.name.endsWith(".enc")&&(_.selectedAlgorithm="webCrypto")),o&&(Q.value||w.value)&&K()}),G(C,o=>{o&&u.value&&W(u.value)}),G(u,(o,d)=>{C.value&&o&&W(o),o&&o!==d&&(Q.value||w.value)&&K(),l.value&&(t.value="",y.value="",O())}),{decryptedFileName:w,decryptedText:t,encryptedFile:b,encryptedText:x,error:y,isLoading:R,password:u,plainText:T,tableData:p,tableHeaders:h,preferences:_,rememberPassword:C,isPasswordRemembered:j,clearSessionPassword:k,snackbar:F,snackbarColor:M,snackbarText:z,canDecrypt:A,infoPanelTitle:N,isEncryptedTextPopulated:l,isFilePopulated:J,isPasswordPopulated:$,clearEncryptedText:oe,clearOutputs:K,decryptFile:re,downloadDecryptedText:ne,handleCopy:de,handleEncryptedTextChange:ue,handleFileValidation:ce,handlePaste:pe}}},Be=e("p",{class:"mb-2"},[e("strong",null,"AES decryption"),a(" reverses the AES-256 encryption process, converting encrypted data back to its original form using the same password that was used for encryption. ")],-1),Le=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Password required"),a(" - You must use the EXACT same password that was used to encrypt the data")]),e("li",null,[e("strong",null,"Case-sensitive"),a(' - "Password123" and "password123" are different passwords')]),e("li",null,[e("strong",null,"No recovery"),a(" - If you forgot the password, the data cannot be decrypted")]),e("li",null,[e("strong",null,"Secure process"),a(" - Decryption happens entirely in your browser, nothing is sent to any server")])],-1),Me=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),a(" Decrypting files from cloud storage, accessing encrypted backups, retrieving protected documents. ")],-1),ze=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),a(" • "),e("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard "),a(" • "),e("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," jsAesCrypt ")],-1),Ue=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),a(" AES-256-CBC cipher mode with PBKDF2 key derivation (10,000 iterations). Compatible with .aes files encrypted using AES Crypt format. ")],-1),je=e("p",{class:"mb-2"},[e("strong",null,"WebCrypto decryption"),a(" uses the browser's native Web Cryptography API to decrypt AES-256-GCM encrypted data back to its original form using the password. ")],-1),He=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Password required"),a(" - You must use the EXACT same password that was used to encrypt the data")]),e("li",null,[e("strong",null,"Case-sensitive"),a(' - "Password123" and "password123" are different passwords')]),e("li",null,[e("strong",null,"GCM mode"),a(" - Authenticated encryption automatically verifies data integrity")]),e("li",null,[e("strong",null,"Hardware-accelerated"),a(" - Faster decryption using CPU crypto instructions")])],-1),Re=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),a(" Decrypting browser-encrypted files, high-performance decryption, accessing modern encrypted backups. ")],-1),Ne=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," MDN: Web Crypto API "),a(" • "),e("a",{href:"https://www.w3.org/TR/WebCryptoAPI/",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," W3C Specification ")],-1),Xe=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),a(" AES-256-GCM authenticated encryption with PBKDF2 key derivation (100,000 iterations). Browser-native Web Crypto API. Decrypts .enc files. ")],-1),Ke=e("p",{class:"mb-2"},[e("strong",null,"Age decryption"),a(" reverses age encryption, converting encrypted .age files back to their original form using the passphrase. ")],-1),Oe=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Passphrase required"),a(" - You must use the EXACT same passphrase that was used to encrypt the data")]),e("li",null,[e("strong",null,"Case-sensitive"),a(' - "Passphrase123" and "passphrase123" are different passphrases')]),e("li",null,[e("strong",null,"CLI-compatible"),a(" - Works with age and rage command-line tools")]),e("li",null,[e("strong",null,"Armor format"),a(" - Supports both binary and ASCII-armored .age files")])],-1),qe=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),a(" Decrypting age-encrypted backups, cross-platform file decryption, scripting workflows, command-line integration. ")],-1),Ge=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://age-encryption.org",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age specification "),a(" • "),e("a",{href:"https://github.com/FiloSottile/age",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age on GitHub "),a(" • "),e("a",{href:"https://github.com/str4d/rage",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," rage (Rust) ")],-1),Ze=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),a(" Uses rage-wasm (Rust compiled to WebAssembly) with scrypt password derivation. Decrypts .age files with optional armor format. ")],-1),Ye=e("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Je=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (jsAesCrypt)"),e("div",{class:"text-caption text-medium-emphasis"},"Compatible with AES Crypt format (.aes files)")],-1),Qe=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (WebCrypto)"),e("div",{class:"text-caption text-medium-emphasis"},"Browser-native encryption (.enc files)")],-1),$e=e("div",null,[e("div",{class:"font-weight-medium"},"Age Encryption"),e("div",{class:"text-caption text-medium-emphasis"},"Modern encryption format (.age files)")],-1),et=e("a",{href:"https://age-encryption.org",target:"_blank",class:"text-info"},"age CLI tool",-1),tt={class:"d-flex align-start"},ot={class:"flex-grow-1"},st=e("div",{class:"text-h6 font-weight-medium mb-2"},"Decryption Failed",-1),at={class:"text-body-1"},rt={class:"flex-grow-1"},nt=e("div",{class:"text-subtitle-1 font-weight-medium"},"File Decrypted Successfully",-1),lt={class:"text-body-2"},it=e("p",{class:"text-h6 mt-4"},"Decrypting...",-1);function ct(te,n,w,t,b,x){const y=c("ToolPageHeader"),u=c("EducationalAlert"),T=c("LearnMorePanel"),p=c("v-icon"),h=c("v-card-title"),F=c("v-radio"),M=c("v-radio-group"),z=c("v-alert"),i=c("v-card-text"),g=c("v-card"),U=c("PasswordInput"),V=c("v-checkbox"),_=c("v-chip"),C=c("TextInputWithActions"),j=c("v-divider"),W=c("FileUploadWithValidation"),k=c("v-btn"),H=c("v-spacer"),I=c("v-textarea"),B=c("CsvPreviewTable"),R=c("SharedSnackbar"),N=c("v-progress-circular"),A=c("v-overlay");return v(),L("div",null,[s(y,{icon:"mdi-lock-open",title:"Decryption",description:"Decrypt password-protected encrypted files and text","avatar-color":"primary-darken-1"}),s(T,{title:t.infoPanelTitle,"storage-key":"slurm-help-decrypt"},{default:r(()=>[t.preferences.selectedAlgorithm==="jsAesCrypt"?(v(),L(Z,{key:0},[Be,Le,s(u,{title:"Password Must Match Exactly",type:"warning",spacing:"mt-3"},{default:r(()=>[a(' The decryption password must be identical to the encryption password. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),Me,ze,Ue],64)):t.preferences.selectedAlgorithm==="webCrypto"?(v(),L(Z,{key:1},[je,He,s(u,{title:"Password Must Match Exactly",type:"warning",spacing:"mt-3"},{default:r(()=>[a(' The decryption password must be identical to the encryption password. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),Re,Ne,Xe],64)):t.preferences.selectedAlgorithm==="age"?(v(),L(Z,{key:2},[Ke,Oe,s(u,{title:"Passphrase Must Match Exactly",type:"warning",spacing:"mt-3"},{default:r(()=>[a(' The decryption passphrase must be identical to the encryption passphrase. Even a single character difference will result in failed decryption. There is no "close enough" - it must be exact. ')]),_:1}),qe,Ge,Ze],64)):P("",!0)]),_:1},8,["title"]),e("form",{onSubmit:n[6]||(n[6]=ge((...l)=>t.decryptFile&&t.decryptFile(...l),["prevent"]))},[Ye,s(g,{class:"mb-4"},{default:r(()=>[s(h,{class:"bg-surface-variant"},{default:r(()=>[s(p,{icon:"mdi-shield-lock",class:"mr-2"}),a(" Encryption Algorithm ")]),_:1}),s(i,{class:"pa-4"},{default:r(()=>[s(M,{modelValue:t.preferences.selectedAlgorithm,"onUpdate:modelValue":n[0]||(n[0]=l=>t.preferences.selectedAlgorithm=l),inline:""},{default:r(()=>[s(F,{value:"jsAesCrypt"},{label:r(()=>[Je]),_:1}),s(F,{value:"webCrypto"},{label:r(()=>[Qe]),_:1}),s(F,{value:"age"},{label:r(()=>[$e]),_:1})]),_:1},8,["modelValue"]),t.preferences.selectedAlgorithm==="age"?(v(),D(z,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:r(()=>[a(" Age encrypted files (.age) are compatible with the "),et]),_:1})):P("",!0)]),_:1})]),_:1}),s(g,{class:"mb-4"},{default:r(()=>[s(h,{class:"bg-surface-variant"},{default:r(()=>[s(p,{icon:"mdi-key",class:"mr-2"}),a(" Enter Password ")]),_:1}),s(i,{class:"pa-4"},{default:r(()=>[s(U,{password:t.password,"onUpdate:password":n[1]||(n[1]=l=>t.password=l),"require-confirmation":!1,"show-strength":!0,"show-requirements":!1,"show-feedback":!1,autocomplete:"current-password","password-label":"Decryption Password","password-placeholder":"Enter the password used for encryption","password-icon":"mdi-lock-open"},null,8,["password"]),s(V,{modelValue:t.rememberPassword,"onUpdate:modelValue":n[2]||(n[2]=l=>t.rememberPassword=l),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),t.isPasswordRemembered?(v(),D(_,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":t.clearSessionPassword,class:"mt-2"},{default:r(()=>[a(" Password remembered for session ")]),_:1},8,["onClick:close"])):P("",!0)]),_:1})]),_:1}),s(g,{class:"mb-4"},{default:r(()=>[s(h,{class:"bg-surface-variant"},{default:r(()=>[s(p,{icon:"mdi-lock",class:"mr-2"}),a(" Encrypted Text ")]),_:1}),s(i,{class:"pa-4"},{default:r(()=>[s(C,{modelValue:t.encryptedText,"onUpdate:modelValue":n[3]||(n[3]=l=>t.encryptedText=l),label:"Paste encrypted Base64 text",placeholder:"Paste the encrypted text here...",rows:4,disabled:t.isFilePopulated,"show-paste":!t.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"encrypted-text-input",onPaste:t.handlePaste,onClear:t.clearEncryptedText,onInput:t.handleEncryptedTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),s(j,{class:"my-4"}),s(C,{modelValue:t.decryptedText,"onUpdate:modelValue":n[4]||(n[4]=l=>t.decryptedText=l),label:"Decrypted Text",placeholder:"Decrypted output will appear here...",rows:4,"is-loading":t.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:t.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),s(g,{class:"mb-4"},{default:r(()=>[s(h,{class:"bg-surface-variant"},{default:r(()=>[s(p,{icon:"mdi-file-lock",class:"mr-2"}),a(" Encrypted File ")]),_:1}),s(i,{class:"pa-4"},{default:r(()=>[s(W,{modelValue:t.encryptedFile,"onUpdate:modelValue":n[5]||(n[5]=l=>t.encryptedFile=l),label:"Select encrypted file (.aes or .age)",accept:".aes,.age","button-text":"Decrypt","button-icon":"mdi-lock-open",disabled:t.isEncryptedTextPopulated,"can-submit":t.canDecrypt,onSubmit:t.decryptFile,onValidationChange:t.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1})],32),t.error?(v(),D(g,{key:0,variant:"tonal",color:"error",class:"mb-4"},{default:r(()=>[s(i,{class:"pa-4"},{default:r(()=>[e("div",tt,[s(p,{icon:"mdi-alert-circle",size:"32",color:"error",class:"mr-4 mt-1"}),e("div",ot,[st,e("div",at,ee(t.error),1)]),s(k,{icon:"",size:"small",variant:"text",onClick:n[7]||(n[7]=l=>t.error=""),class:"ml-2"},{default:r(()=>[s(p,null,{default:r(()=>[a("mdi-close")]),_:1})]),_:1})])]),_:1})]),_:1})):P("",!0),t.plainText?(v(),D(g,{key:1,variant:"tonal",class:"mb-4"},{default:r(()=>[s(h,{class:"d-flex align-center","data-testid":"file-info"},{default:r(()=>[s(p,{icon:"mdi-text",class:"mr-2"}),a(" Decrypted Text "),s(H),t.decryptedFileName?(v(),D(k,{key:0,variant:"text",color:"primary",onClick:t.downloadDecryptedText,class:"mr-2"},{default:r(()=>[s(p,{start:""},{default:r(()=>[a("mdi-download")]),_:1}),a(" Download ")]),_:1},8,["onClick"])):P("",!0),s(k,{icon:"",size:"small",variant:"text",onClick:t.clearOutputs},{default:r(()=>[s(p,null,{default:r(()=>[a("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1}),s(i,{class:"pa-4"},{default:r(()=>[s(I,{modelValue:t.plainText,"onUpdate:modelValue":n[8]||(n[8]=l=>t.plainText=l),variant:"outlined",rows:"10",readonly:"","bg-color":"grey-lighten-4",placeholder:"Decrypted text","data-testid":"file-preview","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})):P("",!0),s(B,{headers:t.tableHeaders,data:t.tableData,"show-download":!!t.decryptedFileName,"card-class":"mb-4","test-id":"file-preview",onClose:t.clearOutputs,onDownload:t.downloadDecryptedText},null,8,["headers","data","show-download","onClose","onDownload"]),t.decryptedFileName&&!t.plainText&&!t.tableData.length?(v(),D(g,{key:2,variant:"tonal",color:"success"},{default:r(()=>[s(i,{class:"d-flex align-center pa-4"},{default:r(()=>[s(p,{icon:"mdi-check-circle",size:"32",class:"mr-4"}),e("div",rt,[nt,e("div",lt,ee(t.decryptedFileName),1)]),s(k,{variant:"elevated",color:"white",onClick:t.downloadDecryptedText,class:"mr-2"},{default:r(()=>[s(p,{start:""},{default:r(()=>[a("mdi-download")]),_:1}),a(" Download Again ")]),_:1},8,["onClick"]),s(k,{icon:"",size:"small",variant:"text",onClick:t.clearOutputs},{default:r(()=>[s(p,null,{default:r(()=>[a("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})):P("",!0),s(R,{modelValue:t.snackbar,"onUpdate:modelValue":n[9]||(n[9]=l=>t.snackbar=l),text:t.snackbarText,color:t.snackbarColor},null,8,["modelValue","text","color"]),s(A,{"model-value":t.isLoading,class:"align-center justify-center"},{default:r(()=>[s(N,{indeterminate:"",size:"64",color:"primary"}),it]),_:1},8,["model-value"])])}const xt=fe(Ie,[["render",ct]]);export{xt as default};
