import{_ as se,a as le,c as B,b as a,i as O,j as L,w as s,r as b,d as A,k as Y,e as l,o as _,F as K,g as e,f as o,t as ie,l as ce}from"./index-fTqGz_jn.js";import{d as de}from"./fileDownload-B1vhVzTR.js";import{C as pe,p as ue}from"./CsvPreviewTable-Csp5wEd1.js";import{u as me}from"./useClipboard-KqVwDR14.js";import{P as fe,u as ye,a as ve,b as he}from"./PasswordInput-D_PdvLqg.js";import{u as ge}from"./useDebounce-1cjLtdXG.js";import{u as be}from"./usePreferences-Ds38W-Dg.js";import{T as _e,S as we,u as xe}from"./ToolPageHeader-BduMV4Mp.js";import{_ as Ce}from"./EducationalAlert-Cm5e4R6U.js";import{T as Pe,F as ke}from"./TextInputWithActions-DQkjOWaJ.js";import{_ as Ae}from"./InfoTooltip-BTw40emw.js";import"./PasswordStrengthIndicator-DnWSal2I.js";import"./FileUpload-BhrqJf-9.js";const Se={name:"Encrypt",components:{CsvPreviewTable:pe,EducationalAlert:Ce,FileUploadWithValidation:ke,InfoTooltip:Ae,LearnMorePanel:le,PasswordInput:fe,SharedSnackbar:we,TextInputWithActions:Pe,ToolPageHeader:_e},setup(){const u=b(""),r=b(""),p=b(""),t=b(""),y=b(null),v=b(""),w=b([]),m=b([]),{snackbar:j,snackbarColor:F,snackbarText:x,showSnackbar:d}=xe(),{copyToClipboard:S,pasteFromClipboard:D}=me(),{announceToScreenReader:h}=he(),{preferences:f}=be("encrypt",{selectedAlgorithm:"jsAesCrypt"}),{rememberPassword:C,isPasswordRemembered:M,saveSessionPassword:V,clearSessionPassword:R,autoLoadPassword:I}=ye("encrypt"),E=I();E&&(p.value=E,t.value=E);const{encrypt:W,isLoading:H}=ve((n,i)=>{k.value?(X(n),h("Text encrypted successfully")):(de(n,i),d("✓ File encrypted successfully!","success"),h("File encrypted and download started"),J())},(n,i)=>{r.value=i,d(n,"error"),h("Encryption failed: "+n,"assertive"),u.value=""}),N=A(()=>({jsAesCrypt:"What is AES Encryption?",webCrypto:"What is WebCrypto AES Encryption?",age:"What is Age Encryption?"})[f.selectedAlgorithm]||"What is Encryption?"),P=A(()=>U.value&&(T.value||k.value)),T=A(()=>!!y.value),c=A(()=>m.value.length>0||w.value.length>0),U=A(()=>p.value.trim()!==""&&p.value===t.value),k=A(()=>v.value.trim()!==""),J=()=>{C.value||(p.value="",t.value=""),v.value="",y.value=null,u.value="",q()},q=()=>{w.value=[],m.value=[],search.value="",r.value=""},Q=()=>{v.value="",u.value="",r.value="",ne()},X=n=>{try{const i=new Blob([n]),g=new FileReader;g.onload=()=>{const z=g.result.split(",")[1];u.value=z,d("✓ Text encrypted successfully!","success")},g.onerror=()=>{r.value="Failed to convert encrypted data",d("❌ Encryption failed","error")},g.readAsDataURL(i)}catch(i){console.error("Base64 conversion error:",i),r.value="Failed to convert encrypted data",d("❌ Encryption failed","error")}},Z=()=>{if(!P.value){d("Invalid inputs","error");return}r.value="";let n=null,i=null;k.value?(n=new Blob([v.value],{type:"text/plain"}),i="plaintext.txt"):T.value&&(n=y.value,i=y.value.name),n&&i&&W(n,p.value,i,f.selectedAlgorithm)},$=n=>{if(y.value&&n.isValid){const i=y.value;if(i.type==="text/csv"){const g=new FileReader;g.onload=()=>{const z=g.result;ee(z)},g.readAsText(i)}}},ee=n=>{const i=ue(n);m.value=i.headers,w.value=i.data},te=()=>{if(P.value){r.value="",u.value="";try{const n=new Blob([v.value],{type:"text/plain"});W(n,p.value,"plaintext.txt",f.selectedAlgorithm)}catch(n){console.error("Encryption error:",n),r.value="Failed to initiate encryption",d("❌ Encryption failed","error")}}},oe=async()=>{await S(u.value,n=>d(n,"success"),n=>d(n,"error"))},ae=async()=>{await D((n,i)=>{v.value=n,d(i,"success"),G()},n=>d(n,"error"))},re=()=>{u.value="",r.value="",G()},{cancel:ne,debounce:G}=ge(()=>{P.value&&k.value&&te()},800);return Y(C,n=>{n&&U.value&&V(p.value)}),Y([p,t],()=>{C.value&&U.value&&V(p.value),k.value&&(u.value="",r.value="",G())}),{encryptedText:u,error:r,isLoading:H,password:p,passwordConfirm:t,plainFile:y,plainText:v,tableData:w,tableHeaders:m,preferences:f,rememberPassword:C,isPasswordRemembered:M,clearSessionPassword:R,snackbar:j,snackbarColor:F,snackbarText:x,canEncrypt:P,infoPanelTitle:N,isFilePopulated:T,isOutputPopulated:c,isPasswordConfirmed:U,isPlaintextPopulated:k,clearOutputs:q,clearPlainText:Q,encryptFile:Z,handleCopy:oe,handleFileValidation:$,handlePaste:ae,handlePlainTextChange:re}}},Ee=e("p",{class:"mb-2"},[e("strong",null,"AES (Advanced Encryption Standard)"),o(" is a military-grade encryption algorithm trusted by governments and organizations worldwide to protect sensitive data. ")],-1),Te=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"AES-256"),o(" - This tool uses 256-bit keys, the strongest AES variant")]),e("li",null,[e("strong",null,"Password-based"),o(" - Your password is converted into an encryption key")]),e("li",null,[e("strong",null,"Cross-platform"),o(" - Compatible with desktop AES Crypt applications")]),e("li",null,[e("strong",null,"Unbreakable"),o(" - With a strong password, AES-256 would take billions of years to crack")])],-1),Fe=e("strong",null,"cannot be recovered",-1),Ve=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Encrypt sensitive documents before uploading to cloud storage, secure backups, protect confidential files on shared computers. ")],-1),Ie=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),o(" • "),e("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard "),o(" • "),e("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," jsAesCrypt ")],-1),We=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" AES-256-CBC cipher mode with PBKDF2 key derivation (10,000 iterations). Uses jsAesCrypt and CryptoJS libraries. Produces .aes files compatible with AES Crypt format. ")],-1),Ue=e("p",{class:"mb-2"},[e("strong",null,"Web Cryptography API"),o(" provides browser-native AES-256 encryption with hardware acceleration, offering fast, secure encryption without external libraries. ")],-1),Be=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"AES-256-GCM"),o(" - Modern authenticated encryption mode that prevents tampering")]),e("li",null,[e("strong",null,"Hardware-accelerated"),o(" - Uses CPU crypto instructions for optimal performance")]),e("li",null,[e("strong",null,"Browser-native"),o(" - Built into modern browsers, no external dependencies")]),e("li",null,[e("strong",null,"High security"),o(" - PBKDF2 with 100,000 iterations for strong key derivation")])],-1),Le=e("strong",null,"cannot be recovered",-1),je=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Fast encryption for modern browsers, maximum compatibility, browser-based secure storage, privacy-focused applications. ")],-1),De=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," MDN: Web Crypto API "),o(" • "),e("a",{href:"https://www.w3.org/TR/WebCryptoAPI/",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," W3C Specification ")],-1),Me=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" AES-256-GCM authenticated encryption with PBKDF2 key derivation (100,000 iterations). Browser-native Web Crypto API. Produces .enc files. ")],-1),Re=e("p",{class:"mb-2"},[e("strong",null,"Age encryption"),o(" is a modern, simple file encryption tool designed as a replacement for GPG. Created by Filippo Valsorda, it focuses on simplicity and ease of use. ")],-1),He=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Simple format"),o(" - Compact, easy-to-use encryption format")]),e("li",null,[e("strong",null,"CLI-compatible"),o(" - Works with age and rage command-line tools")]),e("li",null,[e("strong",null,"scrypt derivation"),o(" - Secure against GPU-based password cracking")]),e("li",null,[e("strong",null,"Armor format"),o(" - ASCII-armored output for text-safe transmission")])],-1),Ne=e("strong",null,"cannot be recovered",-1),Ge=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Cross-platform encrypted backups, scripting and automation, developer workflows, command-line integration. ")],-1),ze=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://age-encryption.org",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age specification "),o(" • "),e("a",{href:"https://github.com/FiloSottile/age",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age on GitHub "),o(" • "),e("a",{href:"https://github.com/str4d/rage",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," rage (Rust) ")],-1),Oe=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" Uses rage-wasm (Rust compiled to WebAssembly) with scrypt password derivation. Produces .age files with optional armor encoding. ")],-1),Ke=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (jsAesCrypt)"),e("div",{class:"text-caption text-medium-emphasis"},"Compatible with AES Crypt format (.aes files)")],-1),qe=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (WebCrypto)"),e("div",{class:"text-caption text-medium-emphasis"},"Browser-native encryption (.enc files)")],-1),Ye=e("div",null,[e("div",{class:"font-weight-medium"},"Age Encryption"),e("div",{class:"text-caption text-medium-emphasis"},"Modern encryption format (.age files)")],-1),Je=e("a",{href:"https://age-encryption.org",target:"_blank",class:"text-info"},"age CLI tool",-1),Qe=e("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Xe=e("p",{class:"text-h6 mt-4"},"Encrypting...",-1);function Ze(u,r,p,t,y,v){const w=l("ToolPageHeader"),m=l("EducationalAlert"),j=l("LearnMorePanel"),F=l("v-alert"),x=l("v-icon"),d=l("v-card-title"),S=l("v-radio"),D=l("v-radio-group"),h=l("v-card-text"),f=l("v-card"),C=l("InfoTooltip"),M=l("PasswordInput"),V=l("v-checkbox"),R=l("v-chip"),I=l("TextInputWithActions"),E=l("v-divider"),W=l("FileUploadWithValidation"),H=l("CsvPreviewTable"),N=l("SharedSnackbar"),P=l("v-progress-circular"),T=l("v-overlay");return _(),B("div",null,[a(w,{icon:"mdi-lock",title:"Encryption",description:"Encrypt files and text with password protection using military-grade encryption","avatar-color":"primary"}),a(j,{title:t.infoPanelTitle,"storage-key":"slurm-help-encrypt"},{default:s(()=>[t.preferences.selectedAlgorithm==="jsAesCrypt"?(_(),B(K,{key:0},[Ee,Te,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Fe,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Ve,Ie,We],64)):t.preferences.selectedAlgorithm==="webCrypto"?(_(),B(K,{key:1},[Ue,Be,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Le,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),je,De,Me],64)):t.preferences.selectedAlgorithm==="age"?(_(),B(K,{key:2},[Re,He,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Ne,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Ge,ze,Oe],64)):L("",!0)]),_:1},8,["title"]),t.error?(_(),O(F,{key:0,type:"error",variant:"tonal",closable:"","onClick:close":r[0]||(r[0]=c=>t.error=""),class:"mb-4"},{default:s(()=>[o(ie(t.error),1)]),_:1})):L("",!0),a(f,{class:"mb-4"},{default:s(()=>[a(d,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-shield-lock",class:"mr-2"}),o(" Encryption Algorithm ")]),_:1}),a(h,{class:"pa-4"},{default:s(()=>[a(D,{modelValue:t.preferences.selectedAlgorithm,"onUpdate:modelValue":r[1]||(r[1]=c=>t.preferences.selectedAlgorithm=c),inline:""},{default:s(()=>[a(S,{value:"jsAesCrypt"},{label:s(()=>[Ke]),_:1}),a(S,{value:"webCrypto"},{label:s(()=>[qe]),_:1}),a(S,{value:"age"},{label:s(()=>[Ye]),_:1})]),_:1},8,["modelValue"]),t.preferences.selectedAlgorithm==="age"?(_(),O(F,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:s(()=>[o(" Age encrypted files (.age) are compatible with the "),Je]),_:1})):L("",!0)]),_:1})]),_:1}),a(f,{class:"mb-4"},{default:s(()=>[a(d,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-key",class:"mr-2"}),o(" Password Protection "),a(C,{text:"Password strength directly determines your encryption security. A weak 6-character password can be cracked in minutes, while a strong 16+ character password would take centuries to brute-force.",location:"bottom"})]),_:1}),a(h,{class:"pa-4"},{default:s(()=>[a(m,{title:"Password Strength Matters",type:"info",spacing:"mb-3"},{default:s(()=>[o(" Use at least 12 characters with a mix of uppercase, lowercase, numbers, and symbols. Your password security determines how long your encrypted data stays protected. ")]),_:1}),e("form",{onSubmit:r[5]||(r[5]=ce(()=>{},["prevent"]))},[Qe,a(M,{password:t.password,"onUpdate:password":r[2]||(r[2]=c=>t.password=c),"password-confirm":t.passwordConfirm,"onUpdate:passwordConfirm":r[3]||(r[3]=c=>t.passwordConfirm=c),"require-confirmation":!0,"show-strength":!0,"show-requirements":!0,"show-feedback":!1,autocomplete:"new-password"},null,8,["password","password-confirm"]),a(V,{modelValue:t.rememberPassword,"onUpdate:modelValue":r[4]||(r[4]=c=>t.rememberPassword=c),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),t.isPasswordRemembered?(_(),O(R,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":t.clearSessionPassword,class:"mt-2"},{default:s(()=>[o(" Password remembered for session ")]),_:1},8,["onClick:close"])):L("",!0)],32)]),_:1})]),_:1}),a(f,{class:"mb-4"},{default:s(()=>[a(d,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-text",class:"mr-2"}),o(" Text Encryption ")]),_:1}),a(h,{class:"pa-4"},{default:s(()=>[a(I,{modelValue:t.plainText,"onUpdate:modelValue":r[6]||(r[6]=c=>t.plainText=c),label:"Plain Text",placeholder:"Enter your plain text here",rows:4,disabled:t.isFilePopulated,"show-paste":!t.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"plain-text-input",onPaste:t.handlePaste,onClear:t.clearPlainText,onInput:t.handlePlainTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),a(E,{class:"my-4"}),a(I,{modelValue:t.encryptedText,"onUpdate:modelValue":r[7]||(r[7]=c=>t.encryptedText=c),label:"Encrypted Text (Base64)",placeholder:"Encrypted output will appear here...",rows:4,"is-loading":t.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:t.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),a(f,{class:"mb-4"},{default:s(()=>[a(d,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-file",class:"mr-2"}),o(" File Encryption ")]),_:1}),a(h,{class:"pa-4"},{default:s(()=>[a(W,{modelValue:t.plainFile,"onUpdate:modelValue":r[8]||(r[8]=c=>t.plainFile=c),label:"Select file to encrypt","button-text":"Encrypt","button-icon":"mdi-lock",disabled:t.isPlaintextPopulated,"can-submit":t.canEncrypt,onSubmit:t.encryptFile,onValidationChange:t.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1}),a(H,{headers:t.tableHeaders,data:t.tableData,onClose:t.clearOutputs},null,8,["headers","data","onClose"]),a(N,{modelValue:t.snackbar,"onUpdate:modelValue":r[9]||(r[9]=c=>t.snackbar=c),text:t.snackbarText,color:t.snackbarColor},null,8,["modelValue","text","color"]),a(T,{"model-value":t.isLoading,class:"align-center justify-center"},{default:s(()=>[a(P,{indeterminate:"",size:"64",color:"primary"}),Xe]),_:1},8,["model-value"])])}const ut=se(Se,[["render",Ze]]);export{ut as default};
