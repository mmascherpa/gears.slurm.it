import{_ as ae,c as oe,a as t,f as N,g as O,w as i,r as f,b as C,h as q,d as r,o as R,e as T,t as te,i as H,k as ne}from"./index-Be9HKwpV.js";import{d as le}from"./fileDownload-B1vhVzTR.js";import{C as re,p as se}from"./CsvPreviewTable-CqFZZzCF.js";import{P as ie,u as ce,a as de}from"./PasswordInput-BL-9FnSo.js";import{u as ue}from"./useClipboard-KqVwDR14.js";import{u as pe}from"./useDebounce-CBVJKzh1.js";import{T as me,S as ve,u as fe}from"./ToolPageHeader-TgTx7KLi.js";import{T as be,F as ye}from"./TextInputWithActions-Ca2jwfS9.js";import"./PasswordStrengthIndicator-BgFDiEVo.js";import"./FileUpload-BDujieA5.js";const we={name:"AesEncrypt",components:{CsvPreviewTable:re,FileUploadWithValidation:ye,PasswordInput:ie,SharedSnackbar:ve,TextInputWithActions:be,ToolPageHeader:me},setup(){const d=f(""),a=f(""),c=f(""),e=f(""),u=f(null),p=f(""),b=f([]),y=f([]),{snackbar:_,snackbarColor:x,snackbarText:S,showSnackbar:s}=fe(),{copyToClipboard:E,pasteFromClipboard:h}=ue(),{rememberPassword:m,isPasswordRemembered:V,saveSessionPassword:k,clearSessionPassword:U,autoLoadPassword:B}=ce("encrypt"),P=B();P&&(c.value=P,e.value=P);const{encrypt:g,isLoading:A}=de((o,n)=>{w.value?G(o):(le(o,n),s("✓ File encrypted successfully!","success"),j())},(o,n)=>{a.value=n,s(o,"error"),d.value=""}),l=C(()=>F.value&&(I.value||w.value)),I=C(()=>!!u.value),z=C(()=>y.value.length>0||b.value.length>0),F=C(()=>c.value.trim()!==""&&c.value===e.value),w=C(()=>p.value.trim()!==""),j=()=>{m.value||(c.value="",e.value=""),p.value="",u.value=null,d.value="",L()},L=()=>{b.value=[],y.value=[],search.value="",a.value=""},M=()=>{p.value="",d.value="",a.value="",ee()},G=o=>{try{const n=new Blob([o]),v=new FileReader;v.onload=()=>{const D=v.result.split(",")[1];d.value=D,s("✓ Text encrypted successfully!","success")},v.onerror=()=>{a.value="Failed to convert encrypted data",s("❌ Encryption failed","error")},v.readAsDataURL(n)}catch(n){console.error("Base64 conversion error:",n),a.value="Failed to convert encrypted data",s("❌ Encryption failed","error")}},J=()=>{if(!l.value){s("Invalid inputs","error");return}a.value="";let o=null,n=null;w.value?(o=new Blob([p.value],{type:"text/plain"}),n="plaintext.txt"):I.value&&(o=u.value,n=u.value.name),o&&n&&g(o,c.value,n)},K=o=>{if(u.value&&o.isValid){const n=u.value;if(n.type==="text/csv"){const v=new FileReader;v.onload=()=>{const D=v.result;Q(D)},v.readAsText(n)}}},Q=o=>{const n=se(o);y.value=n.headers,b.value=n.data},X=()=>{if(l.value){a.value="",d.value="";try{const o=new Blob([p.value],{type:"text/plain"});g(o,c.value,"plaintext.txt")}catch(o){console.error("Encryption error:",o),a.value="Failed to initiate encryption",s("❌ Encryption failed","error")}}},Y=async()=>{await E(d.value,o=>s(o,"success"),o=>s(o,"error"))},Z=async()=>{await h((o,n)=>{p.value=o,s(n,"success"),W()},o=>s(o,"error"))},$=()=>{d.value="",a.value="",W()},{cancel:ee,debounce:W}=pe(()=>{l.value&&w.value&&X()},800);return q(m,o=>{o&&F.value&&k(c.value)}),q([c,e],()=>{m.value&&F.value&&k(c.value),w.value&&(d.value="",a.value="",W())}),{encryptedText:d,error:a,isLoading:A,password:c,passwordConfirm:e,plainFile:u,plainText:p,tableData:b,tableHeaders:y,rememberPassword:m,isPasswordRemembered:V,clearSessionPassword:U,snackbar:_,snackbarColor:x,snackbarText:S,canEncrypt:l,isFilePopulated:I,isOutputPopulated:z,isPasswordConfirmed:F,isPlaintextPopulated:w,clearOutputs:L,clearPlainText:M,encryptFile:J,handleCopy:Y,handleFileValidation:K,handlePaste:Z,handlePlainTextChange:$}}},_e=H("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),xe=H("p",{class:"text-h6 mt-4"},"Encrypting...",-1);function he(d,a,c,e,u,p){const b=r("ToolPageHeader"),y=r("v-alert"),_=r("v-icon"),x=r("v-card-title"),S=r("PasswordInput"),s=r("v-checkbox"),E=r("v-chip"),h=r("v-card-text"),m=r("v-card"),V=r("TextInputWithActions"),k=r("v-divider"),U=r("FileUploadWithValidation"),B=r("CsvPreviewTable"),P=r("SharedSnackbar"),g=r("v-progress-circular"),A=r("v-overlay");return R(),oe("div",null,[t(b,{icon:"mdi-lock",title:"AES Encryption",description:"Encrypt files and text with password-protected AES encryption","avatar-color":"primary"}),e.error?(R(),N(y,{key:0,type:"error",variant:"tonal",closable:"","onClick:close":a[0]||(a[0]=l=>e.error=""),class:"mb-4"},{default:i(()=>[T(te(e.error),1)]),_:1})):O("",!0),t(m,{class:"mb-4"},{default:i(()=>[t(x,{class:"bg-surface-variant"},{default:i(()=>[t(_,{icon:"mdi-key",class:"mr-2"}),T(" Password Protection ")]),_:1}),t(h,{class:"pa-4"},{default:i(()=>[H("form",{onSubmit:a[4]||(a[4]=ne(()=>{},["prevent"]))},[_e,t(S,{password:e.password,"onUpdate:password":a[1]||(a[1]=l=>e.password=l),"password-confirm":e.passwordConfirm,"onUpdate:passwordConfirm":a[2]||(a[2]=l=>e.passwordConfirm=l),"require-confirmation":!0,"show-strength":!0,"show-requirements":!0,"show-feedback":!1,autocomplete:"new-password"},null,8,["password","password-confirm"]),t(s,{modelValue:e.rememberPassword,"onUpdate:modelValue":a[3]||(a[3]=l=>e.rememberPassword=l),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),e.isPasswordRemembered?(R(),N(E,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":e.clearSessionPassword,class:"mt-2"},{default:i(()=>[T(" Password remembered for session ")]),_:1},8,["onClick:close"])):O("",!0)],32)]),_:1})]),_:1}),t(m,{class:"mb-4"},{default:i(()=>[t(x,{class:"bg-surface-variant"},{default:i(()=>[t(_,{icon:"mdi-text",class:"mr-2"}),T(" Text Encryption ")]),_:1}),t(h,{class:"pa-4"},{default:i(()=>[t(V,{modelValue:e.plainText,"onUpdate:modelValue":a[5]||(a[5]=l=>e.plainText=l),label:"Plain Text",placeholder:"Enter your plain text here",rows:4,disabled:e.isFilePopulated,"show-paste":!e.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"plain-text-input",onPaste:e.handlePaste,onClear:e.clearPlainText,onInput:e.handlePlainTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),t(k,{class:"my-4"}),t(V,{modelValue:e.encryptedText,"onUpdate:modelValue":a[6]||(a[6]=l=>e.encryptedText=l),label:"Encrypted Text (Base64)",placeholder:"Encrypted output will appear here...",rows:4,"is-loading":e.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:e.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),t(m,{class:"mb-4"},{default:i(()=>[t(x,{class:"bg-surface-variant"},{default:i(()=>[t(_,{icon:"mdi-file",class:"mr-2"}),T(" File Encryption ")]),_:1}),t(h,{class:"pa-4"},{default:i(()=>[t(U,{modelValue:e.plainFile,"onUpdate:modelValue":a[7]||(a[7]=l=>e.plainFile=l),label:"Select file to encrypt","button-text":"Encrypt","button-icon":"mdi-lock",disabled:e.isPlaintextPopulated,"can-submit":e.canEncrypt,onSubmit:e.encryptFile,onValidationChange:e.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1}),t(B,{headers:e.tableHeaders,data:e.tableData,onClose:e.clearOutputs},null,8,["headers","data","onClose"]),t(P,{modelValue:e.snackbar,"onUpdate:modelValue":a[8]||(a[8]=l=>e.snackbar=l),text:e.snackbarText,color:e.snackbarColor},null,8,["modelValue","text","color"]),t(A,{"model-value":e.isLoading,class:"align-center justify-center"},{default:i(()=>[t(g,{indeterminate:"",size:"64",color:"primary"}),xe]),_:1},8,["model-value"])])}const Be=ae(we,[["render",he]]);export{Be as default};
