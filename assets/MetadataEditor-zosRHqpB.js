import{d as Et}from"./fileDownload-B1vhVzTR.js";import{F as Xi,f as Ki}from"./FileUpload-BnGHFsNw.js";import{D as Yi,_ as st,r as j,d as oe,i as L,w as u,e as S,o as A,b as d,f as P,j as V,c as ce,F as Me,A as Oe,t as N,g as T,p as lt,h as ct,k as je,z as Ji,q as bi,n as Ci,a as qi,m as Qi}from"./index-_lZS3CbI.js";import{T as Zi,S as $i,u as ea}from"./ToolPageHeader-DeIUEXN-.js";import{C as ta}from"./CardSectionHeader-C8HIDa6I.js";import{_ as ia}from"./EducationalAlert-CxalLgoq.js";import{_ as aa}from"./InfoTooltip-BRQHX8ly.js";function na(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ut={exports:{}};(function(a,e){(function(){var t={};t.version="1.0.4",t.remove=function(l){var c=!1;if(l.slice(0,2)!="ÿØ")if(l.slice(0,23)=="data:image/jpeg;base64,"||l.slice(0,22)=="data:image/jpg;base64,")l=F(l.split(",")[1]),c=!0;else throw new Error("Given data is not jpeg.");var f=J(l),y=f.filter(function(h){return!(h.slice(0,2)=="ÿá"&&h.slice(4,10)=="Exif\0\0")}),p=y.join("");return c&&(p="data:image/jpeg;base64,"+C(p)),p},t.insert=function(l,c){var f=!1;if(l.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(c.slice(0,2)!="ÿØ")if(c.slice(0,23)=="data:image/jpeg;base64,"||c.slice(0,22)=="data:image/jpg;base64,")c=F(c.split(",")[1]),f=!0;else throw new Error("Given data is not jpeg.");var y="ÿá"+b(">H",[l.length+2])+l,p=J(c),h=ne(p,y);return f&&(h="data:image/jpeg;base64,"+C(h)),h},t.load=function(l){var c;if(typeof l=="string")if(l.slice(0,2)=="ÿØ")c=l;else if(l.slice(0,23)=="data:image/jpeg;base64,"||l.slice(0,22)=="data:image/jpg;base64,")c=F(l.split(",")[1]);else if(l.slice(0,4)=="Exif")c=l.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var f={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},y=new v(c);if(y.tiftag===null)return f;y.tiftag.slice(0,2)=="II"?y.endian_mark="<":y.endian_mark=">";var p=x(y.endian_mark+"L",y.tiftag.slice(4,8))[0];f["0th"]=y.get_ifd(p,"0th");var h=f["0th"].first_ifd_pointer;if(delete f["0th"].first_ifd_pointer,34665 in f["0th"]&&(p=f["0th"][34665],f.Exif=y.get_ifd(p,"Exif")),34853 in f["0th"]&&(p=f["0th"][34853],f.GPS=y.get_ifd(p,"GPS")),40965 in f.Exif&&(p=f.Exif[40965],f.Interop=y.get_ifd(p,"Interop")),h!="\0\0\0\0"&&(p=x(y.endian_mark+"L",h)[0],f["1st"]=y.get_ifd(p,"1st"),513 in f["1st"]&&514 in f["1st"])){var _=f["1st"][513]+f["1st"][514],I=y.tiftag.slice(f["1st"][513],_);f.thumbnail=I}return f},t.dump=function(l){var c=8,f=i(l),y="Exif\0\0MM\0*\0\0\0\b",p=!1,h=!1,_=!1,I=!1,M,D,z,U,Ce;"0th"in f?M=f["0th"]:M={},"Exif"in f&&Object.keys(f.Exif).length||"Interop"in f&&Object.keys(f.Interop).length?(M[34665]=1,p=!0,D=f.Exif,"Interop"in f&&Object.keys(f.Interop).length?(D[40965]=1,_=!0,z=f.Interop):Object.keys(D).indexOf(t.ExifIFD.InteroperabilityTag.toString())>-1&&delete D[40965]):Object.keys(M).indexOf(t.ImageIFD.ExifTag.toString())>-1&&delete M[34665],"GPS"in f&&Object.keys(f.GPS).length?(M[t.ImageIFD.GPSTag]=1,h=!0,U=f.GPS):Object.keys(M).indexOf(t.ImageIFD.GPSTag.toString())>-1&&delete M[t.ImageIFD.GPSTag],"1st"in f&&"thumbnail"in f&&f.thumbnail!=null&&(I=!0,f["1st"][513]=1,f["1st"][514]=1,Ce=f["1st"]);var ye=g(M,"0th",0),se=ye[0].length+p*12+h*12+4+ye[1].length,fe,k="",K=0,le,Xe="",Ee=0,ft,Ke="",Ye=0,Pe,w="",E;if(p&&(fe=g(D,"Exif",se),K=fe[0].length+_*12+fe[1].length),h&&(le=g(U,"GPS",se+K),Xe=le.join(""),Ee=Xe.length),_){var O=se+K+Ee;ft=g(z,"Interop",O),Ke=ft.join(""),Ye=Ke.length}if(I){var O=se+K+Ee+Ye;if(Pe=g(Ce,"1st",O),E=n(f.thumbnail),E.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var W="",Q="",he="",me="\0\0\0\0";if(p){var ie=c+se,Je=b(">L",[ie]),qe=34665,Qe=b(">H",[qe]),Ze=b(">H",[B.Long]),$e=b(">L",[1]);W=Qe+Ze+$e+Je}if(h){var ie=c+se+K,Je=b(">L",[ie]),qe=34853,Qe=b(">H",[qe]),Ze=b(">H",[B.Long]),$e=b(">L",[1]);Q=Qe+Ze+$e+Je}if(_){var ie=c+se+K+Ee,Je=b(">L",[ie]),qe=40965,Qe=b(">H",[qe]),Ze=b(">H",[B.Long]),$e=b(">L",[1]);he=Qe+Ze+$e+Je}if(I){var ie=c+se+K+Ee+Ye;me=b(">L",[ie]);var zi=ie+Pe[0].length+24+4+Pe[1].length,ji="\0\0\0\0"+b(">L",[zi]),Hi="\0\0\0\0"+b(">L",[E.length]);w=Pe[0]+ji+Hi+"\0\0\0\0"+Pe[1]+E}var Wi=ye[0]+W+Q+me+ye[1];return p&&(k=fe[0]+he+fe[1]),y+Wi+k+Xe+Ke+w};function i(l){return JSON.parse(JSON.stringify(l))}function n(l){for(var c=J(l);"ÿà"<=c[1].slice(0,2)&&c[1].slice(0,2)<="ÿï";)c=[c[0]].concat(c.slice(2));return c.join("")}function r(l){return b(">"+G("B",l.length),l)}function o(l){return b(">"+G("H",l.length),l)}function s(l){return b(">"+G("L",l.length),l)}function m(l,c,f){var y="",p="",h,_,I,M;if(c=="Byte")h=l.length,h<=4?p=r(l)+G("\0",4-h):(p=b(">L",[f]),y=r(l));else if(c=="Short")h=l.length,h<=2?p=o(l)+G("\0\0",2-h):(p=b(">L",[f]),y=o(l));else if(c=="Long")h=l.length,h<=1?p=s(l):(p=b(">L",[f]),y=s(l));else if(c=="Ascii")_=l+"\0",h=_.length,h>4?(p=b(">L",[f]),y=_):p=_+G("\0",4-h);else if(c=="Rational"){if(typeof l[0]=="number")h=1,I=l[0],M=l[1],_=b(">L",[I])+b(">L",[M]);else{h=l.length,_="";for(var D=0;D<h;D++)I=l[D][0],M=l[D][1],_+=b(">L",[I])+b(">L",[M])}p=b(">L",[f]),y=_}else if(c=="SRational"){if(typeof l[0]=="number")h=1,I=l[0],M=l[1],_=b(">l",[I])+b(">l",[M]);else{h=l.length,_="";for(var D=0;D<h;D++)I=l[D][0],M=l[D][1],_+=b(">l",[I])+b(">l",[M])}p=b(">L",[f]),y=_}else c=="Undefined"&&(h=l.length,h>4?(p=b(">L",[f]),y=l):p=l+G("\0",4-h));var z=b(">L",[h]);return[z,p,y]}function g(l,c,f){var y=8,p=Object.keys(l).length,h=b(">H",[p]),_;["0th","1st"].indexOf(c)>-1?_=2+p*12+4:_=2+p*12;var I="",M="",D;for(var D in l)if(typeof D=="string"&&(D=parseInt(D)),!(c=="0th"&&[34665,34853].indexOf(D)>-1)){{if(c=="Exif"&&D==40965)continue;if(c=="1st"&&[513,514].indexOf(D)>-1)continue}var z=l[D],U=b(">H",[D]),Ce=$[c][D].type,ye=b(">H",[B[Ce]]);typeof z=="number"&&(z=[z]);var se=y+_+f+M.length,fe=m(z,Ce,se),k=fe[0],K=fe[1],le=fe[2];I+=U+ye+k+K,M+=le}return[h+I,M]}function v(l){var c,f;if(l.slice(0,2)=="ÿØ")c=J(l),f=X(c),f?this.tiftag=f.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(l.slice(0,2))>-1)this.tiftag=l;else if(l.slice(0,4)=="Exif")this.tiftag=l.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(v.prototype={get_ifd:function(l,c){var f={},y=x(this.endian_mark+"H",this.tiftag.slice(l,l+2))[0],p=l+2,h;["0th","1st"].indexOf(c)>-1?h="Image":h=c;for(var _=0;_<y;_++){l=p+12*_;var I=x(this.endian_mark+"H",this.tiftag.slice(l,l+2))[0],M=x(this.endian_mark+"H",this.tiftag.slice(l+2,l+4))[0],D=x(this.endian_mark+"L",this.tiftag.slice(l+4,l+8))[0],z=this.tiftag.slice(l+8,l+12),U=[M,D,z];I in $[h]&&(f[I]=this.convert_value(U))}return c=="0th"&&(l=p+12*y,f.first_ifd_pointer=this.tiftag.slice(l,l+4)),f},convert_value:function(l){var c=null,f=l[0],y=l[1],p=l[2],h;if(f==1)y>4?(h=x(this.endian_mark+"L",p)[0],c=x(this.endian_mark+G("B",y),this.tiftag.slice(h,h+y))):c=x(this.endian_mark+G("B",y),p.slice(0,y));else if(f==2)y>4?(h=x(this.endian_mark+"L",p)[0],c=this.tiftag.slice(h,h+y-1)):c=p.slice(0,y-1);else if(f==3)y>2?(h=x(this.endian_mark+"L",p)[0],c=x(this.endian_mark+G("H",y),this.tiftag.slice(h,h+y*2))):c=x(this.endian_mark+G("H",y),p.slice(0,y*2));else if(f==4)y>1?(h=x(this.endian_mark+"L",p)[0],c=x(this.endian_mark+G("L",y),this.tiftag.slice(h,h+y*4))):c=x(this.endian_mark+G("L",y),p);else if(f==5)if(h=x(this.endian_mark+"L",p)[0],y>1){c=[];for(var _=0;_<y;_++)c.push([x(this.endian_mark+"L",this.tiftag.slice(h+_*8,h+4+_*8))[0],x(this.endian_mark+"L",this.tiftag.slice(h+4+_*8,h+8+_*8))[0]])}else c=[x(this.endian_mark+"L",this.tiftag.slice(h,h+4))[0],x(this.endian_mark+"L",this.tiftag.slice(h+4,h+8))[0]];else if(f==7)y>4?(h=x(this.endian_mark+"L",p)[0],c=this.tiftag.slice(h,h+y)):c=p.slice(0,y);else if(f==9)y>1?(h=x(this.endian_mark+"L",p)[0],c=x(this.endian_mark+G("l",y),this.tiftag.slice(h,h+y*4))):c=x(this.endian_mark+G("l",y),p);else if(f==10)if(h=x(this.endian_mark+"L",p)[0],y>1){c=[];for(var _=0;_<y;_++)c.push([x(this.endian_mark+"l",this.tiftag.slice(h+_*8,h+4+_*8))[0],x(this.endian_mark+"l",this.tiftag.slice(h+4+_*8,h+8+_*8))[0]])}else c=[x(this.endian_mark+"l",this.tiftag.slice(h,h+4))[0],x(this.endian_mark+"l",this.tiftag.slice(h+4,h+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+f);return c instanceof Array&&c.length==1?c[0]:c}},typeof window<"u"&&typeof window.btoa=="function")var C=window.btoa;if(typeof C>"u")var C=function(c){for(var f="",y,p,h,_,I,M,D,z=0,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";z<c.length;)y=c.charCodeAt(z++),p=c.charCodeAt(z++),h=c.charCodeAt(z++),_=y>>2,I=(y&3)<<4|p>>4,M=(p&15)<<2|h>>6,D=h&63,isNaN(p)?M=D=64:isNaN(h)&&(D=64),f=f+U.charAt(_)+U.charAt(I)+U.charAt(M)+U.charAt(D);return f};if(typeof window<"u"&&typeof window.atob=="function")var F=window.atob;if(typeof F>"u")var F=function(c){var f="",y,p,h,_,I,M,D,z=0,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");z<c.length;)_=U.indexOf(c.charAt(z++)),I=U.indexOf(c.charAt(z++)),M=U.indexOf(c.charAt(z++)),D=U.indexOf(c.charAt(z++)),y=_<<2|I>>4,p=(I&15)<<4|M>>2,h=(M&3)<<6|D,f=f+String.fromCharCode(y),M!=64&&(f=f+String.fromCharCode(p)),D!=64&&(f=f+String.fromCharCode(h));return f};function b(l,c){if(!(c instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(l.length-1!=c.length)throw new Error("'pack' error. "+(l.length-1)+" marks, "+c.length+" elements.");var f;if(l[0]=="<")f=!0;else if(l[0]==">")f=!1;else throw new Error("");for(var y="",p=1,h=null,_=null,I=null;_=l[p];){if(_.toLowerCase()=="b"){if(h=c[p-1],_=="b"&&h<0&&(h+=256),h>255||h<0)throw new Error("'pack' error.");I=String.fromCharCode(h)}else if(_=="H"){if(h=c[p-1],h>65535||h<0)throw new Error("'pack' error.");I=String.fromCharCode(Math.floor(h%65536/256))+String.fromCharCode(h%256),f&&(I=I.split("").reverse().join(""))}else if(_.toLowerCase()=="l"){if(h=c[p-1],_=="l"&&h<0&&(h+=4294967296),h>4294967295||h<0)throw new Error("'pack' error.");I=String.fromCharCode(Math.floor(h/16777216))+String.fromCharCode(Math.floor(h%16777216/65536))+String.fromCharCode(Math.floor(h%65536/256))+String.fromCharCode(h%256),f&&(I=I.split("").reverse().join(""))}else throw new Error("'pack' error.");y+=I,p+=1}return y}function x(l,c){if(typeof c!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var f=0,y=1;y<l.length;y++)if(l[y].toLowerCase()=="b")f+=1;else if(l[y].toLowerCase()=="h")f+=2;else if(l[y].toLowerCase()=="l")f+=4;else throw new Error("'unpack' error. Got invalid mark.");if(f!=c.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+f+":"+c.length);var p;if(l[0]=="<")p=!0;else if(l[0]==">")p=!1;else throw new Error("'unpack' error.");for(var h=[],_=0,I=1,M=null,D=null,z=null,U="";D=l[I];){if(D.toLowerCase()=="b")z=1,U=c.slice(_,_+z),M=U.charCodeAt(0),D=="b"&&M>=128&&(M-=256);else if(D=="H")z=2,U=c.slice(_,_+z),p&&(U=U.split("").reverse().join("")),M=U.charCodeAt(0)*256+U.charCodeAt(1);else if(D.toLowerCase()=="l")z=4,U=c.slice(_,_+z),p&&(U=U.split("").reverse().join("")),M=U.charCodeAt(0)*16777216+U.charCodeAt(1)*65536+U.charCodeAt(2)*256+U.charCodeAt(3),D=="l"&&M>=2147483648&&(M-=4294967296);else throw new Error("'unpack' error. "+D);h.push(M),_+=z,I+=1}return h}function G(l,c){for(var f="",y=0;y<c;y++)f+=l;return f}function J(l){if(l.slice(0,2)!="ÿØ")throw new Error("Given data isn't JPEG.");for(var c=2,f=["ÿØ"];;){if(l.slice(c,c+2)=="ÿÚ"){f.push(l.slice(c));break}else{var y=x(">H",l.slice(c+2,c+4))[0],p=c+y+2;f.push(l.slice(c,p)),c=p}if(c>=l.length)throw new Error("Wrong JPEG data.")}return f}function X(l){for(var c,f=0;f<l.length;f++)if(c=l[f],c.slice(0,2)=="ÿá"&&c.slice(4,10)=="Exif\0\0")return c;return null}function ne(l,c){var f=!1,y=[];return l.forEach(function(p,h){p.slice(0,2)=="ÿá"&&p.slice(4,10)=="Exif\0\0"&&(f?y.unshift(h):(l[h]=c,f=!0))}),y.forEach(function(p){l.splice(p,1)}),!f&&c&&(l=[l[0],c].concat(l.slice(1))),l.join("")}var B={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},$={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};$["0th"]=$.Image,$["1st"]=$.Image,t.TAGS=$,t.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},t.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},t.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},t.InteropIFD={InteroperabilityIndex:1},t.GPSHelper={degToDmsRational:function(l){var c=Math.abs(l),f=c%1*60,y=f%1*60,p=Math.floor(c),h=Math.floor(f),_=Math.round(y*100);return[[p,1],[h,1],[_,100]]},dmsRationalToDeg:function(l,c){var f=c==="S"||c==="W"?-1:1,y=l[0][0]/l[0][1]+l[1][0]/l[1][1]/60+l[2][0]/l[2][1]/3600;return y*f}},a.exports&&(e=a.exports=t),e.piexif=t})()})(Ut,Ut.exports);var ra=Ut.exports;const ue=na(ra),Y={FILE_TEXT:"FileText",FILE_CODE:"FileCode",FILE_TYPE:"FileType",CAMERA:"Camera",PLUS_CIRCLE:"PlusCircle",ALERT:"AlertCircle",ALERT_CIRCLE:"AlertCircle",EYE_OFF:"EyeOff",SETTINGS:"Settings",TAG:"Tag",TITLE:"Heading1",COMMENT:"MessageSquare",ACCOUNT:"User",CLOCK:"Clock",MAP_PIN:"MapPin",COPYRIGHT:"Copyright",SOURCE:"GitBranch"},Pi={"0th.271":{label:"Camera Make",section:"Camera",editable:!0,type:"string"},"0th.272":{label:"Camera Model",section:"Camera",editable:!0,type:"string"},"Exif.42033":{label:"Serial Number",section:"Camera",editable:!0,type:"string"},"Exif.42034":{label:"Lens Make",section:"Camera",editable:!0,type:"string"},"Exif.42035":{label:"Lens Serial Number",section:"Camera",editable:!0,type:"string"},"Exif.42036":{label:"Lens Model",section:"Camera",editable:!0,type:"string"},"0th.274":{label:"Orientation",section:"Camera",editable:!0,type:"number",editWarning:"Changing orientation may not rotate the image visually. Use image editing software for rotation."},"0th.282":{label:"X Resolution",section:"Camera",editable:!0,type:"rational",editWarning:"Changing resolution metadata does not resize the image. Only metadata will be updated."},"0th.283":{label:"Y Resolution",section:"Camera",editable:!0,type:"rational",editWarning:"Changing resolution metadata does not resize the image. Only metadata will be updated."},"0th.296":{label:"Resolution Unit",section:"Camera",editable:!0,type:"number"},"GPS.0":{label:"GPS Version ID",section:"Location",editable:!0,type:"array"},"GPS.1":{label:"GPS Latitude Ref",section:"Location",editable:!0,type:"string"},"GPS.2":{label:"GPS Latitude",section:"Location",editable:!0,type:"gps"},"GPS.3":{label:"GPS Longitude Ref",section:"Location",editable:!0,type:"string"},"GPS.4":{label:"GPS Longitude",section:"Location",editable:!0,type:"gps"},"GPS.5":{label:"GPS Altitude Ref",section:"Location",editable:!0,type:"number"},"GPS.6":{label:"GPS Altitude",section:"Location",editable:!0,type:"rational"},"GPS.7":{label:"GPS Timestamp",section:"Location",editable:!0,type:"array"},"GPS.8":{label:"GPS Satellites",section:"Location",editable:!0,type:"string"},"GPS.9":{label:"GPS Status",section:"Location",editable:!0,type:"string"},"GPS.10":{label:"GPS Measure Mode",section:"Location",editable:!0,type:"string"},"GPS.11":{label:"GPS DOP",section:"Location",editable:!0,type:"rational"},"GPS.12":{label:"GPS Speed Ref",section:"Location",editable:!0,type:"string"},"GPS.13":{label:"GPS Speed",section:"Location",editable:!0,type:"rational"},"GPS.14":{label:"GPS Track Ref",section:"Location",editable:!0,type:"string"},"GPS.15":{label:"GPS Track",section:"Location",editable:!0,type:"rational"},"GPS.16":{label:"GPS Image Direction Ref",section:"Location",editable:!0,type:"string"},"GPS.17":{label:"GPS Image Direction",section:"Location",editable:!0,type:"rational"},"GPS.18":{label:"GPS Map Datum",section:"Location",editable:!0,type:"string"},"GPS.29":{label:"GPS Date",section:"Location",editable:!0,type:"string"},"Exif.36867":{label:"Date Taken (Original)",section:"Timestamps",editable:!0,type:"datetime"},"Exif.36868":{label:"Date Digitized",section:"Timestamps",editable:!0,type:"datetime"},"0th.306":{label:"Date Modified",section:"Timestamps",editable:!0,type:"datetime"},"Exif.37520":{label:"Subsec Time",section:"Timestamps",editable:!0,type:"string"},"Exif.37521":{label:"Subsec Time Original",section:"Timestamps",editable:!0,type:"string"},"Exif.37522":{label:"Subsec Time Digitized",section:"Timestamps",editable:!0,type:"string"},"0th.315":{label:"Author",section:"Author",editable:!0,type:"string"},"0th.33432":{label:"Copyright",section:"Author",editable:!0,type:"string"},"Exif.34855":{label:"ISO Speed",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual ISO used when the photo was taken. Editing creates incorrect metadata."},"Exif.34856":{label:"ISO Speed Ratings",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual ISO used. Editing creates incorrect metadata."},"Exif.33434":{label:"Exposure Time",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual shutter speed used. Editing creates incorrect technical metadata."},"Exif.33437":{label:"F-Number",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual aperture used. Editing creates incorrect technical metadata."},"Exif.37377":{label:"Shutter Speed",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual shutter speed used. Editing creates incorrect technical metadata."},"Exif.37378":{label:"Aperture",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual aperture used. Editing creates incorrect technical metadata."},"Exif.37379":{label:"Brightness Value",section:"Technical",editable:!0,type:"rational"},"Exif.37380":{label:"Exposure Bias",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual exposure compensation used. Editing creates incorrect metadata."},"Exif.37381":{label:"Max Aperture Value",section:"Technical",editable:!0,type:"rational"},"Exif.37382":{label:"Subject Distance",section:"Technical",editable:!0,type:"rational"},"Exif.37383":{label:"Metering Mode",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual metering mode used. Editing creates incorrect technical metadata."},"Exif.37384":{label:"Light Source",section:"Technical",editable:!0,type:"number"},"Exif.37385":{label:"Flash",section:"Technical",editable:!0,type:"number",editWarning:"This reflects whether flash was actually used. Editing creates incorrect metadata."},"Exif.37386":{label:"Focal Length",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual focal length used. Editing creates incorrect technical metadata."},"Exif.41486":{label:"Focal Length (35mm)",section:"Technical",editable:!0,type:"number",editWarning:"This is the calculated 35mm equivalent. Editing creates incorrect metadata."},"Exif.41989":{label:"Focal Length in 35mm Film",section:"Technical",editable:!0,type:"number",editWarning:"This is the calculated 35mm equivalent. Editing creates incorrect metadata."},"Exif.40962":{label:"Image Width",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"Exif.40963":{label:"Image Height",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"0th.256":{label:"Image Width",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"0th.257":{label:"Image Height",section:"Technical",editable:!0,type:"number",editWarning:"Changing this does NOT resize the image. Incorrect values may cause display issues."},"Exif.34850":{label:"Exposure Program",section:"Technical",editable:!0,type:"number"},"Exif.37396":{label:"Subject Area",section:"Technical",editable:!0,type:"array"},"Exif.41483":{label:"Flash Energy",section:"Technical",editable:!0,type:"rational"},"Exif.41495":{label:"Sensing Method",section:"Technical",editable:!0,type:"number"},"Exif.41728":{label:"File Source",section:"Technical",editable:!0,type:"number"},"Exif.41729":{label:"Scene Type",section:"Technical",editable:!0,type:"number"},"Exif.41985":{label:"Custom Rendered",section:"Technical",editable:!0,type:"number"},"Exif.41986":{label:"Exposure Mode",section:"Technical",editable:!0,type:"number"},"Exif.41987":{label:"White Balance",section:"Technical",editable:!0,type:"number",editWarning:"This reflects the actual white balance used. Editing creates incorrect metadata."},"Exif.41988":{label:"Digital Zoom Ratio",section:"Technical",editable:!0,type:"rational",editWarning:"This reflects the actual digital zoom used. Editing creates incorrect metadata."},"Exif.41990":{label:"Scene Capture Type",section:"Technical",editable:!0,type:"number"},"Exif.41991":{label:"Gain Control",section:"Technical",editable:!0,type:"number"},"Exif.41992":{label:"Contrast",section:"Technical",editable:!0,type:"number"},"Exif.41993":{label:"Saturation",section:"Technical",editable:!0,type:"number"},"Exif.41994":{label:"Sharpness",section:"Technical",editable:!0,type:"number"},"Exif.41996":{label:"Subject Distance Range",section:"Technical",editable:!0,type:"number"},"Exif.42240":{label:"Gamma",section:"Technical",editable:!0,type:"rational"},"0th.305":{label:"Software",section:"Technical",editable:!0,type:"string"},"Exif.40960":{label:"EXIF Version",section:"Technical",editable:!0,type:"string"},"Exif.40961":{label:"Color Space",section:"Technical",editable:!0,type:"number"},"0th.258":{label:"Bits Per Sample",section:"Technical",editable:!0,type:"array"},"0th.259":{label:"Compression",section:"Technical",editable:!0,type:"number"},"0th.262":{label:"Photometric Interpretation",section:"Technical",editable:!0,type:"number"},"0th.277":{label:"Samples Per Pixel",section:"Technical",editable:!0,type:"number"},"0th.284":{label:"Planar Configuration",section:"Technical",editable:!0,type:"number"},"0th.530":{label:"YCbCr SubSampling",section:"Technical",editable:!0,type:"array"},"0th.531":{label:"YCbCr Positioning",section:"Technical",editable:!0,type:"number"},"Exif.37510":{label:"User Comment",section:"Hidden",steganography:!0,editable:!0,type:"string"},"0th.270":{label:"Image Description",section:"Hidden",steganography:!0,editable:!0,type:"string"},"Exif.42016":{label:"Image Unique ID",section:"Hidden",editable:!0,type:"string"}},Fe={Camera:{name:"Camera Information",icon:Y.CAMERA,color:"primary",description:"Camera make, model, and lens information"},Location:{name:"Location (GPS)",icon:Y.MAP_PIN,color:"info",description:"GPS coordinates and location data"},Timestamps:{name:"Timestamps",icon:Y.CLOCK,color:"info",description:"When the photo was taken and modified"},Author:{name:"Copyright & Author",icon:Y.COPYRIGHT,color:"secondary",description:"Copyright and authorship information"},Technical:{name:"Technical Details",icon:Y.SETTINGS,color:"grey",description:"Camera settings and image properties"},Hidden:{name:"Hidden Data",icon:Y.EYE_OFF,color:"warning",description:"User comments and custom fields"}};function oa(a,e){const t=`${a}.${e}`;return Pi[t]||null}function sa(){return Object.entries(Pi).map(([a,e])=>{const[t,i]=a.split(".");return{key:a,ifd:t,tagId:parseInt(i),...e}})}function la(){const a={};return Object.keys(Fe).forEach(e=>{a[e]=[]}),sa().forEach(e=>{a[e.section]&&a[e.section].push(e)}),a}function xi(a,e){if(!e)return{valid:!0,warning:null};const t=String(a).trim();switch(e){case"string":return{valid:!0,warning:null};case"number":return isNaN(Number(t))?{valid:!1,warning:`Expected a number, but got "${t}". This may cause errors.`}:{valid:!0,warning:null};case"rational":if(t.includes("/")){const r=t.split("/");if(r.length!==2||isNaN(Number(r[0]))||isNaN(Number(r[1])))return{valid:!1,warning:`Expected a fraction like "1/125" or decimal number, but got "${t}".`}}else if(isNaN(Number(t)))return{valid:!1,warning:`Expected a number or fraction (e.g., "1/125"), but got "${t}".`};return{valid:!0,warning:null};case"datetime":return/^\d{4}:\d{2}:\d{2} \d{2}:\d{2}:\d{2}$/.test(t)?{valid:!0,warning:null}:{valid:!1,warning:`Expected datetime format "YYYY:MM:DD HH:MM:SS", but got "${t}".`};case"gps":const n=parseFloat(t);return isNaN(n)?{valid:!1,warning:`Expected GPS coordinate as decimal degrees (e.g., "37.7749"), but got "${t}".`}:n<-180||n>180?{valid:!1,warning:`GPS coordinate "${t}" is out of range (-180 to 180).`}:{valid:!0,warning:null};case"array":return{valid:!0,warning:"Array values are complex. Ensure format matches the original value structure."};default:return{valid:!0,warning:null}}}function $t(a,e,t){if(a==null)return"N/A";if(Array.isArray(a)){if(e==="GPS"&&(t===2||t===4))try{const[i,n,r]=a,o=Array.isArray(i)?i[0]/(i[1]||1):i,s=Array.isArray(n)?n[0]/(n[1]||1):n,m=Array.isArray(r)?r[0]/(r[1]||1):r;return typeof o!="number"||typeof s!="number"||typeof m!="number"||isNaN(o)||isNaN(s)||isNaN(m)?a.join(", "):`${(o+s/60+m/3600).toFixed(6)}°`}catch{return a.join(", ")}return e==="GPS"&&t===6?Array.isArray(a)&&a.length>=1?`${Array.isArray(a[0])?a[0][0]/(a[0][1]||1):a[0]} m`:a.join(", "):e==="Exif"&&t===33434?Array.isArray(a)&&a.length>=2&&typeof a[0]=="number"&&typeof a[1]=="number"?a[1]?`1/${a[1]} s`:`${a[0]} s`:a.join(", "):e==="Exif"&&t===33437&&Array.isArray(a)&&a.length>=2&&typeof a[0]=="number"&&typeof a[1]=="number"&&a[1]!==0?`f/${(a[0]/a[1]).toFixed(1)}`:a.join(", ")}if(a instanceof Uint8Array||a instanceof ArrayBuffer){const i=new TextDecoder("utf-8",{fatal:!1});try{return i.decode(a)}catch{return"[Binary Data]"}}return typeof a=="string"?a.trim():typeof a=="number"?a.toString():String(a)}async function ca(a){try{const e=a.includes(",")?a.split(",")[1]:a,t=ue.load("data:image/jpeg;base64,"+e);return da(t)}catch(e){throw e.message&&e.message.includes("not a valid JPEG")?new Error("Image does not contain EXIF data or is not a valid JPEG"):new Error(`Failed to load EXIF data: ${e.message||"Unknown error"}`)}}function da(a,e=!0){const t={};if(Object.keys(Fe).forEach(i=>{t[i]={name:Fe[i].name,icon:Fe[i].icon,color:Fe[i].color,description:Fe[i].description,warning:Fe[i].warning||!1,fields:[]}}),e){const i=la();Object.entries(i).forEach(([n,r])=>{t[n]&&r.forEach(o=>{let s=null,m=null,g=!1;a[o.ifd]&&a[o.ifd][o.tagId]!==void 0&&a[o.ifd][o.tagId]!==null&&(m=a[o.ifd][o.tagId],s=$t(m,o.ifd,o.tagId),g=!0),t[n].fields.push({label:o.label,key:o.key,ifd:o.ifd,tagId:o.tagId,value:s||"",rawValue:m,editable:o.editable,warning:o.warning||!1,editWarning:o.editWarning||null,icon:o.icon,type:o.type,isPopulated:g})})})}else for(const[i,n]of Object.entries(a))if(!(i==="thumbnail"||typeof n!="object"||n===null))for(const[r,o]of Object.entries(n)){if(o==null)continue;const s=oa(i,parseInt(r));if(s){const m=t[s.section];m&&m.fields.push({label:s.label,key:`${i}.${r}`,ifd:i,tagId:parseInt(r),value:$t(o,i,parseInt(r)),rawValue:o,editable:s.editable,warning:s.warning||!1,editWarning:s.editWarning||null,icon:s.icon,type:s.type,isPopulated:!0})}}return t}async function ua(a){try{const e=a.includes(",")?a.split(",")[1]:a;return ue.remove("data:image/jpeg;base64,"+e).split(",")[1]}catch(e){throw new Error(`Failed to remove metadata: ${e.message||"Unknown error"}`)}}function fa(a){return a.Location&&a.Location.fields.length>0}function ha(a){return Object.values(a).reduce((e,t)=>e+t.fields.length,0)}function ma(a){const e=ha(a),t=fa(a),i=Object.keys(a).length,n=Object.values(a).reduce((s,m)=>s+m.fields.filter(g=>g.editable).length,0),r=Object.values(a).reduce((s,m)=>s+m.fields.filter(g=>g.warning).length,0),o=Object.values(a).reduce((s,m)=>s+m.fields.filter(g=>g.isPopulated).length,0);return{totalFields:e,populatedFields:o,sections:i,editableFields:n,privacyFields:r,hasGPS:t,hasCameraInfo:!!a.Camera,hasTimestamps:!!a.Timestamps,hasAuthorInfo:!!a.Author}}function pa(a){return new Promise((e,t)=>{const i=new FileReader;i.onload=n=>{e(n.target.result)},i.onerror=n=>{t(new Error(`Failed to read file: ${n.message||"Unknown error"}`))},i.readAsDataURL(a)})}function Ft(a,e="image/jpeg"){const t=a.includes(",")?a.split(",")[1]:a,i=atob(t),n=new Uint8Array(i.length);for(let r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return new Blob([n],{type:e})}async function ga(a,e,t){try{const i=a.includes(",")?a.split(",")[1]:a,n=ue.load("data:image/jpeg;base64,"+i),r=Sa(t,e.ifd,e.tagId,e.rawValue);n[e.ifd]||(n[e.ifd]={}),n[e.ifd][e.tagId]=r;const o=ue.dump(n);return ue.insert(o,"data:image/jpeg;base64,"+i).split(",")[1]}catch(i){throw new Error(`Failed to edit metadata field: ${i.message||"Unknown error"}`)}}async function ya(a,e){try{const t=a.includes(",")?a.split(",")[1]:a,i=ue.load("data:image/jpeg;base64,"+t);i[e.ifd]&&i[e.ifd][e.tagId]&&delete i[e.ifd][e.tagId];const n=ue.dump(i);return ue.insert(n,"data:image/jpeg;base64,"+t).split(",")[1]}catch(t){throw new Error(`Failed to remove metadata field: ${t.message||"Unknown error"}`)}}function Sa(a,e,t,i){if(typeof i=="string")return String(a);if(typeof i=="number")return Number(a);if(Array.isArray(i)){if(e==="GPS"&&(t===7||t===29))return a;if(e==="Exif"&&(t===33434||t===33437)){if(typeof a=="string"&&a.includes("/")){const[n,r]=a.split("/").map(o=>parseInt(o.trim()));return[n,r]}return i}if(e==="GPS"&&(t===2||t===4)){if(typeof a=="string"||typeof a=="number"){const n=parseFloat(a);if(!isNaN(n)){const r=Math.floor(Math.abs(n)),o=Math.floor((Math.abs(n)-r)*60),s=(Math.abs(n)-r-o/60)*3600;return[r,o,s]}}return i}return i}return String(a)}async function va(a){try{const e=a.includes(",")?a.split(",")[1]:a,t=ue.load("data:image/jpeg;base64,"+e),i={"0th":{},Exif:{},GPS:{},"1st":{},Interop:{}},n=ue.dump(i);return ue.insert(n,"data:image/jpeg;base64,"+e).split(",")[1]}catch(e){throw new Error(`Failed to clear metadata: ${e.message||"Unknown error"}`)}}async function ba(a,e,t,i,n){try{const r=a.includes(",")?a.split(",")[1]:a,o=ue.load("data:image/jpeg;base64,"+r);let s;switch(n){case"number":if(s=parseInt(i),isNaN(s))throw new Error("Invalid number value");break;case"rational":if(i.includes("/")){const[v,C]=i.split("/").map(F=>parseInt(F.trim()));if(isNaN(v)||isNaN(C))throw new Error("Invalid rational value");s=[v,C]}else{const v=parseFloat(i);if(isNaN(v))throw new Error("Invalid rational value");s=[Math.round(v*100),100]}break;case"array":s=i.split(",").map(v=>{const C=parseInt(v.trim());return isNaN(C)?v.trim():C});break;case"string":case"datetime":default:s=String(i);break}o[e]||(o[e]={}),o[e][t]=s;const m=ue.dump(o);return ue.insert(m,"data:image/jpeg;base64,"+r).split(",")[1]}catch(r){throw new Error(`Failed to add custom field: ${r.message||"Unknown error"}`)}}var Pt=typeof self<"u"?self:global;const rt=typeof navigator<"u",Ca=rt&&typeof HTMLImageElement>"u",yt=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),xt=Pt.Buffer,ht=Pt.BigInt,wt=!!xt,Pa=a=>a;function St(a,e=Pa){if(yt)try{return typeof require=="function"?Promise.resolve(e(require(a))):Yi(()=>import(a),__vite__mapDeps([])).then(e)}catch{console.warn(`Couldn't load ${a}`)}}let Wt=Pt.fetch;const xa=a=>Wt=a;if(!Pt.fetch){const a=St("http",i=>i),e=St("https",i=>i),t=(i,{headers:n}={})=>new Promise(async(r,o)=>{let{port:s,hostname:m,pathname:g,protocol:v,search:C}=new URL(i);const F={method:"GET",hostname:m,path:encodeURI(g)+C,headers:n};s!==""&&(F.port=Number(s));const b=(v==="https:"?await e:await a).request(F,x=>{if(x.statusCode===301||x.statusCode===302){let G=new URL(x.headers.location,i).toString();return t(G,{headers:n}).then(r).catch(o)}r({status:x.statusCode,arrayBuffer:()=>new Promise(G=>{let J=[];x.on("data",X=>J.push(X)),x.on("end",()=>G(Buffer.concat(J)))})})});b.on("error",o),b.end()});xa(t)}function R(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}const vt=a=>wi(a)?void 0:a,wa=a=>a!==void 0;function wi(a){return a===void 0||(a instanceof Map?a.size===0:Object.values(a).filter(wa).length===0)}function te(a){let e=new Error(a);throw delete e.stack,e}function De(a){return(a=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(a).trim())===""?void 0:a}function Bt(a){let e=function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048}(a);return a.jfif.enabled&&(e+=50),a.xmp.enabled&&(e+=2e4),a.iptc.enabled&&(e+=14e3),a.icc.enabled&&(e+=6e3),e}const Vt=a=>String.fromCharCode.apply(null,a),ei=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function _i(a){return ei?ei.decode(a):wt?Buffer.from(a).toString("utf8"):decodeURIComponent(escape(Vt(a)))}class de{static from(e,t){return e instanceof this&&e.le===t?e:new de(e,void 0,void 0,t)}constructor(e,t=0,i,n){if(typeof n=="boolean"&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let r=new DataView(e,t,i);this._swapDataView(r)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof de){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&te("Creating view outside of available memory in ArrayBuffer");let r=new DataView(e.buffer,t,i);this._swapDataView(r)}else if(typeof e=="number"){let r=new DataView(new ArrayBuffer(e));this._swapDataView(r)}else te("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=de){return e instanceof DataView||e instanceof de?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||te("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new de(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return _i(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return Vt(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return Vt(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function zt(a,e){te(`${a} '${e}' was not loaded, try using full build of exifr.`)}class Xt extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||zt(this.kind,e),t&&(e in t||function(i,n){te(`Unknown ${i} '${n}'.`)}(this.kind,e),t[e].enabled||zt(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var Se=new Xt("file parser"),ee=new Xt("segment parser"),ve=new Xt("file reader");function _a(a,e){return typeof a=="string"?ti(a,e):rt&&!Ca&&a instanceof HTMLImageElement?ti(a.src,e):a instanceof Uint8Array||a instanceof ArrayBuffer||a instanceof DataView?new de(a):rt&&a instanceof Blob?jt(a,e,"blob",Ne):void te("Invalid input argument")}function ti(a,e){return(t=a).startsWith("data:")||t.length>1e4?Ht(a,e,"base64"):yt&&a.includes("://")?jt(a,e,"url",Ge):yt?Ht(a,e,"fs"):rt?jt(a,e,"url",Ge):void te("Invalid input argument");var t}async function jt(a,e,t,i){return ve.has(t)?Ht(a,e,t):i?async function(n,r){let o=await r(n);return new de(o)}(a,i):void te(`Parser ${t} is not loaded`)}async function Ht(a,e,t){let i=new(ve.get(t))(a,e);return await i.read(),i}const Ge=a=>Wt(a).then(e=>e.arrayBuffer()),Ne=a=>new Promise((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(a)});class ka extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function Z(a,e,t){let i=new ka;for(let[n,r]of t)i.set(n,r);if(Array.isArray(e))for(let n of e)a.set(n,i);else a.set(e,i);return i}function Ue(a,e,t){let i,n=a.get(e);for(i of t)n.set(i[0],i[1])}const ae=new Map,ge=new Map,Te=new Map,we=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],He=["jfif","xmp","icc","iptc","ihdr"],Be=["tiff",...He],q=["ifd0","ifd1","exif","gps","interop"],_e=[...Be,...q],ke=["makerNote","userComment"],We=["translateKeys","translateValues","reviveValues","multiSegment"],Ie=[...We,"sanitize","mergeOutput","silentErrors"];class ki{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class et extends ki{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),R(this,"enabled",!1),R(this,"skip",new Set),R(this,"pick",new Set),R(this,"deps",new Set),R(this,"translateKeys",!1),R(this,"translateValues",!1),R(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=q.includes(e),this.canBeFiltered&&(this.dict=ae.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:r,skip:o}=i;r&&r.length>0&&this.translateTagSet(r,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:te(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of We)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:r,tagValues:o}=this.dict;for(i of e)typeof i=="string"?(n=o.indexOf(i),n===-1&&(n=r.indexOf(Number(i))),n!==-1&&t.add(Number(r[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,bt(this.pick,this.deps)):this.enabled&&this.pick.size>0&&bt(this.pick,this.deps)}}var re={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},ii=new Map;class Ve extends ki{static useCached(e){let t=ii.get(e);return t!==void 0||(t=new this(e),ii.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):te(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=rt?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of we)this[e]=re[e];for(e of Ie)this[e]=re[e];for(e of ke)this[e]=re[e];for(e of _e)this[e]=new et(e,re[e],void 0,this)}setupFromTrue(){let e;for(e of we)this[e]=re[e];for(e of Ie)this[e]=re[e];for(e of ke)this[e]=!0;for(e of _e)this[e]=new et(e,!0,void 0,this)}setupFromArray(e){let t;for(t of we)this[t]=re[t];for(t of Ie)this[t]=re[t];for(t of ke)this[t]=re[t];for(t of _e)this[t]=new et(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,q)}setupFromObject(e){let t;for(t of(q.ifd0=q.ifd0||q.image,q.ifd1=q.ifd1||q.thumbnail,Object.assign(this,e),we))this[t]=Dt(e[t],re[t]);for(t of Ie)this[t]=Dt(e[t],re[t]);for(t of ke)this[t]=Dt(e[t],re[t]);for(t of Be)this[t]=new et(t,re[t],e[t],this);for(t of q)this[t]=new et(t,re[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,q,_e),e.tiff===!0?this.batchEnableWithBool(q,!0):e.tiff===!1?this.batchEnableWithUserValue(q,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,q):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,q)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let n=t[i];this[i].enabled=n!==!1&&n!==void 0}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let o of n)this[o].enabled=!1;let r=ai(e,i);for(let[o,s]of r)bt(this[o].pick,s),this[o].enabled=!0}else if(t&&t.length){let r=ai(t,i);for(let[o,s]of r)bt(this[o].skip,s)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:r}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),r.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=q.some(r=>this[r].enabled===!0)||this.makerNote||this.userComment;for(let r of q)this[r].finalizeFilters()}get onlyTiff(){return!He.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of Be)this[e].enabled&&!ee.has(e)&&zt("segment parser",e)}}function ai(a,e){let t,i,n,r,o=[];for(n of e){for(r of(t=ae.get(n),i=[],t))(a.includes(r[0])||a.includes(r[1]))&&i.push(r[0]);i.length&&o.push([n,i])}return o}function Dt(a,e){return a!==void 0?a:e!==void 0?e:void 0}function bt(a,e){for(let t of e)a.add(t)}R(Ve,"default",re);class Ae{constructor(e){R(this,"parsers",{}),R(this,"output",{}),R(this,"errors",[]),R(this,"pushToErrors",t=>this.errors.push(t)),this.options=Ve.useCached(e)}async read(e){this.file=await _a(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of Se)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),te("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),vt(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async i=>{let n=await i.parse();i.assignToOutput(e,n)});this.options.silentErrors&&(t=t.map(i=>i.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=ee.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),n===void 0)return;let r=await this.fileParser.ensureSegmentChunk(n),o=this.parsers.tiff=new i(r,e,t),s=await o.extractThumbnail();return t.close&&t.close(),s}}async function _t(a,e){let t=new Ae(e);return await t.read(a),t.parse()}var Ia=Object.freeze({__proto__:null,parse:_t,Exifr:Ae,fileParsers:Se,segmentParsers:ee,fileReaders:ve,tagKeys:ae,tagValues:ge,tagRevivers:Te,createDictionary:Z,extendDictionary:Ue,fetchUrlAsArrayBuffer:Ge,readBlobAsArrayBuffer:Ne,chunkedProps:we,otherSegments:He,segments:Be,tiffBlocks:q,segmentsAndBlocks:_e,tiffExtractables:ke,inheritables:We,allFormatters:Ie,Options:Ve});class kt{constructor(e,t,i){R(this,"errors",[]),R(this,"ensureSegmentChunk",async n=>{let r=n.start,o=n.size||65536;if(this.file.chunked)if(this.file.available(r,o))n.chunk=this.file.subarray(r,o);else try{n.chunk=await this.file.readChunk(r,o)}catch(s){te(`Couldn't read segment: ${JSON.stringify(n)}. ${s.message}`)}else this.file.byteLength>r+o?n.chunk=this.file.subarray(r,o):n.size===void 0?n.chunk=this.file.subarray(r):te("Segment unreachable: "+JSON.stringify(n));return n.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(ee.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:n}=t,r=this.options[i];if(r&&r.enabled){let o=this.parsers[i];o&&o.append||o||this.createParser(i,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class pe{static findPosition(e,t){let i=e.getUint16(t+2)+2,n=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,r=t+n,o=i-n;return{offset:t,length:i,headerLength:n,start:r,size:o,end:r+o}}static parse(e,t={}){return new this(e,new Ve({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof de?e:new de(e)}constructor(e,t={},i){R(this,"errors",[]),R(this,"raw",new Map),R(this,"handleError",n=>{if(!this.options.silentErrors)throw n;this.errors.push(n.message)}),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=Te.get(t),n=ge.get(t),r=ae.get(t),o=this.options[t],s=o.reviveValues&&!!i,m=o.translateValues&&!!n,g=o.translateKeys&&!!r,v={};for(let[C,F]of e)s&&i.has(C)?F=i.get(C)(F):m&&n.has(C)&&(F=this.translateValue(F,n.get(C))),g&&r.has(C)&&(C=r.get(C)||C),v[C]=F;return v}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}R(pe,"headerLength",4),R(pe,"type",void 0),R(pe,"multiSegment",!1),R(pe,"canHandle",()=>!1);function Ta(a){return a===192||a===194||a===196||a===219||a===221||a===218||a===254}function Aa(a){return a>=224&&a<=239}function Ea(a,e,t){for(let[i,n]of ee)if(n.canHandle(a,e,t))return i}class ni extends kt{constructor(...e){super(...e),R(this,"appSegments",[]),R(this,"jpegSegments",[]),R(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(ee.keyList())):(e=e===void 0?ee.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&ee.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:r,remaining:o}=this;if(!n&&this.file.chunked&&(n=Array.from(r).some(s=>{let m=ee.get(s),g=this.options[s];return m.multiSegment&&g.multiSegment}),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let s=!1;for(;o.size>0&&!s&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:m}=i,g=this.appSegments.some(v=>!this.file.available(v.offset||v.start,v.length||v.size));if(s=e>m&&!g?!await i.readNextChunk(e):!await i.readNextChunk(m),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,r,o,s,m,{file:g,findAll:v,wanted:C,remaining:F,options:b}=this;for(;e<t;e++)if(g.getUint8(e)===255){if(i=g.getUint8(e+1),Aa(i)){if(n=g.getUint16(e+2),r=Ea(g,e,n),r&&C.has(r)&&(o=ee.get(r),s=o.findPosition(g,e),m=b[r],s.type=r,this.appSegments.push(s),!v&&(o.multiSegment&&m.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||F.delete(r)):F.delete(r),F.size===0)))break;b.recordUnknownSegments&&(s=pe.findPosition(g,e),s.marker=i,this.unknownSegments.push(s)),e+=n+1}else if(Ta(i)){if(n=g.getUint16(e+2),i===218&&b.stopAfterSos!==!1)return;b.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,i){let n,r,o,s=new Map;for(let m=0;m<t.length;m++)n=t[m],r=n[i],s.has(r)?o=s.get(r):s.set(r,o=[]),o.push(n);return Array.from(s)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,i])=>{let n=ee.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(i)}:i[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}R(ni,"type","jpeg"),Se.set("jpeg",ni);const Fa=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Da extends pe{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:r}=this.options[t];n=new Set(n);let o=n.size>0,s=r.size===0,m=this.chunk.getUint16(e);e+=2;for(let g=0;g<m;g++){let v=this.chunk.getUint16(e);if(o){if(n.has(v)&&(i.set(v,this.parseTag(e,v,t)),n.delete(v),n.size===0))break}else!s&&r.has(v)||i.set(v,this.parseTag(e,v,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,r=n.getUint16(e+2),o=n.getUint32(e+4),s=Fa[r];if(s*o<=4?e+=8:e=n.getUint32(e+8),(r<1||r>13)&&te(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>n.byteLength&&te(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${n.byteLength}`),r===1)return n.getUint8Array(e,o);if(r===2)return De(n.getString(e,o));if(r===7)return n.getUint8Array(e,o);if(o===1)return this.parseTagValue(r,e);{let m=new(function(v){switch(v){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(r))(o),g=s;for(let v=0;v<o;v++)m[v]=this.parseTagValue(r,e),e+=g;return m}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:te(`Invalid tiff type ${e}`)}}}class Lt extends Da{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&te("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&te(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,Bt(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,Bt(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ri(...e.get(2),e.get(1))),e.set("longitude",ri(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of q)if(e=this[t],!wi(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function ri(a,e,t,i){var n=a+e/60+t/3600;return i!=="S"&&i!=="W"||(n*=-1),n}R(Lt,"type","tiff"),R(Lt,"headerLength",10),ee.set("tiff",Lt);var La=Object.freeze({__proto__:null,default:Ia,Exifr:Ae,fileParsers:Se,segmentParsers:ee,fileReaders:ve,tagKeys:ae,tagValues:ge,tagRevivers:Te,createDictionary:Z,extendDictionary:Ue,fetchUrlAsArrayBuffer:Ge,readBlobAsArrayBuffer:Ne,chunkedProps:we,otherSegments:He,segments:Be,tiffBlocks:q,segmentsAndBlocks:_e,tiffExtractables:ke,inheritables:We,allFormatters:Ie,Options:Ve,parse:_t});const Kt={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Yt=Object.assign({},Kt,{firstChunkSize:4e4,gps:[1,2,3,4]});async function Ii(a){let e=new Ae(Yt);await e.read(a);let t=await e.parse();if(t&&t.gps){let{latitude:i,longitude:n}=t.gps;return{latitude:i,longitude:n}}}const Jt=Object.assign({},Kt,{tiff:!1,ifd1:!0,mergeOutput:!1});async function Ti(a){let e=new Ae(Jt);await e.read(a);let t=await e.extractThumbnail();return t&&wt?xt.from(t):t}async function Ai(a){let e=await this.thumbnail(a);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}const qt=Object.assign({},Kt,{firstChunkSize:4e4,ifd0:[274]});async function Qt(a){let e=new Ae(qt);await e.read(a);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const Zt=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Le=!0,Re=!0;if(typeof navigator=="object"){let a=navigator.userAgent;if(a.includes("iPad")||a.includes("iPhone")){let e=a.match(/OS (\d+)_(\d+)/);if(e){let[,t,i]=e;Le=Number(t)+.1*Number(i)<13.4,Re=!1}}else if(a.includes("OS X 10")){let[,e]=a.match(/OS X 10[_.](\d+)/);Le=Re=Number(e)<15}if(a.includes("Chrome/")){let[,e]=a.match(/Chrome\/(\d+)/);Le=Re=Number(e)<81}else if(a.includes("Firefox/")){let[,e]=a.match(/Firefox\/(\d+)/);Le=Re=Number(e)<77}}async function Ei(a){let e=await Qt(a);return Object.assign({canvas:Le,css:Re},Zt[e])}class Ra extends de{constructor(...e){super(...e),R(this,"ranges",new Ma),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let n=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(n)}else{let n=e+t;if(n>this.byteLength){let{dataView:r}=this._extend(n);this._swapDataView(r)}}}_extend(e){let t;t=wt?xt.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Ma{constructor(){R(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,r=this.list.filter(o=>oi(e,o.offset,n)||oi(e,o.end,n));if(r.length>0){e=Math.min(e,...r.map(s=>s.offset)),n=Math.max(n,...r.map(s=>s.end)),t=n-e;let o=r.shift();o.offset=e,o.length=t,o.end=n,this.list=this.list.filter(s=>!r.includes(s))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some(n=>n.offset<=e&&i<=n.end)}}function oi(a,e,t){return a<=e&&e<=t}class It extends Ra{constructor(e,t){super(0),R(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}ve.set("blob",class extends It{async readWhole(){this.chunked=!1;let a=await Ne(this.input);this._swapArrayBuffer(a)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(a,e){let t=e?a+e:void 0,i=this.input.slice(a,t),n=await Ne(i);return this.set(n,a,!0)}});var Oa=Object.freeze({__proto__:null,default:La,Exifr:Ae,fileParsers:Se,segmentParsers:ee,fileReaders:ve,tagKeys:ae,tagValues:ge,tagRevivers:Te,createDictionary:Z,extendDictionary:Ue,fetchUrlAsArrayBuffer:Ge,readBlobAsArrayBuffer:Ne,chunkedProps:we,otherSegments:He,segments:Be,tiffBlocks:q,segmentsAndBlocks:_e,tiffExtractables:ke,inheritables:We,allFormatters:Ie,Options:Ve,parse:_t,gpsOnlyOptions:Yt,gps:Ii,thumbnailOnlyOptions:Jt,thumbnail:Ti,thumbnailUrl:Ai,orientationOnlyOptions:qt,orientation:Qt,rotations:Zt,get rotateCanvas(){return Le},get rotateCss(){return Re},rotation:Ei});ve.set("url",class extends It{async readWhole(){this.chunked=!1;let a=await Ge(this.input);a instanceof ArrayBuffer?this._swapArrayBuffer(a):a instanceof Uint8Array&&this._swapBuffer(a)}async _readChunk(a,e){let t=e?a+e-1:void 0,i=this.options.httpHeaders||{};(a||t)&&(i.range=`bytes=${[a,t].join("-")}`);let n=await Wt(this.input,{headers:i}),r=await n.arrayBuffer(),o=r.byteLength;if(n.status!==416)return o!==e&&(this.size=a+o),this.set(r,a,!0)}});de.prototype.getUint64=function(a){let e=this.getUint32(a),t=this.getUint32(a+4);return e<1048575?e<<32|t:typeof ht!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),ht(e)<<ht(32)|ht(t)):void te("Trying to read 64b value but JS can only handle 53b numbers.")};class Ga extends kt{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),i.length===0)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(i=>i.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return t===1&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Fi extends Ga{static canHandle(e,t){if(t!==0)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,r=[];for(;n<i;)r.push(e.getString(n,4)),n+=4;return r.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let i=this.findBox(t,"ipco");if(i===void 0)return;let n=this.findBox(i,"colr");n!==void 0&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let i=this.findBox(e,"iloc");if(i===void 0)return;let n=this.findExifLocIdInIinf(t),r=this.findExtentInIloc(i,n);if(r===void 0)return;let[o,s]=r;await this.file.ensureChunk(o,s);let m=4+this.file.getUint32(o);o+=m,s-=m,await this.registerSegment("tiff",o,s)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,r,o=e.start,s=this.file.getUint16(o);for(o+=2;s--;){if(t=this.parseBoxHead(o),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=t.version===3?4:2,r=this.file.getString(i+n+2,4),r==="Exif"))return this.file.getUintBytes(i,n);o+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,r]=this.get8bits(i++),[o,s]=this.get8bits(i++),m=e.version===2?4:2,g=e.version===1||e.version===2?2:0,v=s+n+r,C=e.version===2?4:2,F=this.file.getUintBytes(i,C);for(i+=C;F--;){let b=this.file.getUintBytes(i,m);i+=m+g+2+o;let x=this.file.getUint16(i);if(i+=2,b===t)return x>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(i+s,n),this.file.getUintBytes(i+s+n,r)];i+=x*v}}}class Di extends Fi{}R(Di,"type","heic");class si extends Fi{}R(si,"type","avif"),Se.set("heic",Di),Se.set("avif",si),Z(ae,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),Z(ae,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),Z(ae,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),Z(ge,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let nt=Z(ge,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const li={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};nt.set(37392,li),nt.set(41488,li);const Rt={0:"Normal",1:"Low",2:"High"};function ci(a){return typeof a=="object"&&a.length!==void 0?a[0]:a}function di(a){let e=Array.from(a).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function Mt(a){if(typeof a=="string"){var[e,t,i,n,r,o]=a.trim().split(/[-: ]/g).map(Number),s=new Date(e,t-1,i);return Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(o)||(s.setHours(n),s.setMinutes(r),s.setSeconds(o)),Number.isNaN(+s)?a:s}}function tt(a){if(typeof a=="string")return a;let e=[];if(a[1]===0&&a[a.length-1]===0)for(let t=0;t<a.length;t+=2)e.push(ui(a[t+1],a[t]));else for(let t=0;t<a.length;t+=2)e.push(ui(a[t],a[t+1]));return De(String.fromCodePoint(...e))}function ui(a,e){return a<<8|e}nt.set(41992,Rt),nt.set(41993,Rt),nt.set(41994,Rt),Z(Te,["ifd0","ifd1"],[[50827,function(a){return typeof a!="string"?_i(a):a}],[306,Mt],[40091,tt],[40092,tt],[40093,tt],[40094,tt],[40095,tt]]),Z(Te,"exif",[[40960,di],[36864,di],[36867,Mt],[36868,Mt],[40962,ci],[40963,ci]]),Z(Te,"gps",[[0,a=>Array.from(a).join(".")],[7,a=>Array.from(a).join(":")]]);class Ot extends pe{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=i.headerLength===79,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:de.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(r){let o={},s={};for(let m of Oi)o[m]=[],s[m]=0;return r.replace(Va,(m,g,v)=>{if(g==="<"){let C=++s[v];return o[v].push(C),`${m}#${C}`}return`${m}#${o[v].pop()}`})}(e);let t=ze.findAll(e,"rdf","Description");t.length===0&&t.push(new ze("rdf","Description",void 0,e));let i,n={};for(let r of t)for(let o of r.properties)i=Ba(o.ns,n),Li(o,i);return function(r){let o;for(let s in r)o=r[s]=vt(r[s]),o===void 0&&delete r[s];return vt(r)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}R(Ot,"type","xmp"),R(Ot,"multiSegment",!0),ee.set("xmp",Ot);class Ct{static findAll(e){return Ri(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Ct.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=Mi(n),new Ct(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class ze{static findAll(e,t,i){if(t!==void 0||i!==void 0){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return Ri(e,n).map(ze.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],r=e[8];return new ze(t,i,n,r)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=Ct.findAll(i),this.children=ze.findAll(n),this.value=this.children.length===0?Mi(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return Ua(this.children.map(Na));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)Li(t,e);return this.value!==void 0&&(e.value=this.value),vt(e)}}function Li(a,e){let t=a.serialize();t!==void 0&&(e[a.name]=t)}var Na=a=>a.serialize(),Ua=a=>a.length===1?a[0]:a,Ba=(a,e)=>e[a]?e[a]:e[a]={};function Ri(a,e){let t,i=[];if(!a)return i;for(;(t=e.exec(a))!==null;)i.push(t);return i}function Mi(a){if(function(i){return i==null||i==="null"||i==="undefined"||i===""||i.trim()===""}(a))return;let e=Number(a);if(!Number.isNaN(e))return e;let t=a.toLowerCase();return t==="true"||t!=="false"&&a.trim()}const Oi=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],Va=new RegExp(`(<|\\/)(${Oi.join("|")})`,"g");var za=Object.freeze({__proto__:null,default:Oa,Exifr:Ae,fileParsers:Se,segmentParsers:ee,fileReaders:ve,tagKeys:ae,tagValues:ge,tagRevivers:Te,createDictionary:Z,extendDictionary:Ue,fetchUrlAsArrayBuffer:Ge,readBlobAsArrayBuffer:Ne,chunkedProps:we,otherSegments:He,segments:Be,tiffBlocks:q,segmentsAndBlocks:_e,tiffExtractables:ke,inheritables:We,allFormatters:Ie,Options:Ve,parse:_t,gpsOnlyOptions:Yt,gps:Ii,thumbnailOnlyOptions:Jt,thumbnail:Ti,thumbnailUrl:Ai,orientationOnlyOptions:qt,orientation:Qt,rotations:Zt,get rotateCanvas(){return Le},get rotateCss(){return Re},rotation:Ei});let fi=St("fs",a=>a.promises);ve.set("fs",class extends It{async readWhole(){this.chunked=!1,this.fs=await fi;let a=await this.fs.readFile(this.input);this._swapBuffer(a)}async readChunked(){this.chunked=!0,this.fs=await fi,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(a,e){this.fh===void 0&&await this.open(),a+e>this.size&&(e=this.size-a);var t=this.subarray(a,e,!0);return await this.fh.read(t.dataView,0,e,a),t}async close(){if(this.fh){let a=this.fh;this.fh=void 0,await a.close()}}});ve.set("base64",class extends It{constructor(...a){super(...a),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(a,e){let t,i,n=this.input;a===void 0?(a=0,t=0,i=0):(t=4*Math.floor(a/3),i=a-t/4*3),e===void 0&&(e=this.size);let r=a+e,o=t+4*Math.ceil(r/3);n=n.slice(t,o);let s=Math.min(e,this.size-a);if(wt){let m=xt.from(n,"base64").slice(i,i+s);return this.set(m,a,!0)}{let m=this.subarray(a,s,!0),g=atob(n),v=m.toUint8();for(let C=0;C<s;C++)v[C]=g.charCodeAt(i+C);return m}}});class hi extends kt{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:r}=e;i.enabled&&t.deps.add(700),n.enabled&&t.deps.add(33723),r.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let r=Math.max(Bt(this.options),this.options.chunkSize);await this.file.ensureChunk(0,r),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}R(hi,"type","tiff"),Se.set("tiff",hi);let ja=St("zlib");const Ha=["ihdr","iccp","text","itxt","exif"];class mi extends kt{constructor(...e){super(...e),R(this,"catchError",t=>this.errors.push(t)),R(this,"metaChunks",[]),R(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let n=i.getUint32(e),r=i.getUint32(e+4),o=i.getString(e+4,4).toLowerCase(),s=n+4+4+4,m={type:o,offset:e,length:s,start:e+4+4,size:n,marker:r};Ha.includes(o)?this.metaChunks.push(m):this.unknownChunks.push(m),e+=s}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[i,n]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(i,n)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(s=>s.type==="iccp");if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),n=0;for(;n<80&&i[n]!==0;)n++;let r=n+2,o=t.getString(0,n);if(this.injectKeyValToIhdr("ProfileName",o),yt){let s=await ja,m=t.getUint8Array(r);m=s.inflateSync(m),this.injectSegment("icc",m)}}}R(mi,"type","png"),Se.set("png",mi),Z(ae,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),Ue(ae,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let pi=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];Ue(ae,"ifd0",pi),Ue(ae,"exif",pi),Z(ge,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Gt extends pe{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}R(Gt,"type","jfif"),R(Gt,"headerLength",9),ee.set("jfif",Gt),Z(ae,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class gi extends pe{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}R(gi,"type","ihdr"),ee.set("ihdr",gi),Z(ae,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),Z(ge,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class gt extends pe{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(t){let i=function(n){let r=n[0].constructor,o=0;for(let g of n)o+=g.length;let s=new r(o),m=0;for(let g of n)s.set(g,m),m+=g.length;return s}(t.map(n=>n.chunk.toUint8()));return new de(i)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&te("ICC header is too short");for(let[t,i]of Object.entries(Wa)){t=parseInt(t,10);let n=i(this.chunk,t);n!=="\0\0\0\0"&&e.set(t,n)}}parseTags(){let e,t,i,n,r,{raw:o}=this,s=this.chunk.getUint32(128),m=132,g=this.chunk.byteLength;for(;s--;){if(e=this.chunk.getString(m,4),t=this.chunk.getUint32(m+4),i=this.chunk.getUint32(m+8),n=this.chunk.getString(t,4),t+i>g)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");r=this.parseTag(n,t,i),r!==void 0&&r!=="\0\0\0\0"&&o.set(e,r),m+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return De(this.chunk.getString(e+12,t))}parseText(e,t){return De(this.chunk.getString(e+8,t-8))}parseSig(e){return De(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),r=e+16,o=[];for(let s=0;s<i;s++){let m=t.getString(r+0,2),g=t.getString(r+2,2),v=t.getUint32(r+4),C=t.getUint32(r+8)+e,F=De(t.getUnicodeString(C,v));o.push({lang:m,country:g,text:F}),r+=n}return i===1?o[0].text:o}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}R(gt,"type","icc"),R(gt,"multiSegment",!0),R(gt,"headerLength",18);const Wa={4:xe,8:function(a,e){return[a.getUint8(e),a.getUint8(e+1)>>4,a.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:xe,16:xe,20:xe,24:function(a,e){const t=a.getUint16(e),i=a.getUint16(e+2)-1,n=a.getUint16(e+4),r=a.getUint16(e+6),o=a.getUint16(e+8),s=a.getUint16(e+10);return new Date(Date.UTC(t,i,n,r,o,s))},36:xe,40:xe,48:xe,52:xe,64:(a,e)=>a.getUint32(e),80:xe};function xe(a,e){return De(a.getString(e,4))}ee.set("icc",gt),Z(ae,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const mt={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},yi={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};Z(ge,"icc",[[4,mt],[12,yi],[40,Object.assign({},mt,yi)],[48,mt],[80,mt],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class pt extends pe{static canHandle(e,t,i){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,i)!==void 0}static headerLength(e,t,i){let n,r=this.containsIptc8bim(e,t,i);if(r!==void 0)return n=e.getUint8(t+r+7),n%2!=0&&(n+=1),n===0&&(n=4),r+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(this.chunk.getUint8(n)===28&&this.chunk.getUint8(n+1)===2){i=!0;let r=this.chunk.getUint16(n+3),o=this.chunk.getUint8(n+2),s=this.chunk.getLatin1String(n+5,r);e.set(o,this.pluralizeValue(e.get(o),s)),n+=4+r}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}R(pt,"type","iptc"),R(pt,"translateValues",!1),R(pt,"reviveValues",!1),ee.set("iptc",pt),Z(ae,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),Z(ge,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);const Gi={Title:{label:"Title",section:"Description",icon:Y.TITLE,description:"Short title or caption for the image",editable:!0},Author:{label:"Author",section:"Author",icon:Y.ACCOUNT,description:"Name of image creator",editable:!0},Description:{label:"Description",section:"Description",icon:Y.FILE_TEXT,description:"Longer description of image",editable:!0},Copyright:{label:"Copyright",section:"Author",icon:Y.COPYRIGHT,description:"Copyright notice",editable:!0},"Creation Time":{label:"Creation Time",section:"Timestamps",icon:Y.CLOCK,description:"Time of original image creation",editable:!0,editWarning:'Should be in RFC 1123 format (e.g., "21 Jan 2025 15:30:00 +0000")'},Software:{label:"Software",section:"Technical",icon:Y.FILE_CODE,description:"Software used to create the image",editable:!0},Disclaimer:{label:"Disclaimer",section:"Author",icon:Y.ALERT_CIRCLE,description:"Legal disclaimer",editable:!0},Warning:{label:"Warning",section:"Technical",icon:Y.ALERT,description:"Warning of nature of content",editable:!0},Source:{label:"Source",section:"Technical",icon:Y.SOURCE,description:"Device used to create the image",editable:!0},Comment:{label:"Comment",section:"Description",icon:Y.COMMENT,description:"Miscellaneous comment",editable:!0},"XML:com.adobe.xmp":{label:"XMP Metadata",section:"Hidden",icon:Y.FILE_TYPE,description:"Adobe XMP metadata (XML format)",editable:!1,editWarning:"XMP metadata is complex XML data and should not be manually edited"}},Si={Description:{name:"Description",icon:Y.FILE_TEXT,color:"primary",description:"Image title, description, and comments"},Author:{name:"Author & Copyright",icon:Y.ACCOUNT,color:"secondary",description:"Author, copyright, and disclaimer information"},Timestamps:{name:"Timestamps",icon:Y.CLOCK,color:"info",description:"Creation time and modification dates"},Technical:{name:"Technical",icon:Y.SETTINGS,color:"grey",description:"Software, source device, and technical details"},Hidden:{name:"Hidden/Advanced",icon:Y.EYE_OFF,color:"warning",description:"XMP metadata and advanced fields"},Custom:{name:"Custom Fields",icon:Y.PLUS_CIRCLE,color:"success",description:"User-defined custom metadata fields"}};function Xa(a){return Gi[a]||{label:a,section:"Custom",icon:Y.TAG,description:"Custom PNG text chunk",editable:!0}}function Ka(a){return!a||a.length===0?{valid:!1,error:"Keyword cannot be empty"}:a.length>79?{valid:!1,error:"Keyword must be 79 characters or less"}:/^[\x20-\xFF]+$/.test(a)?a!==a.trim()?{valid:!1,error:"Keyword should not have leading or trailing spaces"}:{valid:!0}:{valid:!1,error:"Keyword must contain only Latin-1 printable characters"}}function dt(a){const e=a.replace(/^data:image\/[a-z]+;base64,/,""),t=atob(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i.buffer}function Tt(a){const e=new Uint8Array(a);let t="";for(let i=0;i<e.byteLength;i++)t+=String.fromCharCode(e[i]);return btoa(t)}const Ni=new Uint8Array([137,80,78,71,13,10,26,10]);function Ya(a){const e=new Uint32Array(256);for(let i=0;i<256;i++){let n=i;for(let r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[i]=n}let t=4294967295;for(let i=0;i<a.length;i++)t=e[(t^a[i])&255]^t>>>8;return(t^4294967295)>>>0}function ot(a){const e=new DataView(a),t=[];let i=0;for(let n=0;n<8;n++)if(e.getUint8(i+n)!==Ni[n])throw new Error("Invalid PNG signature");for(i=8;i<a.byteLength;){const n=e.getUint32(i);i+=4;const r=String.fromCharCode(e.getUint8(i),e.getUint8(i+1),e.getUint8(i+2),e.getUint8(i+3));i+=4;const o=new Uint8Array(a,i,n);i+=n;const s=e.getUint32(i);if(i+=4,t.push({type:r,data:new Uint8Array(o),crc:s}),r==="IEND")break}return t}function At(a){let e=8;for(const r of a)e+=8+r.data.length+4;const t=new ArrayBuffer(e),i=new DataView(t);let n=0;for(let r=0;r<8;r++)i.setUint8(n++,Ni[r]);for(const r of a){i.setUint32(n,r.data.length),n+=4;const o=new Uint8Array(4);for(let g=0;g<4;g++)o[g]=r.type.charCodeAt(g),i.setUint8(n++,o[g]);for(let g=0;g<r.data.length;g++)i.setUint8(n++,r.data[g]);const s=new Uint8Array(4+r.data.length);s.set(o,0),s.set(r.data,4);const m=Ya(s);i.setUint32(n,m),n+=4}return t}function Ui(a,e){const t=new TextEncoder().encode(a),i=new TextEncoder().encode(e),n=new Uint8Array(t.length+1+i.length);return n.set(t,0),n[t.length]=0,n.set(i,t.length+1),{type:"tEXt",data:n}}function Bi(a){if(!a.data||a.data.length===0)return null;let e=-1;for(let i=0;i<a.data.length;i++)if(a.data[i]===0){e=i;break}if(e<0)return null;const t=a.data.slice(0,e);return new TextDecoder().decode(t)}async function Ja(a){try{const e=dt(a),t=await za.parse(e,{tiff:!1,exif:!1,gps:!1,iptc:!1,icc:!1,jfif:!1,ihdr:!0,png:!0});return vi(t||{})}catch(e){throw console.error("PNG metadata loading error:",e),new Error(`Failed to load PNG metadata: ${e.message}`)}}function vi(a){const e={};Object.keys(Si).forEach(t=>{e[t]={...Si[t],fields:[]}});for(const[t,i]of Object.entries(a)){if(["width","height","bitDepth","colorType","compressionMethod","filterMethod","interlaceMethod","ImageWidth","ImageHeight","BitDepth","ColorType","Compression","Filter","Interlace"].includes(t))continue;const r=Xa(t),o=r.section||"Custom",s=i!=null&&i!=="";e[o].fields.push({label:r.label,key:t,value:i||"",editable:r.editable,icon:r.icon,description:r.description,editWarning:r.editWarning||null,isPopulated:s,rawValue:i})}return Object.entries(Gi).forEach(([t,i])=>{var o;const n=i.section;((o=e[n])==null?void 0:o.fields.find(s=>s.key===t))||e[n].fields.push({label:i.label,key:t,value:"",editable:i.editable,icon:i.icon,description:i.description,editWarning:i.editWarning||null,isPopulated:!1,rawValue:null})}),Object.keys(e).forEach(t=>{e[t].fields.length===0&&delete e[t]}),e}function qa(a){if(!a)return{totalFields:0,populatedFields:0,sections:0};const e=Object.keys(a).length;let t=0,i=0;return Object.values(a).forEach(n=>{t+=n.fields.length,i+=n.fields.filter(r=>r.isPopulated).length}),{totalFields:t,populatedFields:i,sections:e}}async function Qa(a,e,t){try{const i=dt(a),n=ot(i);let r=-1;for(let m=0;m<n.length;m++){const g=n[m];if((g.type==="tEXt"||g.type==="iTXt"||g.type==="zTXt")&&Bi(g)===e.key){r=m;break}}const o=Ui(e.key,t);if(r>=0)n[r]=o;else{const m=n.findIndex(g=>g.type==="IEND");m>=0?n.splice(m,0,o):n.push(o)}const s=At(n);try{ot(s)}catch(m){throw console.error("[editPngMetadataField] Verification failed! Written PNG is invalid:",m),new Error(`Written PNG is invalid: ${m.message}`)}return Tt(s)}catch(i){throw console.error("PNG metadata edit error:",i),new Error(`Failed to edit PNG metadata: ${i.message}`)}}async function Za(a,e){try{const t=dt(a),n=ot(t).filter(o=>o.type==="tEXt"||o.type==="iTXt"||o.type==="zTXt"?Bi(o)!==e.key:!0),r=At(n);return Tt(r)}catch(t){throw console.error("PNG metadata removal error:",t),new Error(`Failed to remove PNG metadata: ${t.message}`)}}async function $a(a){try{const e=dt(a),i=ot(e).filter(r=>!["tEXt","iTXt","zTXt","tIME"].includes(r.type)),n=At(i);return Tt(n)}catch(e){throw console.error("PNG metadata removal error:",e),new Error(`Failed to remove all PNG metadata: ${e.message}`)}}async function en(a,e,t){try{const i=dt(a),n=ot(i),r=Ui(e,t),o=n.findIndex(m=>m.type==="IEND");o>=0?n.splice(o,0,r):n.push(r);const s=At(n);return Tt(s)}catch(i){throw console.error("PNG custom field addition error:",i),new Error(`Failed to add custom PNG field: ${i.message}`)}}const H={JPEG:"JPEG",PNG:"PNG",UNKNOWN:"UNKNOWN"};async function tn(a){let e=null;if(a instanceof File){const i=await a.slice(0,8).arrayBuffer(),n=new Uint8Array(i);e=String.fromCharCode(...n)}else if(typeof a=="string")try{const t=a.replace(/^data:image\/[a-z]+;base64,/,"");e=atob(t.substring(0,20))}catch(t){return console.error("Error decoding base64 for format detection:",t),H.UNKNOWN}return e?e.charCodeAt(0)===137&&e.charCodeAt(1)===80&&e.charCodeAt(2)===78&&e.charCodeAt(3)===71?H.PNG:e.charCodeAt(0)===255&&e.charCodeAt(1)===216&&e.charCodeAt(2)===255?H.JPEG:H.UNKNOWN:H.UNKNOWN}async function it(a,e){switch(e){case H.JPEG:return await ca(a);case H.PNG:return await Ja(a);default:throw new Error(`Unsupported image format: ${e}`)}}async function an(a,e,t,i){switch(e){case H.JPEG:return await ga(a,t,i);case H.PNG:return await Qa(a,t,i);default:throw new Error(`Unsupported image format: ${e}`)}}async function nn(a,e,t){switch(e){case H.JPEG:return await ya(a,t);case H.PNG:return await Za(a,t);default:throw new Error(`Unsupported image format: ${e}`)}}async function rn(a,e){switch(e){case H.JPEG:return await ua(a);case H.PNG:return await $a(a);default:throw new Error(`Unsupported image format: ${e}`)}}async function on(a,e,t){switch(e){case H.JPEG:return await ba(a,t.ifd,t.tagId,t.value,t.type);case H.PNG:return await en(a,t.keyword,t.value);default:throw new Error(`Unsupported image format: ${e}`)}}function sn(a,e){switch(e){case H.JPEG:return ma(a);case H.PNG:return qa(a);default:return{totalFields:0,populatedFields:0,sections:0}}}function Nt(a){switch(a){case H.JPEG:return"jpg";case H.PNG:return"png";default:return"bin"}}function at(a){switch(a){case H.JPEG:return"image/jpeg";case H.PNG:return"image/png";default:return"application/octet-stream"}}const ln={name:"AddCustomFieldDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","add-field","cancel"],setup(a,{emit:e}){const t=j("0th"),i=j(null),n=j(""),r=j("string"),o=j(""),s=j(null),m=[{title:"0th - Main Image Data",value:"0th"},{title:"Exif - EXIF Data",value:"Exif"},{title:"GPS - GPS Data",value:"GPS"},{title:"1st - Thumbnail Data",value:"1st"}],g=[{title:"Text (String)",value:"string"},{title:"Number (Integer)",value:"number"},{title:"Rational (Fraction)",value:"rational"},{title:"DateTime",value:"datetime"},{title:"Array",value:"array"}],v=[{ifd:"0th",tagId:270,label:"Image Description",icon:"mdi-text",description:"General description of the image"},{ifd:"Exif",tagId:37510,label:"User Comment",icon:"mdi-message-text",description:"User-defined comment (ideal for hidden data)"},{ifd:"0th",tagId:315,label:"Artist/Author",icon:"mdi-account",description:"Creator of the image"},{ifd:"0th",tagId:33432,label:"Copyright",icon:"mdi-copyright",description:"Copyright information"},{ifd:"0th",tagId:305,label:"Software",icon:"mdi-application",description:"Software used to create/edit the image"}],C=oe({get:()=>a.modelValue,set:B=>e("update:modelValue",B)}),F=oe(()=>t.value&&i.value&&i.value>0&&n.value&&o.value&&!s.value),b=()=>({string:"Enter any text value",number:"Enter a whole number (e.g., 100, 400)",rational:"Enter a fraction (e.g., 1/125) or decimal (e.g., 2.8)",datetime:"Format: YYYY:MM:DD HH:MM:SS",array:"Enter comma-separated values (e.g., 1, 2, 3)"})[r.value]||"Enter field value",x=()=>({string:"Enter text...",number:"100",rational:"1/125",datetime:"2025:11:15 14:30:00",array:"1, 2, 3"})[r.value]||"",G=B=>{t.value=B.ifd,i.value=B.tagId,n.value=B.label},J=()=>{if(!o.value)return"Field value is required";const B=xi(o.value,r.value);return B.valid?null:B.warning};return{dialog:C,selectedIfd:t,tagId:i,fieldLabel:n,valueType:r,fieldValue:o,validationError:s,ifdOptions:m,typeOptions:g,suggestions:v,canAdd:F,getValueHint:b,getValuePlaceholder:x,applySuggestion:G,addField:()=>{const B=J();if(B){s.value=B;return}e("add-field",{ifd:t.value,tagId:parseInt(i.value),label:n.value,type:r.value,value:o.value}),t.value="0th",i.value=null,n.value="",r.value="string",o.value="",s.value=null,C.value=!1},cancel:()=>{e("cancel"),t.value="0th",i.value=null,n.value="",r.value="string",o.value="",s.value=null,C.value=!1}}}},cn=a=>(lt("data-v-225e11dd"),a=a(),ct(),a),dn=cn(()=>T("strong",null,"Note:",-1));function un(a,e,t,i,n,r){const o=S("v-icon"),s=S("v-card-title"),m=S("v-alert"),g=S("v-select"),v=S("v-col"),C=S("v-text-field"),F=S("v-row"),b=S("v-expansion-panel-title"),x=S("v-list-item-title"),G=S("v-list-item-subtitle"),J=S("v-list-item"),X=S("v-list"),ne=S("v-expansion-panel-text"),B=S("v-expansion-panel"),$=S("v-expansion-panels"),l=S("v-textarea"),c=S("v-card-text"),f=S("v-btn"),y=S("v-spacer"),p=S("v-card-actions"),h=S("v-card"),_=S("v-dialog");return A(),L(_,{modelValue:i.dialog,"onUpdate:modelValue":e[5]||(e[5]=I=>i.dialog=I),"max-width":"700",persistent:""},{default:u(()=>[d(h,null,{default:u(()=>[d(s,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(o,{icon:"mdi-plus-circle",class:"mr-2"}),P(" Add Custom EXIF Field ")]),_:1}),d(c,{class:"pa-4"},{default:u(()=>[d(m,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:u(()=>[dn,P(" Adding custom fields to EXIF data can help with organization or steganography (hiding data). Choose from commonly used fields or select a custom tag ID. ")]),_:1}),d(F,null,{default:u(()=>[d(v,{cols:"12",md:"6"},{default:u(()=>[d(g,{modelValue:i.selectedIfd,"onUpdate:modelValue":e[0]||(e[0]=I=>i.selectedIfd=I),items:i.ifdOptions,label:"IFD (Image File Directory)",variant:"outlined",density:"comfortable",hint:"Choose where to store the field","persistent-hint":""},{"prepend-inner":u(()=>[d(o,{icon:"mdi-folder",size:"small"})]),_:1},8,["modelValue","items"])]),_:1}),d(v,{cols:"12",md:"6"},{default:u(()=>[d(C,{modelValue:i.tagId,"onUpdate:modelValue":e[1]||(e[1]=I=>i.tagId=I),label:"Tag ID",variant:"outlined",density:"comfortable",type:"number",hint:"Numeric tag identifier","persistent-hint":"",rules:[I=>!!I||"Tag ID is required",I=>I>0||"Must be positive"]},{"prepend-inner":u(()=>[d(o,{icon:"mdi-tag",size:"small"})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1}),d($,{class:"mt-4 mb-4"},{default:u(()=>[d(B,null,{default:u(()=>[d(b,null,{default:u(()=>[d(o,{icon:"mdi-lightbulb",class:"mr-2",size:"small"}),P(" Suggested Custom Fields ")]),_:1}),d(ne,null,{default:u(()=>[d(X,{density:"compact"},{default:u(()=>[(A(!0),ce(Me,null,Oe(i.suggestions,I=>(A(),L(J,{key:I.key,onClick:M=>i.applySuggestion(I),class:"suggestion-item"},{prepend:u(()=>[d(o,{icon:I.icon,size:"small"},null,8,["icon"])]),default:u(()=>[d(x,null,{default:u(()=>[P(N(I.label),1)]),_:2},1024),d(G,{class:"text-caption"},{default:u(()=>[P(N(I.ifd)+"."+N(I.tagId)+" - "+N(I.description),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),d(C,{modelValue:i.fieldLabel,"onUpdate:modelValue":e[2]||(e[2]=I=>i.fieldLabel=I),label:"Field Label",variant:"outlined",density:"comfortable",hint:"Human-readable name for this field","persistent-hint":"",class:"mb-3"},{"prepend-inner":u(()=>[d(o,{icon:"mdi-text",size:"small"})]),_:1},8,["modelValue"]),d(g,{modelValue:i.valueType,"onUpdate:modelValue":e[3]||(e[3]=I=>i.valueType=I),items:i.typeOptions,label:"Value Type",variant:"outlined",density:"comfortable",hint:"Data type for this field","persistent-hint":"",class:"mb-3"},{"prepend-inner":u(()=>[d(o,{icon:"mdi-format-list-bulleted-type",size:"small"})]),_:1},8,["modelValue","items"]),d(l,{modelValue:i.fieldValue,"onUpdate:modelValue":e[4]||(e[4]=I=>i.fieldValue=I),label:"Field Value",variant:"outlined",density:"comfortable",rows:"3",hint:i.getValueHint(),"persistent-hint":"",placeholder:i.getValuePlaceholder()},{"prepend-inner":u(()=>[d(o,{icon:"mdi-pencil",size:"small"})]),_:1},8,["modelValue","hint","placeholder"]),i.validationError?(A(),L(m,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:u(()=>[P(N(i.validationError),1)]),_:1})):V("",!0)]),_:1}),d(p,{class:"bg-surface-variant"},{default:u(()=>[d(f,{variant:"text",onClick:i.cancel},{default:u(()=>[P(" Cancel ")]),_:1},8,["onClick"]),d(y),d(f,{color:"primary",variant:"elevated","prepend-icon":"mdi-plus",onClick:i.addField,disabled:!i.canAdd},{default:u(()=>[P(" Add Field ")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const fn=st(ln,[["render",un],["__scopeId","data-v-225e11dd"]]),hn={name:"AddPngFieldDialog",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","add-field","cancel"],setup(a,{emit:e}){const t=j(""),i=j(""),n=j(""),r=[{keyword:"Title",icon:"mdi-text-box",description:"Short title or caption for the image"},{keyword:"Author",icon:"mdi-account",description:"Name of image creator"},{keyword:"Description",icon:"mdi-text",description:"Longer description of image"},{keyword:"Copyright",icon:"mdi-copyright",description:"Copyright notice"},{keyword:"Creation Time",icon:"mdi-clock-outline",description:"Time of original image creation"},{keyword:"Software",icon:"mdi-application",description:"Software used to create the image"},{keyword:"Comment",icon:"mdi-comment-text",description:"Miscellaneous comment"},{keyword:"Source",icon:"mdi-source-branch",description:"Device used to create the image"}],o=oe({get:()=>a.modelValue,set:x=>e("update:modelValue",x)}),s=oe(()=>[x=>!!x||"Keyword is required",x=>x&&x.length<=79||"Keyword must be 79 characters or less",x=>x&&x.trim()===x||"Keyword should not have leading/trailing spaces"]),m=oe(()=>t.value&&i.value&&t.value.length<=79&&t.value.trim()===t.value&&!n.value),g=()=>{if(!t.value){n.value="";return}const x=Ka(t.value);n.value=x.valid?"":x.error},v=x=>{t.value=x,g()},C=()=>{m.value&&(e("add-field",{keyword:t.value,value:i.value}),b(),o.value=!1)},F=()=>{b(),e("cancel"),o.value=!1},b=()=>{t.value="",i.value="",n.value=""};return je(()=>a.modelValue,x=>{x||b()}),{dialog:o,keyword:t,value:i,keywordError:n,keywordRules:s,standardKeywords:r,isValid:m,validateKeyword:g,applyKeyword:v,addField:C,closeDialog:F}}},mn=a=>(lt("data-v-626d211f"),a=a(),ct(),a),pn=mn(()=>T("strong",null,"PNG Text Chunks:",-1)),gn={class:"text-caption text-medium-emphasis mt-2"};function yn(a,e,t,i,n,r){const o=S("v-icon"),s=S("v-card-title"),m=S("v-alert"),g=S("v-text-field"),v=S("v-expansion-panel-title"),C=S("v-list-item-title"),F=S("v-list-item-subtitle"),b=S("v-list-item"),x=S("v-list"),G=S("v-expansion-panel-text"),J=S("v-expansion-panel"),X=S("v-expansion-panels"),ne=S("v-textarea"),B=S("v-card-text"),$=S("v-spacer"),l=S("v-btn"),c=S("v-card-actions"),f=S("v-card"),y=S("v-dialog");return A(),L(y,{modelValue:i.dialog,"onUpdate:modelValue":e[2]||(e[2]=p=>i.dialog=p),"max-width":"600",persistent:""},{default:u(()=>[d(f,null,{default:u(()=>[d(s,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(o,{icon:"mdi-plus-circle",class:"mr-2"}),P(" Add PNG Text Field ")]),_:1}),d(B,{class:"pa-4"},{default:u(()=>[d(m,{type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:u(()=>[pn,P(" PNG images store metadata as keyword-value pairs in tEXt chunks. Use standard keywords or create custom ones for your needs. ")]),_:1}),d(g,{modelValue:i.keyword,"onUpdate:modelValue":[e[0]||(e[0]=p=>i.keyword=p),i.validateKeyword],label:"Keyword",variant:"outlined",density:"comfortable",hint:"1-79 Latin-1 characters (e.g., 'Title', 'Author', 'MyCustomField')","persistent-hint":"",rules:i.keywordRules,"error-messages":i.keywordError,class:"mb-3"},{"prepend-inner":u(()=>[d(o,{icon:"mdi-tag",size:"small"})]),_:1},8,["modelValue","rules","error-messages","onUpdate:modelValue"]),d(X,{class:"mb-4"},{default:u(()=>[d(J,null,{default:u(()=>[d(v,null,{default:u(()=>[d(o,{icon:"mdi-lightbulb",class:"mr-2",size:"small"}),P(" Standard PNG Keywords ")]),_:1}),d(G,null,{default:u(()=>[d(x,{density:"compact"},{default:u(()=>[(A(!0),ce(Me,null,Oe(i.standardKeywords,p=>(A(),L(b,{key:p.keyword,onClick:h=>i.applyKeyword(p.keyword),class:"suggestion-item"},{prepend:u(()=>[d(o,{icon:p.icon,size:"small"},null,8,["icon"])]),default:u(()=>[d(C,null,{default:u(()=>[P(N(p.keyword),1)]),_:2},1024),d(F,{class:"text-caption"},{default:u(()=>[P(N(p.description),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),d(ne,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=p=>i.value=p),label:"Value",variant:"outlined",density:"comfortable",rows:"4",hint:"Text value for this field (UTF-8 supported)","persistent-hint":"",rules:[p=>!!p||"Value is required"]},{"prepend-inner":u(()=>[d(o,{icon:"mdi-text",size:"small"})]),_:1},8,["modelValue","rules"]),T("div",gn," Keyword: "+N(i.keyword.length)+"/79 characters | Value: "+N(i.value.length)+" characters ",1)]),_:1}),d(c,{class:"pa-4 pt-0"},{default:u(()=>[d($),d(l,{variant:"text",onClick:i.closeDialog},{default:u(()=>[P(" Cancel ")]),_:1},8,["onClick"]),d(l,{color:"primary",variant:"elevated",disabled:!i.isValid,onClick:i.addField},{default:u(()=>[d(o,{start:"",icon:"mdi-plus"}),P(" Add Field ")]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Sn=st(hn,[["render",yn],["__scopeId","data-v-626d211f"]]),vn={name:"MetadataFieldEditor",props:{modelValue:{type:Boolean,default:!1},field:{type:Object,default:null}},emits:["update:modelValue","save","remove","cancel"],setup(a,{emit:e}){const t=j(""),i=j(null),n=oe({get:()=>a.modelValue,set:C=>e("update:modelValue",C)}),r=oe(()=>{var C;return t.value!==null&&t.value!==void 0&&t.value!==""&&t.value!==((C=a.field)==null?void 0:C.value)&&!i.value}),o=C=>{if(!C)return"";const F={DateTime:"Format: YYYY:MM:DD HH:MM:SS",DateTimeOriginal:"Format: YYYY:MM:DD HH:MM:SS",DateTimeDigitized:"Format: YYYY:MM:DD HH:MM:SS",Copyright:"Copyright notice or author name",Artist:"Photographer or creator name",Make:"Camera manufacturer (e.g., Canon, Nikon)",Model:"Camera model (e.g., EOS 5D)",ImageDescription:"Brief description of the image",UserComment:"User-defined comment or notes"};for(const[b,x]of Object.entries(F))if(C.label.includes(b))return x;return"Enter new value for this field"},s=C=>{var F;if(!C)return"Value cannot be empty";if(C.length>500)return"Value too long (max 500 characters)";if((F=a.field)!=null&&F.type){const b=xi(C,a.field.type);if(!b.valid)return b.warning}return null},m=()=>{const C=s(t.value);if(C){i.value=C;return}e("save",{field:a.field,newValue:t.value}),t.value="",i.value=null,n.value=!1},g=()=>{e("remove",a.field),t.value="",i.value=null,n.value=!1},v=()=>{e("cancel"),t.value="",i.value=null,n.value=!1};return je(()=>a.field,C=>{C&&(t.value=C.value||"",i.value=null)},{immediate:!0}),je(t,()=>{i.value=null}),{dialog:n,editedValue:t,validationError:i,canSave:r,getFieldHint:o,validateValue:s,save:m,remove:g,cancel:v}}},Vi=a=>(lt("data-v-bb6e50e9"),a=a(),ct(),a),bn={class:"mb-4"},Cn=Vi(()=>T("div",{class:"text-caption text-medium-emphasis mb-1"},"Field",-1)),Pn={class:"text-body-1 font-weight-medium d-flex align-center"},xn={class:"mb-4"},wn=Vi(()=>T("div",{class:"text-caption text-medium-emphasis mb-1"},"Original Value",-1)),_n={class:"text-body-2 pa-2 rounded bg-surface-variant"};function kn(a,e,t,i,n,r){const o=S("v-icon"),s=S("v-card-title"),m=S("v-alert"),g=S("v-chip"),v=S("v-text-field"),C=S("v-card-text"),F=S("v-btn"),b=S("v-spacer"),x=S("v-card-actions"),G=S("v-card"),J=S("v-dialog");return A(),L(J,{modelValue:i.dialog,"onUpdate:modelValue":e[1]||(e[1]=X=>i.dialog=X),"max-width":"600",persistent:""},{default:u(()=>[d(G,null,{default:u(()=>[d(s,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(o,{icon:"mdi-pencil",class:"mr-2"}),P(" Edit Metadata Field ")]),_:1}),d(C,{class:"pa-4"},{default:u(()=>{var X,ne,B,$,l,c;return[(X=t.field)!=null&&X.editWarning?(A(),L(m,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:u(()=>[d(o,{icon:"mdi-alert-circle-outline",size:"small",class:"mr-2"}),P(" "+N(t.field.editWarning),1)]),_:1})):V("",!0),T("div",bn,[Cn,T("div",Pn,[d(o,{icon:((ne=t.field)==null?void 0:ne.icon)||"mdi-tag",size:"small",class:"mr-2",color:"grey"},null,8,["icon"]),P(" "+N((B=t.field)==null?void 0:B.label)+" ",1),($=t.field)!=null&&$.type?(A(),L(g,{key:0,size:"x-small",variant:"outlined",color:"info",class:"ml-2"},{default:u(()=>[P(N(t.field.type),1)]),_:1})):V("",!0)])]),T("div",xn,[wn,T("div",_n,N(((l=t.field)==null?void 0:l.value)||"N/A"),1)]),d(v,{modelValue:i.editedValue,"onUpdate:modelValue":e[0]||(e[0]=f=>i.editedValue=f),label:"New Value",variant:"outlined",density:"comfortable",clearable:"",autofocus:"",placeholder:(c=t.field)==null?void 0:c.value,hint:i.getFieldHint(t.field),"persistent-hint":"",onKeydown:Ji(i.save,["enter"])},{"prepend-inner":u(()=>[d(o,{icon:"mdi-pencil-outline",size:"small"})]),_:1},8,["modelValue","placeholder","hint","onKeydown"]),i.validationError?(A(),L(m,{key:1,type:"error",variant:"tonal",density:"compact",class:"mt-3"},{default:u(()=>[P(N(i.validationError),1)]),_:1})):V("",!0)]}),_:1}),d(x,{class:"bg-surface-variant"},{default:u(()=>[d(F,{variant:"text",onClick:i.cancel},{default:u(()=>[P(" Cancel ")]),_:1},8,["onClick"]),d(b),d(F,{color:"error",variant:"text","prepend-icon":"mdi-delete",onClick:i.remove},{default:u(()=>[P(" Remove Field ")]),_:1},8,["onClick"]),d(F,{color:"primary",variant:"elevated","prepend-icon":"mdi-content-save",onClick:i.save,disabled:!i.canSave},{default:u(()=>[P(" Save Changes ")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const In=st(vn,[["render",kn],["__scopeId","data-v-bb6e50e9"]]),Tn={name:"MetadataViewer",props:{sections:{type:Object,required:!0},editable:{type:Boolean,default:!1},showQuickActions:{type:Boolean,default:!1}},emits:["edit-field","remove-field"],setup(a){const e=j(null),t=oe(()=>!e.value||!a.sections?null:a.sections[e.value]);return je(()=>a.sections,i=>{if(i&&Object.keys(i).length>0){const n=Object.keys(i)[0];e.value=n}else e.value=null},{immediate:!0}),{selectedSection:e,currentSection:t}}},ut=a=>(lt("data-v-f946027e"),a=a(),ct(),a),An={key:0},En=ut(()=>T("span",{class:"text-body-1"},"Categories",-1)),Fn={class:"text-body-1"},Dn={class:"metadata-fields-table"},Ln={class:"table-col-label text-body-2 font-weight-medium"},Rn={class:"tooltip-content"},Mn={class:"table-col-value text-body-2"},On={class:"table-col-actions-sm"},Gn=ut(()=>T("p",{class:"text-h6 text-medium-emphasis mt-4"},"Select a Category",-1)),Nn=ut(()=>T("p",{class:"text-body-2 text-medium-emphasis"}," Click a category on the left to view its metadata fields. ",-1)),Un=ut(()=>T("p",{class:"text-h6 text-medium-emphasis mt-4"},"No Metadata Found",-1)),Bn=ut(()=>T("p",{class:"text-body-2 text-medium-emphasis"}," This image does not contain any EXIF metadata, or the metadata could not be read. ",-1));function Vn(a,e,t,i,n,r){const o=S("v-card-title"),s=S("v-icon"),m=S("v-list-item-title"),g=S("v-list-item-subtitle"),v=S("v-list-item"),C=S("v-list"),F=S("v-card"),b=S("v-col"),x=S("v-alert"),G=S("v-tooltip"),J=S("v-chip"),X=S("v-btn"),ne=S("v-table"),B=S("v-card-text"),$=S("v-row");return t.sections&&Object.keys(t.sections).length>0?(A(),ce("div",An,[d($,null,{default:u(()=>[d(b,{cols:"12",md:"4",lg:"3"},{default:u(()=>[d(F,{elevation:"2"},{default:u(()=>[d(o,{class:"bg-surface-variant pa-2"},{default:u(()=>[En]),_:1}),d(C,{density:"compact",class:"pa-0"},{default:u(()=>[(A(!0),ce(Me,null,Oe(t.sections,(l,c)=>(A(),L(v,{key:c,value:c,active:i.selectedSection===c,onClick:f=>i.selectedSection=c,class:"list-item-hover"},{prepend:u(()=>[d(s,{icon:l.icon,color:l.color,size:"small"},null,8,["icon","color"])]),default:u(()=>[d(m,{class:"text-body-2"},{default:u(()=>[P(N(l.name),1)]),_:2},1024),d(g,{class:"text-caption"},{default:u(()=>[P(N(l.fields.length)+" field"+N(l.fields.length!==1?"s":""),1)]),_:2},1024)]),_:2},1032,["value","active","onClick"]))),128))]),_:1})]),_:1})]),_:1}),d(b,{cols:"12",md:"8",lg:"9"},{default:u(()=>[i.currentSection?(A(),L(F,{key:0,elevation:"2"},{default:u(()=>[d(o,{class:"bg-surface-variant pa-2"},{default:u(()=>[d(s,{icon:i.currentSection.icon,color:i.currentSection.color,size:"small",class:"mr-2"},null,8,["icon","color"]),T("span",Fn,N(i.currentSection.name),1)]),_:1}),i.currentSection.description?(A(),L(x,{key:0,color:"info",variant:"tonal",density:"compact",class:"ma-3"},{default:u(()=>[P(N(i.currentSection.description),1)]),_:1})):V("",!0),T("div",Dn,[d(ne,{density:"compact"},{default:u(()=>[T("tbody",null,[(A(!0),ce(Me,null,Oe(i.currentSection.fields,l=>(A(),ce("tr",{key:l.key},[T("td",Ln,[d(s,{icon:l.icon,size:"x-small",color:"grey",class:"mr-2"},null,8,["icon"]),P(" "+N(l.label)+" ",1),l.editWarning?(A(),L(G,{key:0,location:"top"},{activator:u(({props:c})=>[d(s,bi(c,{icon:"mdi-information-outline",size:"x-small",color:"info",class:"ml-1"}),null,16)]),default:u(()=>[T("span",Rn,N(l.editWarning),1)]),_:2},1024)):V("",!0)]),T("td",Mn,[T("span",{class:Ci({"text-medium-emphasis":!l.isPopulated})},N(l.value),3),l.isPopulated?V("",!0):(A(),L(J,{key:0,size:"x-small",variant:"text",color:"grey",class:"ml-2"},{default:u(()=>[P(" empty ")]),_:1}))]),T("td",On,[t.editable&&l.editable?(A(),L(X,{key:0,icon:"mdi-pencil",size:"x-small",variant:"text",color:"primary",onClick:c=>a.$emit("edit-field",l)},{default:u(()=>[d(s,{size:"small"},{default:u(()=>[P("mdi-pencil")]),_:1}),d(G,{activator:"parent",location:"top"},{default:u(()=>[P("Edit field")]),_:1})]),_:2},1032,["onClick"])):V("",!0),t.editable&&l.editable?(A(),L(X,{key:1,icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:c=>a.$emit("remove-field",l)},{default:u(()=>[d(s,{size:"small"},{default:u(()=>[P("mdi-delete")]),_:1}),d(G,{activator:"parent",location:"top"},{default:u(()=>[P("Remove this field")]),_:1})]),_:2},1032,["onClick"])):l.warning&&t.showQuickActions?(A(),L(X,{key:2,icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:c=>a.$emit("remove-field",l)},{default:u(()=>[d(s,{size:"small"},{default:u(()=>[P("mdi-delete")]),_:1}),d(G,{activator:"parent",location:"top"},{default:u(()=>[P("Remove this field")]),_:1})]),_:2},1032,["onClick"])):V("",!0)])]))),128))])]),_:1})])]),_:1})):(A(),L(F,{key:1,variant:"tonal",color:"grey-lighten-4",elevation:"0"},{default:u(()=>[d(B,{class:"text-center pa-8"},{default:u(()=>[d(s,{icon:"mdi-arrow-left",size:"64",color:"grey"}),Gn,Nn]),_:1})]),_:1}))]),_:1})]),_:1})])):(A(),L(F,{key:1,variant:"tonal",color:"grey-lighten-4",elevation:"0"},{default:u(()=>[d(B,{class:"text-center pa-8"},{default:u(()=>[d(s,{icon:"mdi-image-off",size:"64",color:"grey"}),Un,Bn]),_:1})]),_:1}))}const zn=st(Tn,[["render",Vn],["__scopeId","data-v-f946027e"]]),jn={name:"MetadataEditor",components:{AddCustomFieldDialog:fn,AddPngFieldDialog:Sn,CardSectionHeader:ta,EducationalAlert:ia,FileUpload:Xi,InfoTooltip:aa,LearnMorePanel:qi,MetadataFieldEditor:In,MetadataViewer:zn,SharedSnackbar:$i,ToolPageHeader:Zi},setup(){const a=j(null),e=j(null),t=j([]),i=j(""),n=j(""),r=j(null),o=j(H.UNKNOWN),s=j(null),m=j(!1),g=j("Processing..."),v=j(null),C=j(null),F=j(null),b=j(null),x=j(null),G=j(null),J=j(!1),X=j(!1),ne=j(!1),{snackbar:B,snackbarColor:$,snackbarText:l,showSnackbar:c}=ea(),f=oe(()=>!G.value||!v.value?null:v.value[G.value]),y=oe(()=>{const w=new Set;return t.value.forEach(E=>{E.field&&typeof E.field=="object"&&E.field.key&&w.add(E.field.key)}),w}),p=w=>y.value.has(w.key),h=w=>{if(!b.value)return!1;for(const E of Object.values(b.value)){const O=E.fields.find(W=>W.key===w.key);if(O&&O.isPopulated&&!w.isPopulated)return!0}return!1},_=w=>{if(!b.value)return null;for(const E of Object.values(b.value)){const O=E.fields.find(W=>W.key===w.key);if(O)return O.value}return null},I=async w=>{const E=_(w);if(E===null||E===""){c("❌ No original value to restore","error");return}await le({field:w,newValue:E}),t.value=t.value.filter(O=>!(O.field&&O.field.key===w.key)),c(`✓ Field "${w.label}" restored to original value`,"success")},M=oe(()=>v.value?getMetadataStats(v.value):{totalFields:0,sections:0,editableFields:0,privacyFields:0,hasGPS:!1,hasCameraInfo:!1,hasTimestamps:!1,hasAuthorInfo:!1}),D=oe(()=>t.value.length>0),z=oe(()=>t.value.length),U=oe(()=>{if(!v.value||!v.value.Location)return console.log("[GPS] No metadata or Location section"),!1;const w=v.value.Location.fields,E=w.find(me=>me.key==="GPS.2"),O=w.find(me=>me.key==="GPS.4");if(console.log("[GPS] latField:",E),console.log("[GPS] lonField:",O),!E||!O)return console.log("[GPS] Missing lat or lon field"),!1;const W=parseFloat(E.value),Q=parseFloat(O.value);console.log("[GPS] lat:",W,"lon:",Q),console.log("[GPS] isPopulated:",E.isPopulated,O.isPopulated);const he=E.isPopulated&&O.isPopulated&&!isNaN(W)&&!isNaN(Q)&&(W!==0||Q!==0);return console.log("[GPS] hasValidGpsCoordinates:",he),he}),Ce=oe(()=>{if(!U.value||!v.value)return"";const w=v.value.Location.fields,E=w.find(ie=>ie.key==="GPS.2"),O=w.find(ie=>ie.key==="GPS.4"),W=w.find(ie=>ie.key==="GPS.1"),Q=w.find(ie=>ie.key==="GPS.3");let he=parseFloat(E.value.replace("°","")),me=parseFloat(O.value.replace("°",""));return W&&W.value==="S"&&(he=-he),Q&&Q.value==="W"&&(me=-me),`https://www.google.com/maps/search/?api=1&query=${he},${me}`}),ye=async w=>{if(w){m.value=!0,g.value="Analyzing metadata...";try{i.value=w.name,n.value=Ki(w.size);const E=await pa(w);r.value=E;const O=await tn(w);if(o.value=O,O===H.UNKNOWN){c("❌ Unsupported image format. Please use JPEG or PNG.","error");return}s.value=E;const W=await it(E,O);if(v.value=W,b.value=JSON.parse(JSON.stringify(W)),F.value=E,Object.keys(W).length===0)c(`ℹ️ No metadata found in this ${O} image`,"info");else{const Q=sn(W,O);c(`✓ Found ${Q.populatedFields} populated field${Q.populatedFields!==1?"s":""} in the ${O} image`,"success")}a.value=null,C.value=null,t.value=[]}catch(E){console.error("Analysis error:",E),c(`❌ ${E.message}`,"error"),v.value=null}finally{m.value=!1}}},se=async()=>{if(r.value){m.value=!0,g.value="Removing all metadata...";try{const w=await rn(r.value,o.value),E=at(o.value);a.value=`data:${E};base64,`+w,c("✓ All metadata removed successfully!","success");const O=Ft(a.value),W=Nt(o.value),Q=i.value.replace(/\.[^/.]+$/,"")+`_clean.${W}`;Et(O,Q)}catch(w){console.error("Metadata removal error:",w),c(`❌ Failed to remove metadata: ${w.message}`,"error")}finally{m.value=!1}}},fe=()=>{if(!a.value)return;const w=Ft(a.value),E=Nt(o.value),O=i.value.replace(/\.[^/.]+$/,"")+`_clean.${E}`;Et(w,O),c("✓ Clean image downloaded!","success")},k=w=>{e.value=w,X.value=!0},K=()=>{e.value=null,X.value=!1},le=async({field:w,newValue:E})=>{if(r.value){m.value=!0,g.value="Saving changes...";try{const O=await an(r.value,o.value,w,E),W=at(o.value);r.value=`data:${W};base64,`+O,C.value=r.value;const Q=await it(r.value,o.value);v.value=Q,t.value.push({field:w,oldValue:w.value,newValue:E,timestamp:new Date}),c(`✓ Field "${w.label}" updated successfully!`,"success")}catch(O){console.error("Field edit error:",O),c(`❌ Failed to edit field: ${O.message}`,"error")}finally{m.value=!1}}},Xe=async w=>{if(r.value){m.value=!0,g.value="Removing field...";try{const E=await nn(r.value,o.value,w),O=at(o.value);r.value=`data:${O};base64,`+E,C.value=r.value;const W=await it(r.value,o.value);v.value=W,t.value.push({field:w.label,oldValue:w.value,newValue:"[Removed]",timestamp:new Date}),c(`✓ Field "${w.label}" removed successfully!`,"success")}catch(E){console.error("Field removal error:",E),c(`❌ Failed to remove field: ${E.message}`,"error")}finally{m.value=!1}}},Ee=()=>{if(!C.value)return;const w=Ft(C.value),E=Nt(o.value),O=i.value.replace(/\.[^/.]+$/,"")+`_modified.${E}`;Et(w,O),c("✓ Modified image downloaded!","success")},ft=()=>{!F.value||!b.value||(r.value=F.value,v.value=JSON.parse(JSON.stringify(b.value)),C.value=null,t.value=[],c("✓ Changes discarded","info"))},Ke=async()=>{if(r.value){if(o.value!==H.JPEG){c('Clear all values is only supported for JPEG images. Use "Download Clean" to remove all PNG metadata.',"info");return}m.value=!0,g.value="Clearing metadata values...";try{const w=await va(r.value),E=at(o.value);r.value=`data:${E};base64,`+w,C.value=r.value;const O=await it(r.value,o.value);v.value=O,t.value.push({field:"All Fields",oldValue:"Various values",newValue:"[Cleared]",timestamp:new Date}),c("✓ All metadata values cleared. Fields are now empty and ready for editing.","success")}catch(w){console.error("Clear metadata error:",w),c(`❌ Failed to clear metadata: ${w.message}`,"error")}finally{m.value=!1}}},Ye=async w=>{if(r.value){m.value=!0,g.value="Adding custom field...";try{const E=await on(r.value,o.value,w),O=at(o.value);r.value=`data:${O};base64,`+E,C.value=r.value;const W=await it(r.value,o.value);v.value=W;let Q;o.value===H.JPEG?Q=`${w.ifd}.${w.tagId}`:o.value===H.PNG&&(Q=w.keyword);let he=null;for(const me of Object.values(W))if(he=me.fields.find(ie=>ie.key===Q),he)break;t.value.push({field:he||{key:Q,label:w.label||w.keyword},oldValue:"[Not set]",newValue:w.value,timestamp:new Date}),c(`✓ Custom field "${w.label||w.keyword}" added successfully!`,"success")}catch(E){console.error("Add custom field error:",E),c(`❌ Failed to add custom field: ${E.message}`,"error")}finally{m.value=!1}}},Pe=()=>{var w,E,O;(w=s.value)!=null&&w.startsWith("blob:")&&URL.revokeObjectURL(s.value),(E=C.value)!=null&&E.startsWith("blob:")&&URL.revokeObjectURL(C.value),(O=a.value)!=null&&O.startsWith("blob:")&&URL.revokeObjectURL(a.value)};return je(x,(w,E)=>{E&&Pe(),w?ye(w):(Pe(),v.value=null,r.value=null,o.value=H.UNKNOWN,s.value=null,a.value=null,C.value=null,F.value=null,b.value=null,t.value=[],i.value="",n.value="",G.value=null)}),je(v,w=>{if(w&&Object.keys(w).length>0){const E=Object.keys(w)[0];G.value=E}else G.value=null}),Qi(()=>{Pe()}),{cleanedImageUrl:a,currentEditField:e,currentSection:f,editCount:z,fileName:i,fileSize:n,googleMapsUrl:Ce,hasValidGpsCoordinates:U,imageFormat:o,imagePreviewUrl:s,isModified:D,isProcessing:m,loadingMessage:g,metadata:v,modifiedImageUrl:C,selectedFile:x,selectedSection:G,showAddFieldDialog:J,showFieldEditor:X,showImageDialog:ne,stats:M,snackbar:B,snackbarColor:$,snackbarText:l,IMAGE_FORMATS:H,addCustomFieldToImage:Ye,clearMetadataValues:Ke,closeFieldEditor:K,confirmRemoveField:Xe,discardChanges:ft,downloadCleanImage:fe,downloadModifiedImage:Ee,executeRemoveAll:se,isClearedField:h,isFieldModified:p,openFieldEditor:k,restoreField:I,saveFieldEdit:le}}},be=a=>(lt("data-v-a25eb72b"),a=a(),ct(),a),Hn=be(()=>T("p",{class:"mb-2"},[T("strong",null,"Photo metadata"),P(" is hidden information embedded inside your image files. Modern smartphones and cameras automatically store data like: ")],-1)),Wn=be(()=>T("ul",{class:"ml-4 mb-2"},[T("li",null,[T("strong",null,"GPS Location"),P(" - Exact coordinates showing where the photo was taken")]),T("li",null,[T("strong",null,"Camera/Phone Model"),P(" - Device manufacturer and model number")]),T("li",null,[T("strong",null,"Date & Time"),P(" - When the photo was captured")]),T("li",null,[T("strong",null,"Camera Settings"),P(" - ISO, aperture, shutter speed, etc.")])],-1)),Xn=be(()=>T("p",{class:"mt-3 mb-2"},[T("strong",null,"Common use cases:"),P(" Remove metadata before posting photos to social media, selling items online, or sharing images publicly to protect your privacy. ")],-1)),Kn=be(()=>T("div",{class:"text-caption text-medium-emphasis mt-3"},[T("strong",null,"Learn more:"),T("a",{href:"https://en.wikipedia.org/wiki/Exif",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: EXIF "),P(" • "),T("a",{href:"https://en.wikipedia.org/wiki/Portable_Network_Graphics#Metadata",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," PNG Metadata ")],-1)),Yn=be(()=>T("div",{class:"text-caption text-medium-emphasis mt-2"},[T("strong",null,"Technical:"),P(" Uses "),T("a",{href:"https://github.com/MikeKovarik/exifr",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"exifr"),P(" and "),T("a",{href:"https://github.com/hMatoba/piexifjs",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"piexifjs"),P(" for JPEG, "),T("a",{href:"https://github.com/SteamDiesel/png-metadata",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"png-metadata"),P(" for PNG. All processing happens in your browser. ")],-1)),Jn={class:"sidebar-sticky"},qn={class:"preview-overlay"},Qn=be(()=>T("div",{class:"text-caption text-white mt-1"},"Click to expand",-1)),Zn={class:"text-caption text-medium-emphasis mt-2"},$n={class:"text-caption text-medium-emphasis"},er={key:0,class:"text-caption text-warning"},tr=be(()=>T("div",{class:"text-caption text-medium-emphasis mb-2 font-weight-medium"}," Attribute Actions ",-1)),ir=be(()=>T("div",{class:"text-caption text-medium-emphasis mb-2 font-weight-medium"}," Download Actions ",-1)),ar={class:"metadata-fields-table"},nr={class:"table-col-label text-body-2 font-weight-medium"},rr={class:"tooltip-content"},or={class:"table-col-value text-body-2"},sr={key:0},lr={class:"table-col-actions-md"},cr={class:"d-sm-none"},dr={class:"d-flex align-center mb-2"},ur={class:"text-body-2 font-weight-medium"},fr={class:"text-body-2 mb-2",style:{"word-break":"break-word"}},hr={key:0},mr={class:"d-flex gap-2"},pr=be(()=>T("p",{class:"text-h6 text-medium-emphasis mt-4"},"Select a Category",-1)),gr=be(()=>T("p",{class:"text-body-2 text-medium-emphasis"}," Click a category on the left to view its metadata fields. ",-1)),yr={class:"text-h6 mt-4"},Sr={class:"text-caption text-medium-emphasis"};function vr(a,e,t,i,n,r){const o=S("ToolPageHeader"),s=S("EducationalAlert"),m=S("LearnMorePanel"),g=S("v-icon"),v=S("v-card-title"),C=S("FileUpload"),F=S("v-card-text"),b=S("v-card"),x=S("v-spacer"),G=S("v-chip"),J=S("v-progress-circular"),X=S("v-row"),ne=S("v-img"),B=S("v-col"),$=S("InfoTooltip"),l=S("v-list-item-title"),c=S("v-list-item-subtitle"),f=S("v-list-item"),y=S("v-list"),p=S("v-btn"),h=S("v-divider"),_=S("v-tooltip"),I=S("v-alert"),M=S("v-table"),D=S("SharedSnackbar"),z=S("MetadataFieldEditor"),U=S("AddCustomFieldDialog"),Ce=S("AddPngFieldDialog"),ye=S("v-overlay"),se=S("v-card-actions"),fe=S("v-dialog");return A(),ce("div",null,[d(o,{icon:"mdi-image-filter-hdr",title:"Metadata Editor",description:"View, edit, and remove metadata from JPEG and PNG images for complete privacy control","avatar-color":"warning"}),d(m,{title:"What is Photo Metadata?","storage-key":"slurm-help-metadata-editor"},{default:u(()=>[Hn,Wn,d(s,{title:"Privacy Warning",type:"warning",spacing:"mt-3"},{default:u(()=>[P(" Most smartphone photos contain GPS coordinates that reveal your exact location. This can expose where you live, work, or travel when you share photos online. ")]),_:1}),Xn,Kn,Yn]),_:1}),d(X,null,{default:u(()=>[d(B,{cols:"12",lg:"4",md:"5",class:"sidebar-column"},{default:u(()=>[T("div",Jn,[d(b,{class:"mb-3"},{default:u(()=>[d(v,{class:"bg-surface-variant"},{default:u(()=>[d(g,{icon:"mdi-image",class:"mr-2"}),P(" Edit image metadata ")]),_:1}),d(F,{class:"pa-3"},{default:u(()=>[d(s,{title:"Privacy Tip",type:"info",spacing:"mb-3"},{default:u(()=>[P(" Photos often contain GPS coordinates, camera model, and timestamps. Check your metadata below before sharing photos publicly. ")]),_:1}),d(C,{modelValue:i.selectedFile,"onUpdate:modelValue":e[0]||(e[0]=k=>i.selectedFile=k),label:"Select Image",accept:".jpg,.jpeg,.png","prepend-icon":"mdi-camera",hint:"Supported formats: JPEG, PNG"},null,8,["modelValue"])]),_:1})]),_:1}),i.metadata&&i.imagePreviewUrl?(A(),L(b,{key:0},{default:u(()=>[d(v,{class:"bg-surface-variant d-flex align-center"},{default:u(()=>[d(g,{icon:"mdi-image",class:"mr-2"}),P(" Preview "),d(x),i.isModified?(A(),L(G,{key:0,size:"x-small",color:"warning",variant:"flat"},{default:u(()=>[d(g,{start:"",icon:"mdi-pencil",size:"x-small"}),P(" Modified ")]),_:1})):V("",!0)]),_:1}),d(F,{class:"pa-3"},{default:u(()=>[d(ne,{src:i.isModified?i.modifiedImageUrl:i.imagePreviewUrl,"aspect-ratio":"1",class:"rounded cursor-pointer preview-thumbnail",cover:"",onClick:e[1]||(e[1]=k=>i.showImageDialog=!0)},{placeholder:u(()=>[d(X,{align:"center",justify:"center",class:"fill-height"},{default:u(()=>[d(J,{indeterminate:"",size:"32"})]),_:1})]),default:u(()=>[T("div",qn,[d(g,{icon:"mdi-magnify-plus-outline",size:"32",color:"white"}),Qn])]),_:1},8,["src"]),T("div",Zn,N(i.fileName),1),T("div",$n,N(i.fileSize),1),T("div",{class:Ci(["modification-status",{"has-content":i.isModified}])},[i.isModified?(A(),ce("div",er,[d(g,{icon:"mdi-alert",size:"x-small",class:"mr-1"}),P(" "+N(i.editCount)+" unsaved change"+N(i.editCount!==1?"s":""),1)])):V("",!0)],2)]),_:1})]),_:1})):V("",!0)])]),_:1}),d(B,{cols:"12",lg:"8",md:"7"},{default:u(()=>[i.metadata?(A(),L(X,{key:0},{default:u(()=>[d(B,{cols:"12",md:"4"},{default:u(()=>[d(b,null,{default:u(()=>[d(v,{class:"bg-surface-variant"},{default:u(()=>[d(g,{icon:"mdi-format-list-bulleted",class:"mr-2"}),P(" Categories "),d($,{text:"Click a category to view its fields. The Location category often contains GPS coordinates that reveal where photos were taken - a common privacy risk.",location:"bottom"})]),_:1}),d(y,{density:"compact",class:"pa-0"},{default:u(()=>[(A(!0),ce(Me,null,Oe(i.metadata,(k,K)=>(A(),L(f,{key:K,value:K,active:i.selectedSection===K,onClick:le=>i.selectedSection=K,class:"list-item-hover"},{prepend:u(()=>[d(g,{icon:k.icon,color:k.color,size:"small"},null,8,["icon","color"])]),default:u(()=>[d(l,{class:"text-body-2"},{default:u(()=>[P(N(k.name)+" ",1),k.fields.filter(le=>i.isFieldModified(le)).length>0?(A(),L(G,{key:0,size:"x-small",variant:"flat",color:"warning",class:"ml-2"},{default:u(()=>[P(N(k.fields.filter(le=>i.isFieldModified(le)).length)+" modified ",1)]),_:2},1024)):V("",!0)]),_:2},1024),d(c,{class:"text-caption"},{default:u(()=>[P(N(k.fields.filter(le=>le.isPopulated).length)+" / "+N(k.fields.length)+" populated ",1)]),_:2},1024)]),_:2},1032,["value","active","onClick"]))),128))]),_:1})]),_:1}),d(b,{class:"mt-3"},{default:u(()=>[d(v,{class:"bg-surface-variant"},{default:u(()=>[d(g,{icon:"mdi-cog",class:"mr-2"}),P(" Actions ")]),_:1}),d(F,{class:"pa-3"},{default:u(()=>[tr,d(p,{color:"primary",variant:"elevated","prepend-icon":"mdi-plus-circle",onClick:e[2]||(e[2]=k=>i.showAddFieldDialog=!0),size:"small",block:"",class:"mb-2"},{default:u(()=>[P(" Add Custom Field ")]),_:1}),d(p,{color:"error",variant:"outlined","prepend-icon":"mdi-eraser",onClick:i.clearMetadataValues,size:"small",block:"",disabled:i.isModified,class:"mb-2"},{default:u(()=>[P(" Clear All Values ")]),_:1},8,["onClick","disabled"]),i.isModified?(A(),L(p,{key:0,color:"grey",variant:"outlined","prepend-icon":"mdi-undo",onClick:i.discardChanges,size:"small",block:"",class:"mb-4"},{default:u(()=>[P(" Discard Changes ")]),_:1},8,["onClick"])):V("",!0),i.isModified?(A(),L(h,{key:1,class:"my-3"})):(A(),L(h,{key:2,class:"my-2"})),ir,i.isModified?(A(),L(p,{key:3,color:"success",variant:"elevated","prepend-icon":"mdi-download",onClick:i.downloadModifiedImage,size:"small",block:"",class:"mb-2"},{default:u(()=>[P(" Download Modified ")]),_:1},8,["onClick"])):V("",!0),d(p,{color:"error",variant:"elevated","prepend-icon":"mdi-shield-lock",onClick:i.executeRemoveAll,size:"small",block:""},{default:u(()=>[P(" Download Clean ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),d(B,{cols:"12",md:"8"},{default:u(()=>[i.currentSection?(A(),L(b,{key:0},{default:u(()=>[d(v,{class:"bg-surface-variant"},{default:u(()=>[d(g,{icon:i.currentSection.icon,color:i.currentSection.color},null,8,["icon","color"]),P(" "+N(i.currentSection.name)+" ",1),i.selectedSection==="Location"&&i.hasValidGpsCoordinates?(A(),L(p,{key:0,href:i.googleMapsUrl,target:"_blank",size:"small",variant:"text",color:"primary","prepend-icon":"mdi-map-marker",class:"ml-3"},{default:u(()=>[P(" View on Maps "),d(_,{activator:"parent",location:"bottom"},{default:u(()=>[P("Open coordinates in Google Maps")]),_:1})]),_:1},8,["href"])):V("",!0)]),_:1}),i.currentSection.description?(A(),L(I,{key:0,color:"info",variant:"tonal",density:"compact",class:"ma-3"},{default:u(()=>[P(N(i.currentSection.description),1)]),_:1})):V("",!0),T("div",ar,[d(M,{density:"compact",class:"d-none d-sm-table"},{default:u(()=>[T("tbody",null,[(A(!0),ce(Me,null,Oe(i.currentSection.fields,k=>(A(),ce("tr",{key:k.key},[T("td",nr,[P(N(k.label)+" ",1),i.isFieldModified(k)&&!i.isClearedField(k)?(A(),L(g,{key:0,icon:"mdi-pencil",size:"x-small",color:"warning",class:"ml-1"})):V("",!0),i.isClearedField(k)?(A(),L(g,{key:1,icon:"mdi-delete",size:"x-small",color:"error",class:"ml-1"})):V("",!0),k.editWarning?(A(),L(_,{key:2,location:"top"},{activator:u(({props:K})=>[d(g,bi(K,{icon:"mdi-information-outline",size:"x-small",color:"info",class:"ml-1"}),null,16)]),default:u(()=>[T("span",rr,N(k.editWarning),1)]),_:2},1024)):V("",!0)]),T("td",or,[k.isPopulated||i.isFieldModified(k)?(A(),ce("span",sr,N(k.value),1)):V("",!0),!k.isPopulated&&!i.isFieldModified(k)?(A(),L(G,{key:1,size:"x-small",variant:"text",color:"grey"},{default:u(()=>[P(" empty ")]),_:1})):V("",!0)]),T("td",lr,[i.isFieldModified(k)||i.isClearedField(k)?(A(),L(p,{key:0,icon:"mdi-restore",size:"x-small",variant:"text",color:"success",onClick:K=>i.restoreField(k)},{default:u(()=>[d(g,{size:"small"},{default:u(()=>[P("mdi-restore")]),_:1}),d(_,{activator:"parent",location:"top"},{default:u(()=>[P("Restore original value")]),_:1})]),_:2},1032,["onClick"])):V("",!0),k.editable?(A(),L(p,{key:1,icon:"mdi-pencil",size:"x-small",variant:"text",color:"primary",onClick:K=>i.openFieldEditor(k)},{default:u(()=>[d(g,{size:"small"},{default:u(()=>[P("mdi-pencil")]),_:1}),d(_,{activator:"parent",location:"top"},{default:u(()=>[P("Edit field")]),_:1})]),_:2},1032,["onClick"])):V("",!0),k.editable?(A(),L(p,{key:2,icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:K=>i.confirmRemoveField(k)},{default:u(()=>[d(g,{size:"small"},{default:u(()=>[P("mdi-delete")]),_:1}),d(_,{activator:"parent",location:"top"},{default:u(()=>[P("Remove this field")]),_:1})]),_:2},1032,["onClick"])):V("",!0)])]))),128))])]),_:1}),T("div",cr,[(A(!0),ce(Me,null,Oe(i.currentSection.fields,k=>(A(),L(b,{key:k.key,variant:"outlined",class:"mb-2"},{default:u(()=>[d(F,{class:"pa-3"},{default:u(()=>[T("div",dr,[T("span",ur,N(k.label),1),d(x),i.isFieldModified(k)&&!i.isClearedField(k)?(A(),L(g,{key:0,icon:"mdi-pencil",size:"small",color:"warning"})):V("",!0),i.isClearedField(k)?(A(),L(g,{key:1,icon:"mdi-delete",size:"small",color:"error"})):V("",!0)]),T("div",fr,[k.isPopulated||i.isFieldModified(k)?(A(),ce("span",hr,N(k.value),1)):V("",!0),!k.isPopulated&&!i.isFieldModified(k)?(A(),L(G,{key:1,size:"x-small",variant:"text",color:"grey"},{default:u(()=>[P(" empty ")]),_:1})):V("",!0)]),T("div",mr,[i.isFieldModified(k)||i.isClearedField(k)?(A(),L(p,{key:0,size:"small",variant:"outlined",color:"success",onClick:K=>i.restoreField(k)},{default:u(()=>[d(g,{start:"",size:"small"},{default:u(()=>[P("mdi-restore")]),_:1}),P(" Restore ")]),_:2},1032,["onClick"])):V("",!0),k.editable?(A(),L(p,{key:1,size:"small",variant:"outlined",color:"primary",onClick:K=>i.openFieldEditor(k)},{default:u(()=>[d(g,{start:"",size:"small"},{default:u(()=>[P("mdi-pencil")]),_:1}),P(" Edit ")]),_:2},1032,["onClick"])):V("",!0),k.editable?(A(),L(p,{key:2,size:"small",variant:"outlined",color:"error",onClick:K=>i.confirmRemoveField(k)},{default:u(()=>[d(g,{start:"",size:"small"},{default:u(()=>[P("mdi-delete")]),_:1}),P(" Remove ")]),_:2},1032,["onClick"])):V("",!0)])]),_:2},1024)]),_:2},1024))),128))])])]),_:1})):(A(),L(b,{key:1,variant:"tonal",color:"grey-lighten-4",elevation:"0"},{default:u(()=>[d(F,{class:"text-center pa-8"},{default:u(()=>[d(g,{icon:"mdi-arrow-left",size:"64",color:"grey"}),pr,gr]),_:1})]),_:1}))]),_:1})]),_:1})):V("",!0)]),_:1})]),_:1}),d(D,{modelValue:i.snackbar,"onUpdate:modelValue":e[3]||(e[3]=k=>i.snackbar=k),text:i.snackbarText,color:i.snackbarColor},null,8,["modelValue","text","color"]),d(z,{modelValue:i.showFieldEditor,"onUpdate:modelValue":e[4]||(e[4]=k=>i.showFieldEditor=k),field:i.currentEditField,onSave:i.saveFieldEdit,onRemove:i.confirmRemoveField,onCancel:i.closeFieldEditor},null,8,["modelValue","field","onSave","onRemove","onCancel"]),i.imageFormat===i.IMAGE_FORMATS.JPEG?(A(),L(U,{key:0,modelValue:i.showAddFieldDialog,"onUpdate:modelValue":e[5]||(e[5]=k=>i.showAddFieldDialog=k),onAddField:i.addCustomFieldToImage,onCancel:e[6]||(e[6]=k=>i.showAddFieldDialog=!1)},null,8,["modelValue","onAddField"])):V("",!0),i.imageFormat===i.IMAGE_FORMATS.PNG?(A(),L(Ce,{key:1,modelValue:i.showAddFieldDialog,"onUpdate:modelValue":e[7]||(e[7]=k=>i.showAddFieldDialog=k),onAddField:i.addCustomFieldToImage,onCancel:e[8]||(e[8]=k=>i.showAddFieldDialog=!1)},null,8,["modelValue","onAddField"])):V("",!0),d(ye,{"model-value":i.isProcessing,class:"align-center justify-center"},{default:u(()=>[d(J,{indeterminate:"",size:"64",color:"warning"}),T("p",yr,N(i.loadingMessage),1)]),_:1},8,["model-value"]),d(fe,{modelValue:i.showImageDialog,"onUpdate:modelValue":e[10]||(e[10]=k=>i.showImageDialog=k),"max-width":"90vw","max-height":"90vh"},{default:u(()=>[d(b,{class:"d-flex flex-column",style:{"max-height":"90vh"}},{default:u(()=>[d(v,{class:"d-flex align-center bg-surface-variant flex-shrink-0"},{default:u(()=>[d(g,{icon:"mdi-image",class:"mr-2"}),P(" "+N(i.fileName)+" ",1),d(x),d(p,{icon:"mdi-close",variant:"text",onClick:e[9]||(e[9]=k=>i.showImageDialog=!1)})]),_:1}),d(F,{class:"pa-0 flex-grow-1",style:{overflow:"hidden"}},{default:u(()=>[d(ne,{src:i.imagePreviewUrl,"max-height":"calc(90vh - 100px)",contain:""},{placeholder:u(()=>[d(X,{align:"center",justify:"center",class:"fill-height"},{default:u(()=>[d(J,{indeterminate:"",size:"64"})]),_:1})]),_:1},8,["src"])]),_:1}),d(se,{class:"bg-surface-variant flex-shrink-0"},{default:u(()=>[d(x),T("div",Sr,N(i.fileSize),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ir=st(jn,[["render",vr],["__scopeId","data-v-a25eb72b"]]);export{Ir as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
