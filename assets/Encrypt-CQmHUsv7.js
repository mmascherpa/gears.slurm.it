import{_ as re,a as se,c as W,b as a,i as z,j as U,w as s,r as f,d as E,k as q,e as i,o as b,F as O,g as e,f as o,t as le,l as ie}from"./index-_lZS3CbI.js";import{d as ce}from"./fileDownload-B1vhVzTR.js";import{C as de,p as pe}from"./CsvPreviewTable-arFNN8_M.js";import{P as ue,u as me,a as ye}from"./PasswordInput-C1GtIVkh.js";import{u as fe}from"./useClipboard-KqVwDR14.js";import{u as ve}from"./useDebounce-BqRH7c0g.js";import{T as he,S as ge,u as be}from"./ToolPageHeader-DeIUEXN-.js";import{_ as _e}from"./EducationalAlert-CxalLgoq.js";import{T as we,F as xe}from"./TextInputWithActions-C_FZvg3H.js";import{_ as Ce}from"./InfoTooltip-BRQHX8ly.js";import"./PasswordStrengthIndicator-BEcgw2Zq.js";import"./FileUpload-BnGHFsNw.js";const ke={name:"Encrypt",components:{CsvPreviewTable:de,EducationalAlert:_e,FileUploadWithValidation:xe,InfoTooltip:Ce,LearnMorePanel:se,PasswordInput:ue,SharedSnackbar:ge,TextInputWithActions:we,ToolPageHeader:he},setup(){const u=f(""),n=f(""),p=f(""),t=f(""),v=f(null),h=f(""),_=f("jsAesCrypt"),m=f([]),w=f([]),{snackbar:V,snackbarColor:x,snackbarText:C,showSnackbar:d}=be(),{copyToClipboard:B,pasteFromClipboard:k}=fe(),{rememberPassword:y,isPasswordRemembered:L,saveSessionPassword:F,clearSessionPassword:j,autoLoadPassword:D}=me("encrypt"),P=D();P&&(p.value=P,t.value=P);const{encrypt:I,isLoading:M}=ye((r,c)=>{S.value?Q(r):(ce(r,c),d("✓ File encrypted successfully!","success"),Y())},(r,c)=>{n.value=c,d(r,"error"),u.value=""}),R=E(()=>({jsAesCrypt:"What is AES Encryption?",webCrypto:"What is WebCrypto AES Encryption?",age:"What is Age Encryption?"})[_.value]||"What is Encryption?"),A=E(()=>l.value&&(T.value||S.value)),T=E(()=>!!v.value),H=E(()=>w.value.length>0||m.value.length>0),l=E(()=>p.value.trim()!==""&&p.value===t.value),S=E(()=>h.value.trim()!==""),Y=()=>{y.value||(p.value="",t.value=""),h.value="",v.value=null,u.value="",K()},K=()=>{m.value=[],w.value=[],search.value="",n.value=""},J=()=>{h.value="",u.value="",n.value="",ne()},Q=r=>{try{const c=new Blob([r]),g=new FileReader;g.onload=()=>{const G=g.result.split(",")[1];u.value=G,d("✓ Text encrypted successfully!","success")},g.onerror=()=>{n.value="Failed to convert encrypted data",d("❌ Encryption failed","error")},g.readAsDataURL(c)}catch(c){console.error("Base64 conversion error:",c),n.value="Failed to convert encrypted data",d("❌ Encryption failed","error")}},X=()=>{if(!A.value){d("Invalid inputs","error");return}n.value="";let r=null,c=null;S.value?(r=new Blob([h.value],{type:"text/plain"}),c="plaintext.txt"):T.value&&(r=v.value,c=v.value.name),r&&c&&I(r,p.value,c,_.value)},Z=r=>{if(v.value&&r.isValid){const c=v.value;if(c.type==="text/csv"){const g=new FileReader;g.onload=()=>{const G=g.result;$(G)},g.readAsText(c)}}},$=r=>{const c=pe(r);w.value=c.headers,m.value=c.data},ee=()=>{if(A.value){n.value="",u.value="";try{const r=new Blob([h.value],{type:"text/plain"});I(r,p.value,"plaintext.txt",_.value)}catch(r){console.error("Encryption error:",r),n.value="Failed to initiate encryption",d("❌ Encryption failed","error")}}},te=async()=>{await B(u.value,r=>d(r,"success"),r=>d(r,"error"))},oe=async()=>{await k((r,c)=>{h.value=r,d(c,"success"),N()},r=>d(r,"error"))},ae=()=>{u.value="",n.value="",N()},{cancel:ne,debounce:N}=ve(()=>{A.value&&S.value&&ee()},800);return q(y,r=>{r&&l.value&&F(p.value)}),q([p,t],()=>{y.value&&l.value&&F(p.value),S.value&&(u.value="",n.value="",N())}),{encryptedText:u,error:n,isLoading:M,password:p,passwordConfirm:t,plainFile:v,plainText:h,selectedAlgorithm:_,tableData:m,tableHeaders:w,rememberPassword:y,isPasswordRemembered:L,clearSessionPassword:j,snackbar:V,snackbarColor:x,snackbarText:C,canEncrypt:A,infoPanelTitle:R,isFilePopulated:T,isOutputPopulated:H,isPasswordConfirmed:l,isPlaintextPopulated:S,clearOutputs:K,clearPlainText:J,encryptFile:X,handleCopy:te,handleFileValidation:Z,handlePaste:oe,handlePlainTextChange:ae}}},Pe=e("p",{class:"mb-2"},[e("strong",null,"AES (Advanced Encryption Standard)"),o(" is a military-grade encryption algorithm trusted by governments and organizations worldwide to protect sensitive data. ")],-1),Ae=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"AES-256"),o(" - This tool uses 256-bit keys, the strongest AES variant")]),e("li",null,[e("strong",null,"Password-based"),o(" - Your password is converted into an encryption key")]),e("li",null,[e("strong",null,"Cross-platform"),o(" - Compatible with desktop AES Crypt applications")]),e("li",null,[e("strong",null,"Unbreakable"),o(" - With a strong password, AES-256 would take billions of years to crack")])],-1),Se=e("strong",null,"cannot be recovered",-1),Ee=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Encrypt sensitive documents before uploading to cloud storage, secure backups, protect confidential files on shared computers. ")],-1),Te=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),o(" • "),e("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard "),o(" • "),e("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," jsAesCrypt ")],-1),Ve=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" AES-256-CBC cipher mode with PBKDF2 key derivation (10,000 iterations). Uses jsAesCrypt and CryptoJS libraries. Produces .aes files compatible with AES Crypt format. ")],-1),Fe=e("p",{class:"mb-2"},[e("strong",null,"Web Cryptography API"),o(" provides browser-native AES-256 encryption with hardware acceleration, offering fast, secure encryption without external libraries. ")],-1),Ie=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"AES-256-GCM"),o(" - Modern authenticated encryption mode that prevents tampering")]),e("li",null,[e("strong",null,"Hardware-accelerated"),o(" - Uses CPU crypto instructions for optimal performance")]),e("li",null,[e("strong",null,"Browser-native"),o(" - Built into modern browsers, no external dependencies")]),e("li",null,[e("strong",null,"High security"),o(" - PBKDF2 with 100,000 iterations for strong key derivation")])],-1),We=e("strong",null,"cannot be recovered",-1),Ue=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Fast encryption for modern browsers, maximum compatibility, browser-based secure storage, privacy-focused applications. ")],-1),Be=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," MDN: Web Crypto API "),o(" • "),e("a",{href:"https://www.w3.org/TR/WebCryptoAPI/",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," W3C Specification ")],-1),Le=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" AES-256-GCM authenticated encryption with PBKDF2 key derivation (100,000 iterations). Browser-native Web Crypto API. Produces .enc files. ")],-1),je=e("p",{class:"mb-2"},[e("strong",null,"Age encryption"),o(" is a modern, simple file encryption tool designed as a replacement for GPG. Created by Filippo Valsorda, it focuses on simplicity and ease of use. ")],-1),De=e("ul",{class:"ml-4 mb-2"},[e("li",null,[e("strong",null,"Simple format"),o(" - Compact, easy-to-use encryption format")]),e("li",null,[e("strong",null,"CLI-compatible"),o(" - Works with age and rage command-line tools")]),e("li",null,[e("strong",null,"scrypt derivation"),o(" - Secure against GPU-based password cracking")]),e("li",null,[e("strong",null,"Armor format"),o(" - ASCII-armored output for text-safe transmission")])],-1),Me=e("strong",null,"cannot be recovered",-1),Re=e("p",{class:"mt-3 mb-2"},[e("strong",null,"Common use cases:"),o(" Cross-platform encrypted backups, scripting and automation, developer workflows, command-line integration. ")],-1),He=e("div",{class:"text-caption text-medium-emphasis mt-3"},[e("strong",null,"Learn more:"),e("a",{href:"https://age-encryption.org",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age specification "),o(" • "),e("a",{href:"https://github.com/FiloSottile/age",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Age on GitHub "),o(" • "),e("a",{href:"https://github.com/str4d/rage",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," rage (Rust) ")],-1),Ne=e("div",{class:"text-caption text-medium-emphasis mt-2"},[e("strong",null,"Technical:"),o(" Uses rage-wasm (Rust compiled to WebAssembly) with scrypt password derivation. Produces .age files with optional armor encoding. ")],-1),Ge=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (jsAesCrypt)"),e("div",{class:"text-caption text-medium-emphasis"},"Compatible with AES Crypt format (.aes files)")],-1),ze=e("div",null,[e("div",{class:"font-weight-medium"},"AES-256 (WebCrypto)"),e("div",{class:"text-caption text-medium-emphasis"},"Browser-native encryption (.enc files)")],-1),Oe=e("div",null,[e("div",{class:"font-weight-medium"},"Age Encryption"),e("div",{class:"text-caption text-medium-emphasis"},"Modern encryption format (.age files)")],-1),Ke=e("a",{href:"https://age-encryption.org",target:"_blank",class:"text-info"},"age CLI tool",-1),qe=e("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Ye=e("p",{class:"text-h6 mt-4"},"Encrypting...",-1);function Je(u,n,p,t,v,h){const _=i("ToolPageHeader"),m=i("EducationalAlert"),w=i("LearnMorePanel"),V=i("v-alert"),x=i("v-icon"),C=i("v-card-title"),d=i("v-radio"),B=i("v-radio-group"),k=i("v-card-text"),y=i("v-card"),L=i("InfoTooltip"),F=i("PasswordInput"),j=i("v-checkbox"),D=i("v-chip"),P=i("TextInputWithActions"),I=i("v-divider"),M=i("FileUploadWithValidation"),R=i("CsvPreviewTable"),A=i("SharedSnackbar"),T=i("v-progress-circular"),H=i("v-overlay");return b(),W("div",null,[a(_,{icon:"mdi-lock",title:"Encryption",description:"Encrypt files and text with password protection using military-grade encryption","avatar-color":"primary"}),a(w,{title:t.infoPanelTitle,"storage-key":"slurm-help-encrypt"},{default:s(()=>[t.selectedAlgorithm==="jsAesCrypt"?(b(),W(O,{key:0},[Pe,Ae,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Se,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Ee,Te,Ve],64)):t.selectedAlgorithm==="webCrypto"?(b(),W(O,{key:1},[Fe,Ie,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),We,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Ue,Be,Le],64)):t.selectedAlgorithm==="age"?(b(),W(O,{key:2},[je,De,a(m,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:s(()=>[o(" If you forget your password, your encrypted data "),Me,o('. There is no "reset password" option - the password IS the key. ')]),_:1}),Re,He,Ne],64)):U("",!0)]),_:1},8,["title"]),t.error?(b(),z(V,{key:0,type:"error",variant:"tonal",closable:"","onClick:close":n[0]||(n[0]=l=>t.error=""),class:"mb-4"},{default:s(()=>[o(le(t.error),1)]),_:1})):U("",!0),a(y,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-shield-lock",class:"mr-2"}),o(" Encryption Algorithm ")]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(B,{modelValue:t.selectedAlgorithm,"onUpdate:modelValue":n[1]||(n[1]=l=>t.selectedAlgorithm=l),inline:""},{default:s(()=>[a(d,{value:"jsAesCrypt"},{label:s(()=>[Ge]),_:1}),a(d,{value:"webCrypto"},{label:s(()=>[ze]),_:1}),a(d,{value:"age"},{label:s(()=>[Oe]),_:1})]),_:1},8,["modelValue"]),t.selectedAlgorithm==="age"?(b(),z(V,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:s(()=>[o(" Age encrypted files (.age) are compatible with the "),Ke]),_:1})):U("",!0)]),_:1})]),_:1}),a(y,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-key",class:"mr-2"}),o(" Password Protection "),a(L,{text:"Password strength directly determines your encryption security. A weak 6-character password can be cracked in minutes, while a strong 16+ character password would take centuries to brute-force.",location:"bottom"})]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(m,{title:"Password Strength Matters",type:"info",spacing:"mb-3"},{default:s(()=>[o(" Use at least 12 characters with a mix of uppercase, lowercase, numbers, and symbols. Your password security determines how long your encrypted data stays protected. ")]),_:1}),e("form",{onSubmit:n[5]||(n[5]=ie(()=>{},["prevent"]))},[qe,a(F,{password:t.password,"onUpdate:password":n[2]||(n[2]=l=>t.password=l),"password-confirm":t.passwordConfirm,"onUpdate:passwordConfirm":n[3]||(n[3]=l=>t.passwordConfirm=l),"require-confirmation":!0,"show-strength":!0,"show-requirements":!0,"show-feedback":!1,autocomplete:"new-password"},null,8,["password","password-confirm"]),a(j,{modelValue:t.rememberPassword,"onUpdate:modelValue":n[4]||(n[4]=l=>t.rememberPassword=l),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),t.isPasswordRemembered?(b(),z(D,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":t.clearSessionPassword,class:"mt-2"},{default:s(()=>[o(" Password remembered for session ")]),_:1},8,["onClick:close"])):U("",!0)],32)]),_:1})]),_:1}),a(y,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-text",class:"mr-2"}),o(" Text Encryption ")]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(P,{modelValue:t.plainText,"onUpdate:modelValue":n[6]||(n[6]=l=>t.plainText=l),label:"Plain Text",placeholder:"Enter your plain text here",rows:4,disabled:t.isFilePopulated,"show-paste":!t.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"plain-text-input",onPaste:t.handlePaste,onClear:t.clearPlainText,onInput:t.handlePlainTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),a(I,{class:"my-4"}),a(P,{modelValue:t.encryptedText,"onUpdate:modelValue":n[7]||(n[7]=l=>t.encryptedText=l),label:"Encrypted Text (Base64)",placeholder:"Encrypted output will appear here...",rows:4,"is-loading":t.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:t.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),a(y,{class:"mb-4"},{default:s(()=>[a(C,{class:"bg-surface-variant"},{default:s(()=>[a(x,{icon:"mdi-file",class:"mr-2"}),o(" File Encryption ")]),_:1}),a(k,{class:"pa-4"},{default:s(()=>[a(M,{modelValue:t.plainFile,"onUpdate:modelValue":n[8]||(n[8]=l=>t.plainFile=l),label:"Select file to encrypt","button-text":"Encrypt","button-icon":"mdi-lock",disabled:t.isPlaintextPopulated,"can-submit":t.canEncrypt,onSubmit:t.encryptFile,onValidationChange:t.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1}),a(R,{headers:t.tableHeaders,data:t.tableData,onClose:t.clearOutputs},null,8,["headers","data","onClose"]),a(A,{modelValue:t.snackbar,"onUpdate:modelValue":n[9]||(n[9]=l=>t.snackbar=l),text:t.snackbarText,color:t.snackbarColor},null,8,["modelValue","text","color"]),a(H,{"model-value":t.isLoading,class:"align-center justify-center"},{default:s(()=>[a(T,{indeterminate:"",size:"64",color:"primary"}),Ye]),_:1},8,["model-value"])])}const it=re(ke,[["render",Je]]);export{it as default};
