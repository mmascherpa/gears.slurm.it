import{r as f,m as k,k as b,_ as I,d as v,i as C,w as P,e as p,o as y,b as h,j as g,g as q,c as B}from"./index-B-OSmdDu.js";import{P as E}from"./PasswordStrengthIndicator-BC1YKonA.js";function W(s,r,n={}){const e=f(null),d=f(!1);n.providerType;const m=()=>{e.value||(e.value=new Worker("/worker.js"),e.value.onmessage=c)},c=a=>{const[o,t,l]=a.data;if(d.value=!1,o==="ERROR"){r==null||r(t,t);return}s==null||s(t,l)},i=(a,o,t)=>{if(!a||!o){console.error("useAESWorker: Missing fileData or password");return}d.value=!0,m(),e.value.postMessage(["ENCRYPT",a,o,t])},w=(a,o,t)=>{if(!a||!o){console.error("useAESWorker: Missing fileData or password");return}d.value=!0,m(),e.value.postMessage(["DECRYPT",a,o,t])},u=()=>{e.value&&(e.value.terminate(),e.value=null)};return k(()=>{u()}),{worker:e,isLoading:d,encrypt:i,decrypt:w,terminateWorker:u}}function A(s="encrypt"){const r=`slurm_aes_${s}_session_password`,n=f(!1),e=f(!1),d=()=>{try{const o=sessionStorage.getItem(r),t=!!o;return e.value=t,n.value=t,o}catch(o){return console.error("Failed to check session password:",o),e.value=!1,null}},m=o=>{if(!n.value||!o){i();return}try{sessionStorage.setItem(r,o),e.value=!0}catch(t){console.error("Failed to save session password:",t),e.value=!1}},c=()=>{try{return sessionStorage.getItem(r)}catch(o){return console.error("Failed to get session password:",o),null}},i=()=>{try{sessionStorage.removeItem(r)}catch(o){console.error("Failed to clear session password:",o)}finally{e.value=!1,n.value=!1}},w=()=>d()||"";b(n,o=>{o||i()});const u=()=>{document.hidden&&i()},a=()=>{i()};return typeof document<"u"&&(document.addEventListener("visibilitychange",u),window.addEventListener("blur",a)),k(()=>{typeof document<"u"&&(document.removeEventListener("visibilitychange",u),window.removeEventListener("blur",a))}),{rememberPassword:n,isPasswordRemembered:e,saveSessionPassword:m,getSessionPassword:c,clearSessionPassword:i,autoLoadPassword:w}}const F={name:"PasswordInput",components:{PasswordStrengthIndicator:E},props:{password:{type:String,required:!0,default:""},passwordConfirm:{type:String,default:""},requireConfirmation:{type:Boolean,default:!1},showStrength:{type:Boolean,default:!0},showRequirements:{type:Boolean,default:!0},showFeedback:{type:Boolean,default:!1},autocomplete:{type:String,default:"new-password",validator:s=>["new-password","current-password"].includes(s)},passwordLabel:{type:String,default:"Password"},passwordPlaceholder:{type:String,default:"Enter encryption password"},passwordIcon:{type:String,default:"mdi-lock"}},emits:["update:password","update:password-confirm","is-valid"],setup(s,{emit:r}){const n=f(!1),e=f(!1),d=f(!1),m=v(()=>s.requireConfirmation?s.password.trim()!==""&&s.password===s.passwordConfirm:!0),c=v(()=>s.requireConfirmation?s.password!==""&&s.passwordConfirm!==""&&s.password!==s.passwordConfirm:!1),i=v(()=>s.showRequirements&&d.value),w=l=>{r("update:password",l),t(l,s.passwordConfirm)},u=l=>{r("update:password-confirm",l),t(s.password,l)},a=()=>{d.value=!0},o=()=>{d.value=!1},t=(l,_)=>{if(!s.requireConfirmation)r("is-valid",l.trim()!=="");else{const S=l.trim()!==""&&l===_;r("is-valid",S)}};return{showPassword:n,showPasswordConfirm:e,isPasswordConfirmed:m,showConfirmError:c,showRequirementsComputed:i,handlePasswordInput:w,handlePasswordConfirmInput:u,handlePasswordFocus:a,handlePasswordBlur:o}}},R={key:0,tabindex:"-1"};function x(s,r,n,e,d,m){const c=p("v-text-field"),i=p("PasswordStrengthIndicator"),w=p("v-col"),u=p("v-row");return y(),C(u,null,{default:P(()=>[h(w,{cols:"12",sm:n.requireConfirmation?6:12},{default:P(()=>[q("div",{onFocusin:r[1]||(r[1]=(...a)=>e.handlePasswordFocus&&e.handlePasswordFocus(...a)),onFocusout:r[2]||(r[2]=(...a)=>e.handlePasswordBlur&&e.handlePasswordBlur(...a))},[h(c,{"model-value":n.password,label:n.passwordLabel,type:e.showPassword?"text":"password",variant:"outlined",density:"comfortable",autocomplete:n.autocomplete,maxlength:"1024",placeholder:n.passwordPlaceholder,"prepend-inner-icon":n.passwordIcon,"append-inner-icon":e.showPassword?"mdi-eye-off":"mdi-eye","hide-details":"","onUpdate:modelValue":e.handlePasswordInput,"onClick:appendInner":r[0]||(r[0]=a=>e.showPassword=!e.showPassword)},null,8,["model-value","label","type","autocomplete","placeholder","prepend-inner-icon","append-inner-icon","onUpdate:modelValue"]),n.showStrength?(y(),B("div",R,[h(i,{password:n.password,"show-requirements":e.showRequirementsComputed,"show-feedback":n.showFeedback},null,8,["password","show-requirements","show-feedback"])])):g("",!0)],32)]),_:1},8,["sm"]),n.requireConfirmation?(y(),C(w,{key:0,cols:"12",sm:"6"},{default:P(()=>[h(c,{"model-value":n.passwordConfirm,label:"Confirm Password",type:e.showPasswordConfirm?"text":"password",variant:"outlined",density:"comfortable",autocomplete:n.autocomplete,maxlength:"1024",placeholder:"Confirm encryption password","prepend-inner-icon":"mdi-lock-check","append-inner-icon":e.showPasswordConfirm?"mdi-eye-off":"mdi-eye",error:e.showConfirmError,success:e.isPasswordConfirmed,"hide-details":"","onUpdate:modelValue":e.handlePasswordConfirmInput,"onClick:appendInner":r[3]||(r[3]=a=>e.showPasswordConfirm=!e.showPasswordConfirm)},null,8,["model-value","type","autocomplete","append-inner-icon","error","success","onUpdate:modelValue"])]),_:1})):g("",!0)]),_:1})}const N=I(F,[["render",x]]);export{N as P,W as a,A as u};
