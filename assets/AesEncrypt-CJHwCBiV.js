import{_ as ae,a as oe,c as te,b as t,i as H,j as M,w as c,r as y,d as E,k as O,e as l,o as N,g as n,f as i,t as ne,l as re}from"./index-BUnUYank.js";import{d as se}from"./fileDownload-B1vhVzTR.js";import{C as le,p as ie}from"./CsvPreviewTable-BbVc2cXk.js";import{P as ce,u as de,a as ue}from"./PasswordInput-Dd3CgEkZ.js";import{u as pe}from"./useClipboard-KqVwDR14.js";import{u as me}from"./useDebounce-CnEhRiT4.js";import{T as ve,S as fe,u as ye}from"./ToolPageHeader-Ds1KazUN.js";import{_ as be}from"./EducationalAlert-BU6Rulmg.js";import{T as we,F as _e}from"./TextInputWithActions-k1abN0ps.js";import{_ as he}from"./InfoTooltip-Cq_lmrhC.js";import"./PasswordStrengthIndicator-BC7Ny7cP.js";import"./FileUpload-CeN9DDzQ.js";const ge={name:"AesEncrypt",components:{CsvPreviewTable:le,EducationalAlert:be,FileUploadWithValidation:_e,InfoTooltip:he,LearnMorePanel:oe,PasswordInput:ce,SharedSnackbar:fe,TextInputWithActions:we,ToolPageHeader:ve},setup(){const p=y(""),a=y(""),u=y(""),e=y(""),m=y(null),v=y(""),w=y([]),b=y([]),{snackbar:A,snackbarColor:I,snackbarText:P,showSnackbar:d}=ye(),{copyToClipboard:k,pasteFromClipboard:U}=pe(),{rememberPassword:_,isPasswordRemembered:B,saveSessionPassword:h,clearSessionPassword:C,autoLoadPassword:V}=de("encrypt"),S=V();S&&(u.value=S,e.value=S);const{encrypt:F,isLoading:L}=ue((o,r)=>{x.value?Y(o):(se(o,r),d("✓ File encrypted successfully!","success"),z())},(o,r)=>{a.value=r,d(o,"error"),p.value=""}),g=E(()=>s.value&&(T.value||x.value)),T=E(()=>!!m.value),W=E(()=>b.value.length>0||w.value.length>0),s=E(()=>u.value.trim()!==""&&u.value===e.value),x=E(()=>v.value.trim()!==""),z=()=>{_.value||(u.value="",e.value=""),v.value="",m.value=null,p.value="",R()},R=()=>{w.value=[],b.value=[],search.value="",a.value=""},q=()=>{v.value="",p.value="",a.value="",ee()},Y=o=>{try{const r=new Blob([o]),f=new FileReader;f.onload=()=>{const D=f.result.split(",")[1];p.value=D,d("✓ Text encrypted successfully!","success")},f.onerror=()=>{a.value="Failed to convert encrypted data",d("❌ Encryption failed","error")},f.readAsDataURL(r)}catch(r){console.error("Base64 conversion error:",r),a.value="Failed to convert encrypted data",d("❌ Encryption failed","error")}},J=()=>{if(!g.value){d("Invalid inputs","error");return}a.value="";let o=null,r=null;x.value?(o=new Blob([v.value],{type:"text/plain"}),r="plaintext.txt"):T.value&&(o=m.value,r=m.value.name),o&&r&&F(o,u.value,r)},K=o=>{if(m.value&&o.isValid){const r=m.value;if(r.type==="text/csv"){const f=new FileReader;f.onload=()=>{const D=f.result;G(D)},f.readAsText(r)}}},G=o=>{const r=ie(o);b.value=r.headers,w.value=r.data},Q=()=>{if(g.value){a.value="",p.value="";try{const o=new Blob([v.value],{type:"text/plain"});F(o,u.value,"plaintext.txt")}catch(o){console.error("Encryption error:",o),a.value="Failed to initiate encryption",d("❌ Encryption failed","error")}}},X=async()=>{await k(p.value,o=>d(o,"success"),o=>d(o,"error"))},Z=async()=>{await U((o,r)=>{v.value=o,d(r,"success"),j()},o=>d(o,"error"))},$=()=>{p.value="",a.value="",j()},{cancel:ee,debounce:j}=me(()=>{g.value&&x.value&&Q()},800);return O(_,o=>{o&&s.value&&h(u.value)}),O([u,e],()=>{_.value&&s.value&&h(u.value),x.value&&(p.value="",a.value="",j())}),{encryptedText:p,error:a,isLoading:L,password:u,passwordConfirm:e,plainFile:m,plainText:v,tableData:w,tableHeaders:b,rememberPassword:_,isPasswordRemembered:B,clearSessionPassword:C,snackbar:A,snackbarColor:I,snackbarText:P,canEncrypt:g,isFilePopulated:T,isOutputPopulated:W,isPasswordConfirmed:s,isPlaintextPopulated:x,clearOutputs:R,clearPlainText:q,encryptFile:J,handleCopy:X,handleFileValidation:K,handlePaste:Z,handlePlainTextChange:$}}},xe=n("p",{class:"mb-2"},[n("strong",null,"AES (Advanced Encryption Standard)"),i(" is a military-grade encryption algorithm trusted by governments and organizations worldwide to protect sensitive data. ")],-1),Pe=n("ul",{class:"ml-4 mb-2"},[n("li",null,[n("strong",null,"AES-256"),i(" - This tool uses 256-bit keys, the strongest AES variant")]),n("li",null,[n("strong",null,"Password-based"),i(" - Your password is converted into an encryption key")]),n("li",null,[n("strong",null,"Unbreakable"),i(" - With a strong password, AES-256 would take billions of years to crack")])],-1),ke=n("strong",null,"cannot be recovered",-1),Ce=n("p",{class:"mt-3 mb-2"},[n("strong",null,"Common use cases:"),i(" Encrypt sensitive documents before uploading to cloud storage, secure backups, protect confidential files on shared computers. ")],-1),Se=n("div",{class:"text-caption text-medium-emphasis mt-3"},[n("strong",null,"Learn more:"),n("a",{href:"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," Wikipedia: AES "),i(" • "),n("a",{href:"https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/archived-crypto-projects/aes-development",target:"_blank",rel:"noopener noreferrer",class:"text-info"}," NIST: AES Standard ")],-1),Te=n("div",{class:"text-caption text-medium-emphasis mt-2"},[n("strong",null,"Technical:"),i(" Uses "),n("a",{href:"https://github.com/BrightSoul/javascript-aes-file-encryption",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"jsAesCrypt"),i(" with "),n("a",{href:"https://cryptojs.gitbook.io/docs/",target:"_blank",rel:"noopener noreferrer",class:"text-info"},"CryptoJS"),i(" for AES-256-CBC encryption. Password-based key derivation (PBKDF2) with 10,000 iterations. ")],-1),Ee=n("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"},"aria-hidden":"true"},null,-1),Ve=n("p",{class:"text-h6 mt-4"},"Encrypting...",-1);function Fe(p,a,u,e,m,v){const w=l("ToolPageHeader"),b=l("EducationalAlert"),A=l("LearnMorePanel"),I=l("v-alert"),P=l("v-icon"),d=l("InfoTooltip"),k=l("v-card-title"),U=l("PasswordInput"),_=l("v-checkbox"),B=l("v-chip"),h=l("v-card-text"),C=l("v-card"),V=l("TextInputWithActions"),S=l("v-divider"),F=l("FileUploadWithValidation"),L=l("CsvPreviewTable"),g=l("SharedSnackbar"),T=l("v-progress-circular"),W=l("v-overlay");return N(),te("div",null,[t(w,{icon:"mdi-lock",title:"AES Encryption",description:"Encrypt files and text with password-protected AES encryption","avatar-color":"primary"}),t(A,{title:"What is AES Encryption?","storage-key":"slurm-help-aes-encrypt"},{default:c(()=>[xe,Pe,t(b,{title:"Important Limitation",type:"warning",spacing:"mt-3"},{default:c(()=>[i(" If you forget your password, your encrypted data "),ke,i('. There is no "reset password" option - the password IS the key. ')]),_:1}),Ce,Se,Te]),_:1}),e.error?(N(),H(I,{key:0,type:"error",variant:"tonal",closable:"","onClick:close":a[0]||(a[0]=s=>e.error=""),class:"mb-4"},{default:c(()=>[i(ne(e.error),1)]),_:1})):M("",!0),t(C,{class:"mb-4"},{default:c(()=>[t(k,{class:"bg-surface-variant"},{default:c(()=>[t(P,{icon:"mdi-key",class:"mr-2"}),i(" Password Protection "),t(d,{text:"Password strength directly determines your encryption security. A weak 6-character password can be cracked in minutes, while a strong 16+ character password would take centuries to brute-force.",location:"bottom"})]),_:1}),t(h,{class:"pa-4"},{default:c(()=>[t(b,{title:"Password Strength Matters",type:"info",spacing:"mb-3"},{default:c(()=>[i(" Use at least 12 characters with a mix of uppercase, lowercase, numbers, and symbols. Your password security determines how long your encrypted data stays protected. ")]),_:1}),n("form",{onSubmit:a[4]||(a[4]=re(()=>{},["prevent"]))},[Ee,t(U,{password:e.password,"onUpdate:password":a[1]||(a[1]=s=>e.password=s),"password-confirm":e.passwordConfirm,"onUpdate:passwordConfirm":a[2]||(a[2]=s=>e.passwordConfirm=s),"require-confirmation":!0,"show-strength":!0,"show-requirements":!0,"show-feedback":!1,autocomplete:"new-password"},null,8,["password","password-confirm"]),t(_,{modelValue:e.rememberPassword,"onUpdate:modelValue":a[3]||(a[3]=s=>e.rememberPassword=s),label:"Remember password for this session",hint:"⚠️ Only use on trusted devices. Password stored in browser memory until tab closes.","persistent-hint":"",density:"comfortable",class:"mt-2",color:"warning"},null,8,["modelValue"]),e.isPasswordRemembered?(N(),H(B,{key:0,color:"info",variant:"tonal",size:"small","prepend-icon":"mdi-memory",closable:"","onClick:close":e.clearSessionPassword,class:"mt-2"},{default:c(()=>[i(" Password remembered for session ")]),_:1},8,["onClick:close"])):M("",!0)],32)]),_:1})]),_:1}),t(C,{class:"mb-4"},{default:c(()=>[t(k,{class:"bg-surface-variant"},{default:c(()=>[t(P,{icon:"mdi-text",class:"mr-2"}),i(" Text Encryption ")]),_:1}),t(h,{class:"pa-4"},{default:c(()=>[t(V,{modelValue:e.plainText,"onUpdate:modelValue":a[5]||(a[5]=s=>e.plainText=s),label:"Plain Text",placeholder:"Enter your plain text here",rows:4,disabled:e.isFilePopulated,"show-paste":!e.isFilePopulated,"show-clear":!0,"show-copy":!1,"test-id":"plain-text-input",onPaste:e.handlePaste,onClear:e.clearPlainText,onInput:e.handlePlainTextChange},null,8,["modelValue","disabled","show-paste","onPaste","onClear","onInput"]),t(S,{class:"my-4"}),t(V,{modelValue:e.encryptedText,"onUpdate:modelValue":a[6]||(a[6]=s=>e.encryptedText=s),label:"Encrypted Text (Base64)",placeholder:"Encrypted output will appear here...",rows:4,"is-loading":e.isLoading,readonly:!0,"show-paste":!1,"show-clear":!1,"show-copy":!0,"test-id":"output-text",onCopy:e.handleCopy},null,8,["modelValue","is-loading","onCopy"])]),_:1})]),_:1}),t(C,{class:"mb-4"},{default:c(()=>[t(k,{class:"bg-surface-variant"},{default:c(()=>[t(P,{icon:"mdi-file",class:"mr-2"}),i(" File Encryption ")]),_:1}),t(h,{class:"pa-4"},{default:c(()=>[t(F,{modelValue:e.plainFile,"onUpdate:modelValue":a[7]||(a[7]=s=>e.plainFile=s),label:"Select file to encrypt","button-text":"Encrypt","button-icon":"mdi-lock",disabled:e.isPlaintextPopulated,"can-submit":e.canEncrypt,onSubmit:e.encryptFile,onValidationChange:e.handleFileValidation},null,8,["modelValue","disabled","can-submit","onSubmit","onValidationChange"])]),_:1})]),_:1}),t(L,{headers:e.tableHeaders,data:e.tableData,onClose:e.clearOutputs},null,8,["headers","data","onClose"]),t(g,{modelValue:e.snackbar,"onUpdate:modelValue":a[8]||(a[8]=s=>e.snackbar=s),text:e.snackbarText,color:e.snackbarColor},null,8,["modelValue","text","color"]),t(W,{"model-value":e.isLoading,class:"align-center justify-center"},{default:c(()=>[t(T,{indeterminate:"",size:"64",color:"primary"}),Ve]),_:1},8,["model-value"])])}const Oe=ae(ge,[["render",Fe]]);export{Oe as default};
