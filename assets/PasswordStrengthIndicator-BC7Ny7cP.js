import{_ as S,c as h,j as _,b as u,g as m,w as f,t as b,e as g,o as d,f as q,F as w,y,n as A,p as N,h as U}from"./index-BUnUYank.js";function z(e){if(!e||e.length===0)return{level:"empty",score:0,color:"grey",label:"Enter password",percentage:0,feedback:[],requirements:k(e,null)};let t=0;const s=[],p=Math.min(40,e.length*2);t+=p;const a={hasLowercase:/[a-z]/.test(e),hasUppercase:/[A-Z]/.test(e),hasNumbers:/\d/.test(e),hasSpecialChars:/[^A-Za-z0-9]/.test(e)};a.hasLowercase&&(t+=10),a.hasUppercase&&(t+=15),a.hasNumbers&&(t+=15),a.hasSpecialChars&&(t+=20);const r=/abc|bcd|cde|123|234|345|456|567|678|789/i.test(e),v=/(.)\1{2,}/.test(e);r&&s.push("Avoid sequential characters (abc, 123)"),v&&s.push("Avoid repeating characters (aaa, 111)"),e.length<12&&s.push("Use at least 12 characters for better security"),(!a.hasUppercase||!a.hasLowercase)&&s.push("Include both uppercase and lowercase letters"),a.hasNumbers||s.push("Add numbers to strengthen your password"),a.hasSpecialChars||s.push("Include special characters (!@#$%^&*)");let c,o,n,i;const l=a.hasLowercase&&a.hasUppercase&&a.hasNumbers&&a.hasSpecialChars&&e.length>=12;return e.length<12?(c="weak",o="error",n="Weak",i=e.length/12*33,s.includes("Password is too weak")||s.push("Password is too weak")):t<30?(c="weak",o="error",n="Weak",i=t/30*33,s.push("Password is too weak")):t<60?(c="medium",o="warning",n="Medium",i=33+(t-30)/30*34,s.push("Consider making your password stronger")):t<80||!l?(c="strong",o="success",n="Strong",i=Math.min(90,67+(t-60)/40*23)):(c="very-strong",o="success",n="Very Strong",i=100),{level:c,score:t,color:o,label:n,percentage:Math.min(100,Math.round(i)),feedback:c==="very-strong"||c==="strong"?[]:s,requirements:k(e,a)}}function k(e,t){t||(t={hasLowercase:/[a-z]/.test(e),hasUppercase:/[A-Z]/.test(e),hasNumbers:/\d/.test(e),hasSpecialChars:/[^A-Za-z0-9]/.test(e)});const s=t.hasLowercase&&t.hasUppercase,p=e.length>=12;return[{text:"At least 12 characters",met:p,icon:p?"mdi-check-circle":"mdi-circle-outline"},{text:"Uppercase and lowercase letters",met:s,icon:s?"mdi-check-circle":"mdi-circle-outline"},{text:"At least one number",met:t.hasNumbers,icon:t.hasNumbers?"mdi-check-circle":"mdi-circle-outline"},{text:"At least one special character",met:t.hasSpecialChars,icon:t.hasSpecialChars?"mdi-check-circle":"mdi-circle-outline"}]}const I={name:"PasswordStrengthIndicator",props:{password:{type:String,required:!0,default:""},showRequirements:{type:Boolean,default:!0},showFeedback:{type:Boolean,default:!0},showScore:{type:Boolean,default:!1}},computed:{strength(){return z(this.password)},passwordRequirements(){const e=this.password;return[{met:e.length>=12,text:"At least 12 characters"},{met:/[a-z]/.test(e)&&/[A-Z]/.test(e),text:"Uppercase and lowercase letters"},{met:/\d/.test(e),text:"At least one number"},{met:/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),text:"At least one special character"}]}},watch:{strength:{handler(e){this.$emit("strength-changed",e)},deep:!0,immediate:!0}}},P=e=>(N("data-v-08741810"),e=e(),U(),e),R={key:0,class:"password-strength-indicator","data-testid":"strength-indicator",tabindex:"-1"},B={class:"d-flex align-center justify-space-between mb-2",tabindex:"-1"},C={class:"d-flex align-center"},L={key:0,class:"text-caption text-medium-emphasis"},M={key:0,class:"mt-2","data-testid":"requirements",tabindex:"-1"},V=P(()=>m("div",{class:"text-caption text-medium-emphasis mb-1 font-weight-medium"}," Password Requirements: ",-1)),Z={class:"requirements-list"},F={class:"requirement-text"},j={key:0,class:"mt-2",tabindex:"-1"},E={class:"mb-0 pl-4"};function W(e,t,s,p,a,r){const v=g("v-progress-linear"),c=g("v-chip"),o=g("v-icon"),n=g("v-expand-transition"),i=g("v-alert");return s.password?(d(),h("div",R,[u(v,{"model-value":r.strength.percentage,color:r.strength.color,height:"8",rounded:"",class:"mb-2",tabindex:"-1"},null,8,["model-value","color"]),m("div",B,[m("div",C,[u(c,{color:r.strength.color,size:"small",variant:"flat",class:"mr-2",tabindex:"-1"},{default:f(()=>[q(b(r.strength.label),1)]),_:1},8,["color"]),s.showScore?(d(),h("span",L," Score: "+b(r.strength.score)+"/100 ",1)):_("",!0)])]),u(n,null,{default:f(()=>[s.showRequirements&&r.strength.level!=="empty"?(d(),h("div",M,[V,m("div",Z,[(d(!0),h(w,null,y(r.passwordRequirements,(l,x)=>(d(),h("div",{key:x,class:A(["requirement-item",l.met?"requirement-met":"requirement-unmet"])},[u(o,{icon:l.met?"mdi-check-circle":"mdi-close",color:l.met?"success":"error",size:"small",class:"requirement-icon"},null,8,["icon","color"]),m("span",F,b(l.text),1)],2))),128))])])):_("",!0)]),_:1}),u(n,null,{default:f(()=>[r.strength.feedback.length>0&&s.showFeedback?(d(),h("div",j,[u(i,{color:r.strength.color,variant:"tonal",density:"compact",class:"text-caption pa-2",tabindex:"-1"},{default:f(()=>[m("ul",E,[(d(!0),h(w,null,y(r.strength.feedback,(l,x)=>(d(),h("li",{key:x},b(l),1))),128))])]),_:1},8,["color"])])):_("",!0)]),_:1})])):_("",!0)}const T=S(I,[["render",W],["__scopeId","data-v-08741810"]]);export{T as P};
