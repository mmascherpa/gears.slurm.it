import{_ as B,c as m,g,a as l,i as b,w as h,t as f,d,o as u,e as w,F as S,x as A,f as I,n as P,p as U,j as z}from"./index-CHYnOP-6.js";function C(e){if(!e||e.length===0)return{level:"empty",score:0,color:"grey",label:"Enter password",percentage:0,feedback:[],requirements:N(e,null)};let t=0;const s=[],_=Math.min(40,e.length*2);t+=_;const a={hasLowercase:/[a-z]/.test(e),hasUppercase:/[A-Z]/.test(e),hasNumbers:/\d/.test(e),hasSpecialChars:/[^A-Za-z0-9]/.test(e)};a.hasLowercase&&(t+=10),a.hasUppercase&&(t+=15),a.hasNumbers&&(t+=15),a.hasSpecialChars&&(t+=20);const c=/abc|bcd|cde|123|234|345|456|567|678|789/i.test(e),v=/(.)\1{2,}/.test(e);c&&s.push("Avoid sequential characters (abc, 123)"),v&&s.push("Avoid repeating characters (aaa, 111)"),e.length<12&&s.push("Use at least 12 characters for better security"),(!a.hasUppercase||!a.hasLowercase)&&s.push("Include both uppercase and lowercase letters"),a.hasNumbers||s.push("Add numbers to strengthen your password"),a.hasSpecialChars||s.push("Include special characters (!@#$%^&*)");let n,r,i,o;const x=a.hasLowercase&&a.hasUppercase&&a.hasNumbers&&a.hasSpecialChars&&e.length>=12;return e.length<12?(n="weak",r="error",i="Weak",o=e.length/12*33,s.includes("Password is too weak")||s.push("Password is too weak")):t<30?(n="weak",r="error",i="Weak",o=t/30*33,s.push("Password is too weak")):t<60?(n="medium",r="warning",i="Medium",o=33+(t-30)/30*34,s.push("Consider making your password stronger")):t<80||!x?(n="strong",r="success",i="Strong",o=Math.min(90,67+(t-60)/40*23)):(n="very-strong",r="success",i="Very Strong",o=100),{level:n,score:t,color:r,label:i,percentage:Math.min(100,Math.round(o)),feedback:n==="very-strong"||n==="strong"?[]:s,requirements:N(e,a)}}function N(e,t){t||(t={hasLowercase:/[a-z]/.test(e),hasUppercase:/[A-Z]/.test(e),hasNumbers:/\d/.test(e),hasSpecialChars:/[^A-Za-z0-9]/.test(e)});const s=t.hasLowercase&&t.hasUppercase,_=e.length>=12;return[{text:"At least 12 characters",met:_,icon:_?"mdi-check-circle":"mdi-circle-outline"},{text:"Uppercase and lowercase letters",met:s,icon:s?"mdi-check-circle":"mdi-circle-outline"},{text:"At least one number",met:t.hasNumbers,icon:t.hasNumbers?"mdi-check-circle":"mdi-circle-outline"},{text:"At least one special character",met:t.hasSpecialChars,icon:t.hasSpecialChars?"mdi-check-circle":"mdi-circle-outline"}]}const L={name:"PasswordStrengthIndicator",props:{password:{type:String,required:!0,default:""},showRequirements:{type:Boolean,default:!0},showFeedback:{type:Boolean,default:!0},showScore:{type:Boolean,default:!1}},computed:{strength(){return C(this.password)}},watch:{strength:{handler(e){this.$emit("strength-changed",e)},deep:!0,immediate:!0}}},M=e=>(U("data-v-262e367a"),e=e(),z(),e),R={key:0,class:"password-strength-indicator","data-testid":"strength-indicator",tabindex:"-1"},V={class:"d-flex align-center justify-space-between mb-2",tabindex:"-1"},F={class:"d-flex align-center"},Z={key:0,class:"text-caption text-medium-emphasis"},j={key:0,class:"mt-3","data-testid":"requirements",tabindex:"-1"},E=M(()=>b("div",{class:"text-caption text-medium-emphasis mb-2 font-weight-medium"}," Password Requirements: ",-1)),W={key:0,class:"mt-2",tabindex:"-1"},D={class:"mb-0 pl-4"};function T(e,t,s,_,a,c){const v=d("v-progress-linear"),n=d("v-chip"),r=d("v-icon"),i=d("v-list-item-title"),o=d("v-list-item"),x=d("v-list"),k=d("v-expand-transition"),q=d("v-alert");return s.password?(u(),m("div",R,[l(v,{"model-value":c.strength.percentage,color:c.strength.color,height:"8",rounded:"",class:"mb-2",tabindex:"-1"},null,8,["model-value","color"]),b("div",V,[b("div",F,[l(n,{color:c.strength.color,size:"small",variant:"flat",class:"mr-2",tabindex:"-1"},{default:h(()=>[w(f(c.strength.label),1)]),_:1},8,["color"]),s.showScore?(u(),m("span",Z," Score: "+f(c.strength.score)+"/100 ",1)):g("",!0)])]),l(k,null,{default:h(()=>[s.showRequirements&&c.strength.level!=="empty"?(u(),m("div",j,[E,l(x,{density:"compact",class:"pa-0",tabindex:"-1"},{default:h(()=>[(u(!0),m(S,null,A(c.strength.requirements,(p,y)=>(u(),I(o,{key:y,class:"pa-0 mb-1",density:"compact",tabindex:"-1"},{prepend:h(()=>[l(r,{icon:p.icon,color:p.met?"success":"grey",size:"small",class:"mr-2",tabindex:"-1"},null,8,["icon","color"])]),default:h(()=>[l(i,{class:P(["text-caption",p.met?"text-success":"text-medium-emphasis"])},{default:h(()=>[w(f(p.text),1)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})])):g("",!0)]),_:1}),l(k,null,{default:h(()=>[c.strength.feedback.length>0&&s.showFeedback?(u(),m("div",W,[l(q,{color:c.strength.color,variant:"tonal",density:"compact",class:"text-caption pa-2",tabindex:"-1"},{default:h(()=>[b("ul",D,[(u(!0),m(S,null,A(c.strength.feedback,(p,y)=>(u(),m("li",{key:y},f(p),1))),128))])]),_:1},8,["color"])])):g("",!0)]),_:1})])):g("",!0)}const H=B(L,[["render",T],["__scopeId","data-v-262e367a"]]);export{H as P};
